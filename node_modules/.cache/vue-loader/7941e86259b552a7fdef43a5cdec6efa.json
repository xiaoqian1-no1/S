{"remainingRequest":"F:\\1\\smart\\vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\1\\smart\\vue\\src\\views\\FarmMap3D.vue?vue&type=script&lang=js","dependencies":[{"path":"F:\\1\\smart\\vue\\src\\views\\FarmMap3D.vue","mtime":1763448918466},{"path":"F:\\1\\smart\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1735803512432},{"path":"F:\\1\\smart\\vue\\node_modules\\babel-loader\\lib\\index.js","mtime":1735803514062},{"path":"F:\\1\\smart\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1735803512432},{"path":"F:\\1\\smart\\vue\\node_modules\\vue-loader\\lib\\index.js","mtime":1735803514728}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgKiBhcyBUSFJFRSBmcm9tICd0aHJlZSc7DQppbXBvcnQgeyBPcmJpdENvbnRyb2xzIH0gZnJvbSAndGhyZWUvZXhhbXBsZXMvanNtL2NvbnRyb2xzL09yYml0Q29udHJvbHMnOw0KaW1wb3J0IHsgR0xURkxvYWRlciB9IGZyb20gJ3RocmVlL2V4YW1wbGVzL2pzbS9sb2FkZXJzL0dMVEZMb2FkZXInOw0KDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICdGYXJtTWFwM0QnLA0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICBjdXJyZW50VGltZTogJycsDQogICAgICBzZWxlY3RlZEZhcm06IG51bGwsDQogICAgICB3ZWF0aGVyOiB7DQogICAgICAgIHRlbXA6IDI4LA0KICAgICAgICBzdGF0dXM6ICfmmbQnDQogICAgICB9LA0KICAgICAgc3VtbWFyeTogew0KICAgICAgICBmYXJtQ291bnQ6IDAsDQogICAgICAgIHRvdGFsQXJlYTogMCwNCiAgICAgICAgdG90YWxTdG9jazogMCwNCiAgICAgICAgbm9ybWFsQ291bnQ6IDANCiAgICAgIH0sDQogICAgICBmYXJtczogW10sDQogICAgICANCiAgICAgIC8vIFRocmVlLmpzIOebuOWFsw0KICAgICAgc2NlbmU6IG51bGwsDQogICAgICBjYW1lcmE6IG51bGwsDQogICAgICByZW5kZXJlcjogbnVsbCwNCiAgICAgIGNvbnRyb2xzOiBudWxsLA0KICAgICAgZmFybUJsb2NrczogW10sDQogICAgICBsYWJlbHM6IFtdLCAvLyDlrZjlgqjmiYDmnInmoIfnrb7nsr7ngbUNCiAgICAgIHJheWNhc3RlcjogbnVsbCwNCiAgICAgIG1vdXNlOiBudWxsLA0KICAgICAgc2VsZWN0ZWRCbG9jazogbnVsbCwNCiAgICAgIHRpbWVJbnRlcnZhbDogbnVsbCwgLy8g5pe26Ze05pu05paw5a6a5pe25ZmoDQogICAgICBsYXN0UmVuZGVyVGltZTogbnVsbCwgLy8g5LiK5qyh5riy5p+T5pe26Ze077yM55So5LqO5bin546H5o6n5Yi2DQogICAgICBtb3VzZU1vdmVUaW1lcjogbnVsbCwgLy8g6byg5qCH56e75Yqo6IqC5rWB5a6a5pe25ZmoDQogICAgICBib3VuZE1vdXNlQ2xpY2s6IG51bGwsIC8vIOe7keWumueahOS6i+S7tuWkhOeQhuWHveaVsA0KICAgICAgYm91bmRNb3VzZU1vdmU6IG51bGwsDQogICAgICBib3VuZFdpbmRvd1Jlc2l6ZTogbnVsbCwNCiAgICAgIA0KICAgICAgLy8g5qih5Z6L5Yqg6L295Zmo5ZKM57yT5a2YDQogICAgICBnbHRmTG9hZGVyOiBudWxsLA0KICAgICAgbW9kZWxDYWNoZToge30sIC8vIOe8k+WtmOW3suWKoOi9veeahOaooeWeiw0KICAgICAgDQogICAgICAvLyDwn4y+IOS9nOeJqemFjee9ruS4reW/gyAtIOa3u+WKoOaWsOakjeeJqeWPqumcgOWcqOi/memHjOmFjee9ruWNs+WPrw0KICAgICAgY3JvcENvbmZpZzogew0KICAgICAgICAn5bCP6bqmJzogew0KICAgICAgICAgIGljb246ICfwn4y+JywNCiAgICAgICAgICBjb2xvcjogMHhGNEQwM0YsICAvLyDph5Hpu4ToibINCiAgICAgICAgICBtb2RlbFBhdGg6ICcvbW9kZWxzL2Nyb3BzL3doZWF0LmdsYicNCiAgICAgICAgfSwNCiAgICAgICAgJ+eOieexsyc6IHsNCiAgICAgICAgICBpY29uOiAn8J+MvScsDQogICAgICAgICAgY29sb3I6IDB4RjM5QzEyLCAgLy8g5qmZ6buE6ImyDQogICAgICAgICAgbW9kZWxQYXRoOiAnL21vZGVscy9jcm9wcy9jb3JuLmdsYicNCiAgICAgICAgfSwNCiAgICAgICAgJ+awtOeouyc6IHsNCiAgICAgICAgICBpY29uOiAn8J+MvicsDQogICAgICAgICAgY29sb3I6IDB4NTJCRTgwLCAgLy8g57u/6ImyDQogICAgICAgICAgbW9kZWxQYXRoOiAnL21vZGVscy9jcm9wcy9yaWNlLmdsYicNCiAgICAgICAgfSwNCiAgICAgICAgJ+Wkp+ixhic6IHsNCiAgICAgICAgICBpY29uOiAn8J+rmCcsDQogICAgICAgICAgY29sb3I6IDB4ODVDMUUyLCAgLy8g5rWF6JOd6ImyDQogICAgICAgICAgbW9kZWxQYXRoOiAnL21vZGVscy9jcm9wcy9zb3liZWFuLmdsYicNCiAgICAgICAgfSwNCiAgICAgICAgJ+eVquiMhCc6IHsNCiAgICAgICAgICBpY29uOiAn8J+NhScsDQogICAgICAgICAgY29sb3I6IDB4RTc0QzNDLCAgLy8g57qi6ImyDQogICAgICAgICAgbW9kZWxQYXRoOiAnL21vZGVscy9jcm9wcy90b21hdG8uZ2xiJw0KICAgICAgICB9LA0KICAgICAgICAn6buE55OcJzogew0KICAgICAgICAgIGljb246ICfwn6WSJywNCiAgICAgICAgICBjb2xvcjogMHgyN0FFNjAsICAvLyDmt7Hnu7/oibINCiAgICAgICAgICBtb2RlbFBhdGg6ICcvbW9kZWxzL2Nyb3BzL2N1Y3VtYmVyLmdsYicNCiAgICAgICAgfSwNCiAgICAgICAgJ+i+o+akkic6IHsNCiAgICAgICAgICBpY29uOiAn8J+Mtu+4jycsDQogICAgICAgICAgY29sb3I6IDB4QzAzOTJCLCAgLy8g5rex57qi6ImyDQogICAgICAgICAgbW9kZWxQYXRoOiAnL21vZGVscy9jcm9wcy9wZXBwZXIuZ2xiJw0KICAgICAgICB9LA0KICAgICAgICAn6IyE5a2QJzogew0KICAgICAgICAgIGljb246ICfwn42GJywNCiAgICAgICAgICBjb2xvcjogMHg4RTQ0QUQsICAvLyDntKvoibINCiAgICAgICAgICBtb2RlbFBhdGg6ICcvbW9kZWxzL2Nyb3BzL2VnZ3BsYW50LmdsYicNCiAgICAgICAgfSwNCiAgICAgICAgJ+eZveiPnCc6IHsNCiAgICAgICAgICBpY29uOiAn8J+lrCcsDQogICAgICAgICAgY29sb3I6IDB4MkVDQzcxLCAgLy8g5Lqu57u/6ImyDQogICAgICAgICAgbW9kZWxQYXRoOiAnL21vZGVscy9jcm9wcy9jYWJiYWdlLmdsYicNCiAgICAgICAgfSwNCiAgICAgICAgJ+iQneWNnCc6IHsNCiAgICAgICAgICBpY29uOiAn8J+llScsDQogICAgICAgICAgY29sb3I6IDB4RTY3RTIyLCAgLy8g5qmZ6ImyDQogICAgICAgICAgbW9kZWxQYXRoOiAnL21vZGVscy9jcm9wcy9jYXJyb3QuZ2xiJw0KICAgICAgICB9LA0KICAgICAgICAn5Zyf6LGGJzogew0KICAgICAgICAgIGljb246ICfwn6WUJywNCiAgICAgICAgICBjb2xvcjogMHhENEFDNkUsICAvLyDlnJ/pu4ToibINCiAgICAgICAgICBtb2RlbFBhdGg6ICcvbW9kZWxzL2Nyb3BzL3BvdGF0by5nbGInDQogICAgICAgIH0sDQogICAgICAgICfljZfnk5wnOiB7DQogICAgICAgICAgaWNvbjogJ/CfjoMnLA0KICAgICAgICAgIGNvbG9yOiAweEZGOEMwMCwgIC8vIOa3seapmeiJsg0KICAgICAgICAgIG1vZGVsUGF0aDogJy9tb2RlbHMvY3JvcHMvcHVtcGtpbi5nbGInDQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICANCiAgICAgIC8vIOm7mOiupOmFjee9ru+8iOW9k+S9nOeJqeS4jeWcqOmFjee9ruS4reaXtuS9v+eUqO+8iQ0KICAgICAgZGVmYXVsdENyb3BDb25maWc6IHsNCiAgICAgICAgaWNvbjogJ/CfjLEnLA0KICAgICAgICBjb2xvcjogMHg1MkJFODAsDQogICAgICAgIG1vZGVsUGF0aDogbnVsbA0KICAgICAgfQ0KICAgIH07DQogIH0sDQogIA0KICBtb3VudGVkKCkgew0KICAgIHRoaXMudXBkYXRlVGltZSgpOw0KICAgIHRoaXMudGltZUludGVydmFsID0gc2V0SW50ZXJ2YWwodGhpcy51cGRhdGVUaW1lLCAxMDAwKTsNCiAgICB0aGlzLmZldGNoRGF0YSgpOw0KICB9LA0KICANCiAgYmVmb3JlRGVzdHJveSgpIHsNCiAgICBpZiAodGhpcy50aW1lSW50ZXJ2YWwpIHsNCiAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy50aW1lSW50ZXJ2YWwpOw0KICAgIH0NCiAgICAvLyDplIDmr4FUaHJlZS5qc+i1hOa6kA0KICAgIGlmICh0aGlzLnJlbmRlcmVyKSB7DQogICAgICB0aGlzLnJlbmRlcmVyLmRpc3Bvc2UoKTsNCiAgICAgIGlmICh0aGlzLiRyZWZzLnRocmVlQ29udGFpbmVyKSB7DQogICAgICAgIHRoaXMuJHJlZnMudGhyZWVDb250YWluZXIucmVtb3ZlQ2hpbGQodGhpcy5yZW5kZXJlci5kb21FbGVtZW50KTsNCiAgICAgIH0NCiAgICB9DQogICAgaWYgKHRoaXMuY29udHJvbHMpIHsNCiAgICAgIHRoaXMuY29udHJvbHMuZGlzcG9zZSgpOw0KICAgIH0NCiAgICAvLyDmuIXnkIbkuovku7bnm5HlkKwNCiAgICBjb25zdCBjb250YWluZXIgPSB0aGlzLiRyZWZzLnRocmVlQ29udGFpbmVyOw0KICAgIGlmIChjb250YWluZXIpIHsNCiAgICAgIGlmICh0aGlzLmJvdW5kTW91c2VDbGljaykgew0KICAgICAgICBjb250YWluZXIucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmJvdW5kTW91c2VDbGljayk7DQogICAgICB9DQogICAgICBpZiAodGhpcy5ib3VuZE1vdXNlTW92ZSkgew0KICAgICAgICBjb250YWluZXIucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgdGhpcy5ib3VuZE1vdXNlTW92ZSk7DQogICAgICB9DQogICAgfQ0KICAgIGlmICh0aGlzLmJvdW5kV2luZG93UmVzaXplKSB7DQogICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigncmVzaXplJywgdGhpcy5ib3VuZFdpbmRvd1Jlc2l6ZSk7DQogICAgfQ0KICAgIA0KICAgIC8vIOa4heeQhuWumuaXtuWZqA0KICAgIGlmICh0aGlzLm1vdXNlTW92ZVRpbWVyKSB7DQogICAgICBjbGVhclRpbWVvdXQodGhpcy5tb3VzZU1vdmVUaW1lcik7DQogICAgICB0aGlzLm1vdXNlTW92ZVRpbWVyID0gbnVsbDsNCiAgICB9DQogIH0sDQogIA0KICBtZXRob2RzOiB7DQogICAgdXBkYXRlVGltZSgpIHsNCiAgICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7DQogICAgICBjb25zdCB5ZWFyID0gbm93LmdldEZ1bGxZZWFyKCk7DQogICAgICBjb25zdCBtb250aCA9IFN0cmluZyhub3cuZ2V0TW9udGgoKSArIDEpLnBhZFN0YXJ0KDIsICcwJyk7DQogICAgICBjb25zdCBkYXkgPSBTdHJpbmcobm93LmdldERhdGUoKSkucGFkU3RhcnQoMiwgJzAnKTsNCiAgICAgIGNvbnN0IGhvdXIgPSBTdHJpbmcobm93LmdldEhvdXJzKCkpLnBhZFN0YXJ0KDIsICcwJyk7DQogICAgICBjb25zdCBtaW51dGUgPSBTdHJpbmcobm93LmdldE1pbnV0ZXMoKSkucGFkU3RhcnQoMiwgJzAnKTsNCiAgICAgIGNvbnN0IHNlY29uZCA9IFN0cmluZyhub3cuZ2V0U2Vjb25kcygpKS5wYWRTdGFydCgyLCAnMCcpOw0KICAgICAgY29uc3Qgd2Vla0RheXMgPSBbJ+aYn+acn+aXpScsICfmmJ/mnJ/kuIAnLCAn5pif5pyf5LqMJywgJ+aYn+acn+S4iScsICfmmJ/mnJ/lm5snLCAn5pif5pyf5LqUJywgJ+aYn+acn+WFrSddOw0KICAgICAgY29uc3Qgd2Vla0RheSA9IHdlZWtEYXlzW25vdy5nZXREYXkoKV07DQogICAgICANCiAgICAgIHRoaXMuY3VycmVudFRpbWUgPSBgJHt5ZWFyfS0ke21vbnRofS0ke2RheX0gJHtob3VyfToke21pbnV0ZX06JHtzZWNvbmR9ICR7d2Vla0RheX1gOw0KICAgIH0sDQogICAgDQogICAgYXN5bmMgZmV0Y2hEYXRhKCkgew0KICAgICAgdHJ5IHsNCiAgICAgICAgY29uc3QgZmFybXNSZXMgPSBhd2FpdCB0aGlzLnJlcXVlc3QuZ2V0KCcvc3RhdGlzdGljL2Rhc2hib2FyZCcpOw0KICAgICAgICBpZiAoZmFybXNSZXMuY29kZSA9PT0gJzIwMCcpIHsNCiAgICAgICAgICB0aGlzLmZhcm1zID0gZmFybXNSZXMuZGF0YTsNCiAgICAgICAgICBpZiAodGhpcy5mYXJtcy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICB0aGlzLnNlbGVjdGVkRmFybSA9IHRoaXMuZmFybXNbMF07DQogICAgICAgICAgfQ0KICAgICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsNCiAgICAgICAgICAgIHRoaXMuaW5pdDNETWFwKCk7DQogICAgICAgICAgfSk7DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIGNvbnN0IHN1bW1hcnlSZXMgPSBhd2FpdCB0aGlzLnJlcXVlc3QuZ2V0KCcvc3RhdGlzdGljL2Rhc2hib2FyZC9zdW1tYXJ5Jyk7DQogICAgICAgIGlmIChzdW1tYXJ5UmVzLmNvZGUgPT09ICcyMDAnKSB7DQogICAgICAgICAgdGhpcy5zdW1tYXJ5ID0gc3VtbWFyeVJlcy5kYXRhOw0KICAgICAgICB9DQogICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCfojrflj5bmlbDmja7lpLHotKU6JywgZXJyb3IpOw0KICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCfmlbDmja7liqDovb3lpLHotKUnKTsNCiAgICAgIH0NCiAgICB9LA0KICAgIA0KICAgIHNlbGVjdEZhcm0oZmFybSkgew0KICAgICAgdGhpcy5zZWxlY3RlZEZhcm0gPSBmYXJtOw0KICAgICAgLy8g5ZyoM0TlnLrmma/kuK3pq5jkuq7lr7nlupTnmoTmlrnlnZcNCiAgICAgIHRoaXMuaGlnaGxpZ2h0RmFybUJsb2NrKGZhcm0pOw0KICAgIH0sDQogICAgDQogICAgLy8g6K6h566X546v5aKD5YGl5bq36K+E5YiG77yIMC0xMDDvvIkNCiAgICBjYWxjdWxhdGVIZWFsdGhTY29yZShmYXJtKSB7DQogICAgICBpZiAoIWZhcm0pIHJldHVybiAwOw0KICAgICAgDQogICAgICBjb25zdCBzY29yZXMgPSBbXTsNCiAgICAgIA0KICAgICAgLy8g5rip5bqm6K+E5YiG77yI5pyA5L2z6IyD5Zu0IDIwLTI4wrBD77yJDQogICAgICBjb25zdCB0ZW1wID0gZmFybS50ZW1wZXJhdHVyZSB8fCAyNTsNCiAgICAgIGlmICh0ZW1wID49IDIwICYmIHRlbXAgPD0gMjgpIHsNCiAgICAgICAgc2NvcmVzLnB1c2goMTAwKTsNCiAgICAgIH0gZWxzZSBpZiAodGVtcCA+PSAxNSAmJiB0ZW1wIDw9IDMyKSB7DQogICAgICAgIHNjb3Jlcy5wdXNoKDgwKTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHNjb3Jlcy5wdXNoKDUwKTsNCiAgICAgIH0NCiAgICAgIA0KICAgICAgLy8g56m65rCU5rm/5bqm6K+E5YiG77yI5pyA5L2z6IyD5Zu0IDYwLTgwJe+8iQ0KICAgICAgY29uc3QgYWlySHVtID0gZmFybS5haXJodW1pZGl0eSB8fCA3MDsNCiAgICAgIGlmIChhaXJIdW0gPj0gNjAgJiYgYWlySHVtIDw9IDgwKSB7DQogICAgICAgIHNjb3Jlcy5wdXNoKDEwMCk7DQogICAgICB9IGVsc2UgaWYgKGFpckh1bSA+PSA1MCAmJiBhaXJIdW0gPD0gOTApIHsNCiAgICAgICAgc2NvcmVzLnB1c2goNzUpOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgc2NvcmVzLnB1c2goNTApOw0KICAgICAgfQ0KICAgICAgDQogICAgICAvLyDlnJ/lo6Tmub/luqbor4TliIbvvIjmnIDkvbPojIPlm7QgNDAtNzAl77yJDQogICAgICBjb25zdCBzb2lsSHVtID0gZmFybS5zb2lsaHVtaWRpdHkgfHwgNjA7DQogICAgICBpZiAoc29pbEh1bSA+PSA0MCAmJiBzb2lsSHVtIDw9IDcwKSB7DQogICAgICAgIHNjb3Jlcy5wdXNoKDEwMCk7DQogICAgICB9IGVsc2UgaWYgKHNvaWxIdW0gPj0gMzAgJiYgc29pbEh1bSA8PSA4MCkgew0KICAgICAgICBzY29yZXMucHVzaCg3NSk7DQogICAgICB9IGVsc2Ugew0KICAgICAgICBzY29yZXMucHVzaCg1MCk7DQogICAgICB9DQogICAgICANCiAgICAgIC8vIOWFieeFp+W8uuW6puivhOWIhu+8iOacgOS9s+iMg+WbtCAyMDAwMC01MDAwMCBsdXjvvIkNCiAgICAgIGNvbnN0IGxpZ2h0ID0gZmFybS5saWdodCB8fCAzMDAwMDsNCiAgICAgIGlmIChsaWdodCA+PSAyMDAwMCAmJiBsaWdodCA8PSA1MDAwMCkgew0KICAgICAgICBzY29yZXMucHVzaCgxMDApOw0KICAgICAgfSBlbHNlIGlmIChsaWdodCA+PSAxMDAwMCAmJiBsaWdodCA8PSA2MDAwMCkgew0KICAgICAgICBzY29yZXMucHVzaCg4MCk7DQogICAgICB9IGVsc2Ugew0KICAgICAgICBzY29yZXMucHVzaCg2MCk7DQogICAgICB9DQogICAgICANCiAgICAgIC8vIENP4oKC6K+E5YiG77yI5pyA5L2z6IyD5Zu0IDM1MC00NTAgcHBt77yJDQogICAgICBjb25zdCBjYXJib24gPSBmYXJtLmNhcmJvbiB8fCA0MDA7DQogICAgICBpZiAoY2FyYm9uID49IDM1MCAmJiBjYXJib24gPD0gNDUwKSB7DQogICAgICAgIHNjb3Jlcy5wdXNoKDEwMCk7DQogICAgICB9IGVsc2UgaWYgKGNhcmJvbiA+PSAzMDAgJiYgY2FyYm9uIDw9IDUwMCkgew0KICAgICAgICBzY29yZXMucHVzaCg4NSk7DQogICAgICB9IGVsc2Ugew0KICAgICAgICBzY29yZXMucHVzaCg2NSk7DQogICAgICB9DQogICAgICANCiAgICAgIC8vIFBI5YC86K+E5YiG77yI5pyA5L2z6IyD5Zu0IDYuMC03LjXvvIkNCiAgICAgIGNvbnN0IHBoID0gZmFybS5waCB8fCA2Ljg7DQogICAgICBpZiAocGggPj0gNi4wICYmIHBoIDw9IDcuNSkgew0KICAgICAgICBzY29yZXMucHVzaCgxMDApOw0KICAgICAgfSBlbHNlIGlmIChwaCA+PSA1LjUgJiYgcGggPD0gOC4wKSB7DQogICAgICAgIHNjb3Jlcy5wdXNoKDgwKTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHNjb3Jlcy5wdXNoKDU1KTsNCiAgICAgIH0NCiAgICAgIA0KICAgICAgLy8g6K6h566X5bmz5Z2H5YiGDQogICAgICBjb25zdCBhdmdTY29yZSA9IHNjb3Jlcy5yZWR1Y2UoKGEsIGIpID0+IGEgKyBiLCAwKSAvIHNjb3Jlcy5sZW5ndGg7DQogICAgICByZXR1cm4gTWF0aC5yb3VuZChhdmdTY29yZSk7DQogICAgfSwNCiAgICANCiAgICAvLyDmoLnmja7lgaXlurfmjIfmlbDojrflj5bpopzoibLvvIjkvJjnp4A957u/6Imy77yM6Imv5aW9PeiTneiJsu+8jOS4gOiIrD3pu4ToibLvvIzpnIDlhbPms6g957qi6Imy77yJDQogICAgZ2V0SGVhbHRoQ29sb3Ioc2NvcmUpIHsNCiAgICAgIGlmIChzY29yZSA+PSA5MCkgew0KICAgICAgICByZXR1cm4gMHg2N0MyM0E7IC8vIOe7v+iJsiAtIOS8mOengA0KICAgICAgfSBlbHNlIGlmIChzY29yZSA+PSA3NSkgew0KICAgICAgICByZXR1cm4gMHg0MDlFRkY7IC8vIOiTneiJsiAtIOiJr+WlvQ0KICAgICAgfSBlbHNlIGlmIChzY29yZSA+PSA2MCkgew0KICAgICAgICByZXR1cm4gMHhFNkEyM0M7IC8vIOm7hOiJsiAtIOS4gOiIrA0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgcmV0dXJuIDB4RjU2QzZDOyAvLyDnuqLoibIgLSDpnIDlhbPms6gNCiAgICAgIH0NCiAgICB9LA0KICAgIA0KICAgIC8vIOa3t+WQiOS4pOenjeminOiJsg0KICAgIGJsZW5kQ29sb3JzKGNvbG9yMSwgY29sb3IyLCByYXRpbykgew0KICAgICAgY29uc3QgcjEgPSAoY29sb3IxID4+IDE2KSAmIDB4RkY7DQogICAgICBjb25zdCBnMSA9IChjb2xvcjEgPj4gOCkgJiAweEZGOw0KICAgICAgY29uc3QgYjEgPSBjb2xvcjEgJiAweEZGOw0KICAgICAgDQogICAgICBjb25zdCByMiA9IChjb2xvcjIgPj4gMTYpICYgMHhGRjsNCiAgICAgIGNvbnN0IGcyID0gKGNvbG9yMiA+PiA4KSAmIDB4RkY7DQogICAgICBjb25zdCBiMiA9IGNvbG9yMiAmIDB4RkY7DQogICAgICANCiAgICAgIGNvbnN0IHIgPSBNYXRoLnJvdW5kKHIxICogKDEgLSByYXRpbykgKyByMiAqIHJhdGlvKTsNCiAgICAgIGNvbnN0IGcgPSBNYXRoLnJvdW5kKGcxICogKDEgLSByYXRpbykgKyBnMiAqIHJhdGlvKTsNCiAgICAgIGNvbnN0IGIgPSBNYXRoLnJvdW5kKGIxICogKDEgLSByYXRpbykgKyBiMiAqIHJhdGlvKTsNCiAgICAgIA0KICAgICAgcmV0dXJuIChyIDw8IDE2KSB8IChnIDw8IDgpIHwgYjsNCiAgICB9LA0KICAgIA0KICAgIC8vIOa3u+WKoOWBpeW6t+aMh+aVsOagh+etvg0KICAgIGFkZEhlYWx0aEluZGV4TGFiZWwoc2NvcmUsIHgsIHksIHopIHsNCiAgICAgIGNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpOw0KICAgICAgY29uc3QgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpOw0KICAgICAgY2FudmFzLndpZHRoID0gMTIwOw0KICAgICAgY2FudmFzLmhlaWdodCA9IDQwOw0KICAgICAgDQogICAgICAvLyDmoLnmja7liIbmlbDorr7nva7og4zmma/popzoibINCiAgICAgIGxldCBiZ0NvbG9yID0gJ3JnYmEoMTAzLCAxOTQsIDU4LCAwLjkpJzsgLy8g57u/6ImyDQogICAgICBsZXQgdGV4dENvbG9yID0gJyNmZmZmZmYnOw0KICAgICAgaWYgKHNjb3JlID49IDkwKSB7DQogICAgICAgIGJnQ29sb3IgPSAncmdiYSgxMDMsIDE5NCwgNTgsIDAuOSknOyAvLyDnu7/oibINCiAgICAgIH0gZWxzZSBpZiAoc2NvcmUgPj0gNzUpIHsNCiAgICAgICAgYmdDb2xvciA9ICdyZ2JhKDY0LCAxNTgsIDI1NSwgMC45KSc7IC8vIOiTneiJsg0KICAgICAgfSBlbHNlIGlmIChzY29yZSA+PSA2MCkgew0KICAgICAgICBiZ0NvbG9yID0gJ3JnYmEoMjMwLCAxNjIsIDYwLCAwLjkpJzsgLy8g6buE6ImyDQogICAgICAgIHRleHRDb2xvciA9ICcjZmZmZmZmJzsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIGJnQ29sb3IgPSAncmdiYSgyNDUsIDEwOCwgMTA4LCAwLjkpJzsgLy8g57qi6ImyDQogICAgICB9DQogICAgICANCiAgICAgIC8vIOe7mOWItuiDjOaZrw0KICAgICAgY29udGV4dC5maWxsU3R5bGUgPSBiZ0NvbG9yOw0KICAgICAgY29udGV4dC5zaGFkb3dDb2xvciA9ICdyZ2JhKDAsIDAsIDAsIDAuMiknOw0KICAgICAgY29udGV4dC5zaGFkb3dCbHVyID0gNTsNCiAgICAgIGNvbnRleHQuc2hhZG93T2Zmc2V0WCA9IDE7DQogICAgICBjb250ZXh0LnNoYWRvd09mZnNldFkgPSAxOw0KICAgICAgDQogICAgICBjb25zdCByYWRpdXMgPSA2Ow0KICAgICAgY29udGV4dC5iZWdpblBhdGgoKTsNCiAgICAgIGNvbnRleHQubW92ZVRvKHJhZGl1cywgMCk7DQogICAgICBjb250ZXh0LmxpbmVUbyhjYW52YXMud2lkdGggLSByYWRpdXMsIDApOw0KICAgICAgY29udGV4dC5xdWFkcmF0aWNDdXJ2ZVRvKGNhbnZhcy53aWR0aCwgMCwgY2FudmFzLndpZHRoLCByYWRpdXMpOw0KICAgICAgY29udGV4dC5saW5lVG8oY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0IC0gcmFkaXVzKTsNCiAgICAgIGNvbnRleHQucXVhZHJhdGljQ3VydmVUbyhjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQsIGNhbnZhcy53aWR0aCAtIHJhZGl1cywgY2FudmFzLmhlaWdodCk7DQogICAgICBjb250ZXh0LmxpbmVUbyhyYWRpdXMsIGNhbnZhcy5oZWlnaHQpOw0KICAgICAgY29udGV4dC5xdWFkcmF0aWNDdXJ2ZVRvKDAsIGNhbnZhcy5oZWlnaHQsIDAsIGNhbnZhcy5oZWlnaHQgLSByYWRpdXMpOw0KICAgICAgY29udGV4dC5saW5lVG8oMCwgcmFkaXVzKTsNCiAgICAgIGNvbnRleHQucXVhZHJhdGljQ3VydmVUbygwLCAwLCByYWRpdXMsIDApOw0KICAgICAgY29udGV4dC5jbG9zZVBhdGgoKTsNCiAgICAgIGNvbnRleHQuZmlsbCgpOw0KICAgICAgDQogICAgICAvLyDnu5jliLbmloflrZcNCiAgICAgIGNvbnRleHQuZmlsbFN0eWxlID0gdGV4dENvbG9yOw0KICAgICAgY29udGV4dC5mb250ID0gJ2JvbGQgMThweCBBcmlhbCc7DQogICAgICBjb250ZXh0LnRleHRBbGlnbiA9ICdjZW50ZXInOw0KICAgICAgY29udGV4dC50ZXh0QmFzZWxpbmUgPSAnbWlkZGxlJzsNCiAgICAgIGNvbnRleHQuZmlsbFRleHQoYCR7c2NvcmV9YCwgY2FudmFzLndpZHRoIC8gMiwgY2FudmFzLmhlaWdodCAvIDIgLSA1KTsNCiAgICAgIA0KICAgICAgY29udGV4dC5mb250ID0gJzEycHggQXJpYWwnOw0KICAgICAgY29udGV4dC5maWxsVGV4dCgn5YGl5bq35oyH5pWwJywgY2FudmFzLndpZHRoIC8gMiwgY2FudmFzLmhlaWdodCAvIDIgKyAxMCk7DQogICAgICANCiAgICAgIC8vIOWIm+W7uue6ueeQhg0KICAgICAgY29uc3QgdGV4dHVyZSA9IG5ldyBUSFJFRS5DYW52YXNUZXh0dXJlKGNhbnZhcyk7DQogICAgICB0ZXh0dXJlLm5lZWRzVXBkYXRlID0gdHJ1ZTsNCiAgICAgIA0KICAgICAgLy8g5Yib5bu657K+54G1DQogICAgICBjb25zdCBzcHJpdGVNYXRlcmlhbCA9IG5ldyBUSFJFRS5TcHJpdGVNYXRlcmlhbCh7DQogICAgICAgIG1hcDogdGV4dHVyZSwNCiAgICAgICAgdHJhbnNwYXJlbnQ6IHRydWUsDQogICAgICAgIGRlcHRoVGVzdDogZmFsc2UNCiAgICAgIH0pOw0KICAgICAgY29uc3Qgc3ByaXRlID0gbmV3IFRIUkVFLlNwcml0ZShzcHJpdGVNYXRlcmlhbCk7DQogICAgICBzcHJpdGUucG9zaXRpb24uc2V0KHgsIHksIHopOw0KICAgICAgc3ByaXRlLnNjYWxlLnNldCgyLCAyLCAxKTsNCiAgICAgIA0KICAgICAgdGhpcy5zY2VuZS5hZGQoc3ByaXRlKTsNCiAgICAgIHRoaXMubGFiZWxzLnB1c2goc3ByaXRlKTsNCiAgICB9LA0KICAgIA0KICAgIC8vIOiOt+WPluWBpeW6t+etiee6pw0KICAgIGdldEhlYWx0aExldmVsKGZhcm0pIHsNCiAgICAgIGNvbnN0IHNjb3JlID0gdGhpcy5jYWxjdWxhdGVIZWFsdGhTY29yZShmYXJtKTsNCiAgICAgIA0KICAgICAgaWYgKHNjb3JlID49IDkwKSB7DQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgdGV4dDogJ+S8mOengCcsDQogICAgICAgICAgZGVzYzogJ+eOr+Wig+adoeS7tumdnuW4uOmAguWunOS9nOeJqeeUn+mVvycsDQogICAgICAgICAgY2xhc3M6ICdsZXZlbC1leGNlbGxlbnQnDQogICAgICAgIH07DQogICAgICB9IGVsc2UgaWYgKHNjb3JlID49IDc1KSB7DQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgdGV4dDogJ+iJr+WlvScsDQogICAgICAgICAgZGVzYzogJ+eOr+Wig+adoeS7tumAguWunO+8jOWPr+aMgee7reebkea1iycsDQogICAgICAgICAgY2xhc3M6ICdsZXZlbC1nb29kJw0KICAgICAgICB9Ow0KICAgICAgfSBlbHNlIGlmIChzY29yZSA+PSA2MCkgew0KICAgICAgICByZXR1cm4gew0KICAgICAgICAgIHRleHQ6ICfkuIDoiKwnLA0KICAgICAgICAgIGRlc2M6ICfpg6jliIbmjIfmoIfpnIDopoHosIPmlbTkvJjljJYnLA0KICAgICAgICAgIGNsYXNzOiAnbGV2ZWwtbm9ybWFsJw0KICAgICAgICB9Ow0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICB0ZXh0OiAn6ZyA5pS55ZaEJywNCiAgICAgICAgICBkZXNjOiAn546v5aKD5p2h5Lu26ZyA6KaB5Y+K5pe26LCD5pW0JywNCiAgICAgICAgICBjbGFzczogJ2xldmVsLXBvb3InDQogICAgICAgIH07DQogICAgICB9DQogICAgfSwNCiAgICANCiAgICAvLyDojrflj5blgaXlurfor4TliIbmuJDlj5joibINCiAgICBnZXRIZWFsdGhTY29yZUdyYWRpZW50KGZhcm0pIHsNCiAgICAgIGNvbnN0IHNjb3JlID0gdGhpcy5jYWxjdWxhdGVIZWFsdGhTY29yZShmYXJtKTsNCiAgICAgIA0KICAgICAgaWYgKHNjb3JlID49IDkwKSB7DQogICAgICAgIHJldHVybiAnbGluZWFyLWdyYWRpZW50KDEzNWRlZywgIzY2N2VlYSAwJSwgIzc2NGJhMiAxMDAlKSc7DQogICAgICB9IGVsc2UgaWYgKHNjb3JlID49IDc1KSB7DQogICAgICAgIHJldHVybiAnbGluZWFyLWdyYWRpZW50KDEzNWRlZywgIzQzZTk3YiAwJSwgIzM4ZjlkNyAxMDAlKSc7DQogICAgICB9IGVsc2UgaWYgKHNjb3JlID49IDYwKSB7DQogICAgICAgIHJldHVybiAnbGluZWFyLWdyYWRpZW50KDEzNWRlZywgI2ZhNzA5YSAwJSwgI2ZlZTE0MCAxMDAlKSc7DQogICAgICB9IGVsc2Ugew0KICAgICAgICByZXR1cm4gJ2xpbmVhci1ncmFkaWVudCgxMzVkZWcsICNmMDkzZmIgMCUsICNmNTU3NmMgMTAwJSknOw0KICAgICAgfQ0KICAgIH0sDQogICAgDQogICAgLy8g6I635Y+W546v5aKD5oyH5qCH5pWw5o2uDQogICAgZ2V0RW52TWV0cmljcyhmYXJtKSB7DQogICAgICBpZiAoIWZhcm0pIHJldHVybiBbXTsNCiAgICAgIA0KICAgICAgcmV0dXJuIFsNCiAgICAgICAgew0KICAgICAgICAgIGtleTogJ3RlbXAnLA0KICAgICAgICAgIGxhYmVsOiAn5rip5bqmJywNCiAgICAgICAgICB2YWx1ZTogYCR7ZmFybS50ZW1wZXJhdHVyZX3CsENgLA0KICAgICAgICAgIGljb246ICfwn4yh77iPJywNCiAgICAgICAgICBwZXJjZW50OiB0aGlzLm5vcm1hbGl6ZVZhbHVlKGZhcm0udGVtcGVyYXR1cmUsIDAsIDQwLCAxMDApLA0KICAgICAgICAgIGNvbG9yOiB0aGlzLmdldE1ldHJpY0NvbG9yKGZhcm0udGVtcGVyYXR1cmUsIDIwLCAyOCwgMTUsIDMyKSwNCiAgICAgICAgICBzdGF0dXM6IHRoaXMuZ2V0TWV0cmljU3RhdHVzKGZhcm0udGVtcGVyYXR1cmUsIDIwLCAyOCwgMTUsIDMyKSwNCiAgICAgICAgICBzdGF0dXNDb2xvcjogdGhpcy5nZXRNZXRyaWNTdGF0dXNDb2xvcihmYXJtLnRlbXBlcmF0dXJlLCAyMCwgMjgsIDE1LCAzMikNCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgIGtleTogJ2Fpckh1bScsDQogICAgICAgICAgbGFiZWw6ICfnqbrmsJTmub/luqYnLA0KICAgICAgICAgIHZhbHVlOiBgJHtmYXJtLmFpcmh1bWlkaXR5fSVgLA0KICAgICAgICAgIGljb246ICfwn5KnJywNCiAgICAgICAgICBwZXJjZW50OiBmYXJtLmFpcmh1bWlkaXR5LA0KICAgICAgICAgIGNvbG9yOiB0aGlzLmdldE1ldHJpY0NvbG9yKGZhcm0uYWlyaHVtaWRpdHksIDYwLCA4MCwgNTAsIDkwKSwNCiAgICAgICAgICBzdGF0dXM6IHRoaXMuZ2V0TWV0cmljU3RhdHVzKGZhcm0uYWlyaHVtaWRpdHksIDYwLCA4MCwgNTAsIDkwKSwNCiAgICAgICAgICBzdGF0dXNDb2xvcjogdGhpcy5nZXRNZXRyaWNTdGF0dXNDb2xvcihmYXJtLmFpcmh1bWlkaXR5LCA2MCwgODAsIDUwLCA5MCkNCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgIGtleTogJ3NvaWxIdW0nLA0KICAgICAgICAgIGxhYmVsOiAn5Zyf5aOk5rm/5bqmJywNCiAgICAgICAgICB2YWx1ZTogYCR7ZmFybS5zb2lsaHVtaWRpdHl9JWAsDQogICAgICAgICAgaWNvbjogJ/CfjLEnLA0KICAgICAgICAgIHBlcmNlbnQ6IGZhcm0uc29pbGh1bWlkaXR5LA0KICAgICAgICAgIGNvbG9yOiB0aGlzLmdldE1ldHJpY0NvbG9yKGZhcm0uc29pbGh1bWlkaXR5LCA0MCwgNzAsIDMwLCA4MCksDQogICAgICAgICAgc3RhdHVzOiB0aGlzLmdldE1ldHJpY1N0YXR1cyhmYXJtLnNvaWxodW1pZGl0eSwgNDAsIDcwLCAzMCwgODApLA0KICAgICAgICAgIHN0YXR1c0NvbG9yOiB0aGlzLmdldE1ldHJpY1N0YXR1c0NvbG9yKGZhcm0uc29pbGh1bWlkaXR5LCA0MCwgNzAsIDMwLCA4MCkNCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgIGtleTogJ2xpZ2h0JywNCiAgICAgICAgICBsYWJlbDogJ+WFieeFpycsDQogICAgICAgICAgdmFsdWU6IGAkeyhmYXJtLmxpZ2h0IC8gMTAwMCkudG9GaXhlZCgxKX1rYCwNCiAgICAgICAgICBpY29uOiAn4piA77iPJywNCiAgICAgICAgICBwZXJjZW50OiB0aGlzLm5vcm1hbGl6ZVZhbHVlKGZhcm0ubGlnaHQsIDAsIDYwMDAwLCAxMDApLA0KICAgICAgICAgIGNvbG9yOiB0aGlzLmdldE1ldHJpY0NvbG9yKGZhcm0ubGlnaHQsIDIwMDAwLCA1MDAwMCwgMTAwMDAsIDYwMDAwKSwNCiAgICAgICAgICBzdGF0dXM6IHRoaXMuZ2V0TWV0cmljU3RhdHVzKGZhcm0ubGlnaHQsIDIwMDAwLCA1MDAwMCwgMTAwMDAsIDYwMDAwKSwNCiAgICAgICAgICBzdGF0dXNDb2xvcjogdGhpcy5nZXRNZXRyaWNTdGF0dXNDb2xvcihmYXJtLmxpZ2h0LCAyMDAwMCwgNTAwMDAsIDEwMDAwLCA2MDAwMCkNCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgIGtleTogJ2NhcmJvbicsDQogICAgICAgICAgbGFiZWw6ICdDT+KCgicsDQogICAgICAgICAgdmFsdWU6IGAke2Zhcm0uY2FyYm9ufXBwbWAsDQogICAgICAgICAgaWNvbjogJ/CfjKvvuI8nLA0KICAgICAgICAgIHBlcmNlbnQ6IHRoaXMubm9ybWFsaXplVmFsdWUoZmFybS5jYXJib24sIDMwMCwgNTAwLCAxMDApLA0KICAgICAgICAgIGNvbG9yOiB0aGlzLmdldE1ldHJpY0NvbG9yKGZhcm0uY2FyYm9uLCAzNTAsIDQ1MCwgMzAwLCA1MDApLA0KICAgICAgICAgIHN0YXR1czogdGhpcy5nZXRNZXRyaWNTdGF0dXMoZmFybS5jYXJib24sIDM1MCwgNDUwLCAzMDAsIDUwMCksDQogICAgICAgICAgc3RhdHVzQ29sb3I6IHRoaXMuZ2V0TWV0cmljU3RhdHVzQ29sb3IoZmFybS5jYXJib24sIDM1MCwgNDUwLCAzMDAsIDUwMCkNCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgIGtleTogJ3BoJywNCiAgICAgICAgICBsYWJlbDogJ1BI5YC8JywNCiAgICAgICAgICB2YWx1ZTogZmFybS5waCwNCiAgICAgICAgICBpY29uOiAn4pqX77iPJywNCiAgICAgICAgICBwZXJjZW50OiB0aGlzLm5vcm1hbGl6ZVZhbHVlKGZhcm0ucGgsIDUsIDgsIDEwMCksDQogICAgICAgICAgY29sb3I6IHRoaXMuZ2V0TWV0cmljQ29sb3IoZmFybS5waCwgNi4wLCA3LjUsIDUuNSwgOC4wKSwNCiAgICAgICAgICBzdGF0dXM6IHRoaXMuZ2V0TWV0cmljU3RhdHVzKGZhcm0ucGgsIDYuMCwgNy41LCA1LjUsIDguMCksDQogICAgICAgICAgc3RhdHVzQ29sb3I6IHRoaXMuZ2V0TWV0cmljU3RhdHVzQ29sb3IoZmFybS5waCwgNi4wLCA3LjUsIDUuNSwgOC4wKQ0KICAgICAgICB9DQogICAgICBdOw0KICAgIH0sDQogICAgDQogICAgLy8g5qCH5YeG5YyW5pWw5YC85Yiw55m+5YiG5q+UDQogICAgbm9ybWFsaXplVmFsdWUodmFsdWUsIG1pbiwgbWF4LCBzY2FsZSA9IDEwMCkgew0KICAgICAgcmV0dXJuIE1hdGgubWluKE1hdGgubWF4KCgodmFsdWUgLSBtaW4pIC8gKG1heCAtIG1pbikpICogc2NhbGUsIDApLCBzY2FsZSk7DQogICAgfSwNCiAgICANCiAgICAvLyDojrflj5bmjIfmoIfpopzoibINCiAgICBnZXRNZXRyaWNDb2xvcih2YWx1ZSwgaWRlYWxNaW4sIGlkZWFsTWF4LCBhY2NlcHRNaW4sIGFjY2VwdE1heCkgew0KICAgICAgaWYgKHZhbHVlID49IGlkZWFsTWluICYmIHZhbHVlIDw9IGlkZWFsTWF4KSB7DQogICAgICAgIHJldHVybiAnIzY3QzIzQSc7IC8vIOe7v+iJsiAtIOeQhuaDsw0KICAgICAgfSBlbHNlIGlmICh2YWx1ZSA+PSBhY2NlcHRNaW4gJiYgdmFsdWUgPD0gYWNjZXB0TWF4KSB7DQogICAgICAgIHJldHVybiAnI0U2QTIzQyc7IC8vIOapmeiJsiAtIOWPr+aOpeWPlw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgcmV0dXJuICcjRjU2QzZDJzsgLy8g57qi6ImyIC0g6ZyA5pS55ZaEDQogICAgICB9DQogICAgfSwNCiAgICANCiAgICAvLyDojrflj5bmjIfmoIfnirbmgIHmlofmnKwNCiAgICBnZXRNZXRyaWNTdGF0dXModmFsdWUsIGlkZWFsTWluLCBpZGVhbE1heCwgYWNjZXB0TWluLCBhY2NlcHRNYXgpIHsNCiAgICAgIGlmICh2YWx1ZSA+PSBpZGVhbE1pbiAmJiB2YWx1ZSA8PSBpZGVhbE1heCkgew0KICAgICAgICByZXR1cm4gJ+eQhuaDsyc7DQogICAgICB9IGVsc2UgaWYgKHZhbHVlID49IGFjY2VwdE1pbiAmJiB2YWx1ZSA8PSBhY2NlcHRNYXgpIHsNCiAgICAgICAgcmV0dXJuICfmraPluLgnOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgcmV0dXJuICfpooToraYnOw0KICAgICAgfQ0KICAgIH0sDQogICAgDQogICAgLy8g6I635Y+W5oyH5qCH54q25oCB6aKc6ImyDQogICAgZ2V0TWV0cmljU3RhdHVzQ29sb3IodmFsdWUsIGlkZWFsTWluLCBpZGVhbE1heCwgYWNjZXB0TWluLCBhY2NlcHRNYXgpIHsNCiAgICAgIGlmICh2YWx1ZSA+PSBpZGVhbE1pbiAmJiB2YWx1ZSA8PSBpZGVhbE1heCkgew0KICAgICAgICByZXR1cm4gJyM2N0MyM0EnOw0KICAgICAgfSBlbHNlIGlmICh2YWx1ZSA+PSBhY2NlcHRNaW4gJiYgdmFsdWUgPD0gYWNjZXB0TWF4KSB7DQogICAgICAgIHJldHVybiAnI0U2QTIzQyc7DQogICAgICB9IGVsc2Ugew0KICAgICAgICByZXR1cm4gJyNGNTZDNkMnOw0KICAgICAgfQ0KICAgIH0sDQogICAgDQogICAgLy8g6K6h566XU1ZH5ZyG546v55qEZGFzaGFycmF5DQogICAgY2FsY3VsYXRlRGFzaEFycmF5KHBlcmNlbnQpIHsNCiAgICAgIGNvbnN0IGNpcmN1bWZlcmVuY2UgPSAyICogTWF0aC5QSSAqIDMyOyAvLyDljYrlvoQzMg0KICAgICAgY29uc3QgZmlsbGVkID0gKHBlcmNlbnQgLyAxMDApICogY2lyY3VtZmVyZW5jZTsNCiAgICAgIHJldHVybiBgJHtmaWxsZWR9ICR7Y2lyY3VtZmVyZW5jZX1gOw0KICAgIH0sDQogICAgDQogICAgLy8g6I635Y+W5pm66IO95bu66K6uDQogICAgZ2V0U21hcnRTdWdnZXN0aW9ucyhmYXJtKSB7DQogICAgICBpZiAoIWZhcm0pIHJldHVybiBbXTsNCiAgICAgIA0KICAgICAgY29uc3Qgc3VnZ2VzdGlvbnMgPSBbXTsNCiAgICAgIA0KICAgICAgLy8g5rip5bqm5bu66K6uDQogICAgICBpZiAoZmFybS50ZW1wZXJhdHVyZSA8IDIwKSB7DQogICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goew0KICAgICAgICAgIGljb246ICfwn4yh77iPJywNCiAgICAgICAgICB0ZXh0OiAn5rip5bqm5YGP5L2OJywNCiAgICAgICAgICBhY3Rpb246ICflu7rorq7lop7liqDkv53muKnmjqrmlr3miJbosIPmlbTnp43mpI3ml7bpl7QnLA0KICAgICAgICAgIHR5cGU6ICd3YXJuaW5nJw0KICAgICAgICB9KTsNCiAgICAgIH0gZWxzZSBpZiAoZmFybS50ZW1wZXJhdHVyZSA+IDI4KSB7DQogICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goew0KICAgICAgICAgIGljb246ICfwn4yh77iPJywNCiAgICAgICAgICB0ZXh0OiAn5rip5bqm5YGP6auYJywNCiAgICAgICAgICBhY3Rpb246ICflu7rorq7lop7liqDpga7pmLPnvZHmiJbliqDlvLrpgJrpo47pmY3muKknLA0KICAgICAgICAgIHR5cGU6ICd3YXJuaW5nJw0KICAgICAgICB9KTsNCiAgICAgIH0NCiAgICAgIA0KICAgICAgLy8g5rm/5bqm5bu66K6uDQogICAgICBpZiAoZmFybS5zb2lsaHVtaWRpdHkgPCA0MCkgew0KICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKHsNCiAgICAgICAgICBpY29uOiAn8J+SpycsDQogICAgICAgICAgdGV4dDogJ+Wcn+WjpOa5v+W6puS4jei2sycsDQogICAgICAgICAgYWN0aW9uOiAn5bu66K6u5Y+K5pe254GM5rqJ77yM5L+d5oyB5Zyf5aOk5rm/5ramJywNCiAgICAgICAgICB0eXBlOiAnZGFuZ2VyJw0KICAgICAgICB9KTsNCiAgICAgIH0gZWxzZSBpZiAoZmFybS5zb2lsaHVtaWRpdHkgPiA3MCkgew0KICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKHsNCiAgICAgICAgICBpY29uOiAn8J+SpycsDQogICAgICAgICAgdGV4dDogJ+Wcn+WjpOa5v+W6pui/h+mrmCcsDQogICAgICAgICAgYWN0aW9uOiAn5bu66K6u5Yqg5by65o6S5rC077yM6Ziy5q2i5qC557O76IWQ54OCJywNCiAgICAgICAgICB0eXBlOiAnd2FybmluZycNCiAgICAgICAgfSk7DQogICAgICB9DQogICAgICANCiAgICAgIC8vIOWFieeFp+W7uuiurg0KICAgICAgaWYgKGZhcm0ubGlnaHQgPCAyMDAwMCkgew0KICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKHsNCiAgICAgICAgICBpY29uOiAn4piA77iPJywNCiAgICAgICAgICB0ZXh0OiAn5YWJ54Wn5LiN6LazJywNCiAgICAgICAgICBhY3Rpb246ICflu7rorq7ooaXlhYXkurrlt6XlhYnmupDmiJbosIPmlbTnp43mpI3lr4bluqYnLA0KICAgICAgICAgIHR5cGU6ICdpbmZvJw0KICAgICAgICB9KTsNCiAgICAgIH0NCiAgICAgIA0KICAgICAgLy8gUEjlgLzlu7rorq4NCiAgICAgIGlmIChmYXJtLnBoIDwgNi4wKSB7DQogICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goew0KICAgICAgICAgIGljb246ICfimpfvuI8nLA0KICAgICAgICAgIHRleHQ6ICdQSOWAvOWBj+mFuCcsDQogICAgICAgICAgYWN0aW9uOiAn5bu66K6u5pa955So55+z54Gw5oiW6I2J5pyo54Gw6LCD6IqC5Zyf5aOk6YW456Kx5bqmJywNCiAgICAgICAgICB0eXBlOiAnd2FybmluZycNCiAgICAgICAgfSk7DQogICAgICB9IGVsc2UgaWYgKGZhcm0ucGggPiA3LjUpIHsNCiAgICAgICAgc3VnZ2VzdGlvbnMucHVzaCh7DQogICAgICAgICAgaWNvbjogJ+Kal++4jycsDQogICAgICAgICAgdGV4dDogJ1BI5YC85YGP56KxJywNCiAgICAgICAgICBhY3Rpb246ICflu7rorq7mlr3nlKjnoavno7rnsonmiJbmnInmnLrogqXosIPoioInLA0KICAgICAgICAgIHR5cGU6ICd3YXJuaW5nJw0KICAgICAgICB9KTsNCiAgICAgIH0NCiAgICAgIA0KICAgICAgLy8g5aaC5p6c5LiA5YiH5q2j5bi4DQogICAgICBpZiAoc3VnZ2VzdGlvbnMubGVuZ3RoID09PSAwKSB7DQogICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goew0KICAgICAgICAgIGljb246ICfinIUnLA0KICAgICAgICAgIHRleHQ6ICfnjq/looPmnaHku7bkvJjoia8nLA0KICAgICAgICAgIGFjdGlvbjogJ+e7p+e7reS/neaMgeW9k+WJjeeuoeeQhuaOquaWvScsDQogICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnDQogICAgICAgIH0pOw0KICAgICAgfQ0KICAgICAgDQogICAgICByZXR1cm4gc3VnZ2VzdGlvbnM7DQogICAgfSwNCiAgICANCiAgICBoaWdobGlnaHRGYXJtQmxvY2soZmFybSkgew0KICAgICAgaWYgKCFmYXJtIHx8IHRoaXMuZmFybUJsb2Nrcy5sZW5ndGggPT09IDApIHJldHVybjsNCiAgICAgIA0KICAgICAgLy8g5om+5Yiw5a+55bqU55qE5Yac55Sw57uEDQogICAgICBjb25zdCBncm91cCA9IHRoaXMuZmFybUJsb2Nrcy5maW5kKGcgPT4gZy51c2VyRGF0YS5mYXJtICYmIGcudXNlckRhdGEuZmFybS5pZCA9PT0gZmFybS5pZCk7DQogICAgICBpZiAoZ3JvdXApIHsNCiAgICAgICAgdGhpcy5zZWxlY3RCbG9jayhncm91cCk7DQogICAgICB9DQogICAgfSwNCiAgICANCiAgICBpbml0M0RNYXAoKSB7DQogICAgICBjb25zdCBjb250YWluZXIgPSB0aGlzLiRyZWZzLnRocmVlQ29udGFpbmVyOw0KICAgICAgaWYgKCFjb250YWluZXIpIHsNCiAgICAgICAgY29uc29sZS53YXJuKCczROWuueWZqOacquaJvuWIsCcpOw0KICAgICAgICByZXR1cm47DQogICAgICB9DQogICAgICBpZiAodGhpcy5mYXJtcy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgY29uc29sZS53YXJuKCfmsqHmnInlhpznlLDmlbDmja7vvIzml6Dms5XliJ3lp4vljJYzROWcsOWbvicpOw0KICAgICAgICByZXR1cm47DQogICAgICB9DQogICAgICANCiAgICAgIC8vIOWmguaenOW3sue7j+WIneWni+WMlui/h++8jOWFiOa4heeQhg0KICAgICAgaWYgKHRoaXMucmVuZGVyZXIpIHsNCiAgICAgICAgdGhpcy5yZW5kZXJlci5kaXNwb3NlKCk7DQogICAgICAgIGlmIChjb250YWluZXIuY29udGFpbnModGhpcy5yZW5kZXJlci5kb21FbGVtZW50KSkgew0KICAgICAgICAgIGNvbnRhaW5lci5yZW1vdmVDaGlsZCh0aGlzLnJlbmRlcmVyLmRvbUVsZW1lbnQpOw0KICAgICAgICB9DQogICAgICB9DQogICAgICANCiAgICAgIGNvbnN0IHdpZHRoID0gY29udGFpbmVyLmNsaWVudFdpZHRoOw0KICAgICAgY29uc3QgaGVpZ2h0ID0gY29udGFpbmVyLmNsaWVudEhlaWdodDsNCiAgICAgIA0KICAgICAgLy8g5Yib5bu65Zy65pmvDQogICAgICB0aGlzLnNjZW5lID0gbmV3IFRIUkVFLlNjZW5lKCk7DQogICAgICANCiAgICAgIC8vIOWIm+W7uuebuOacug0KICAgICAgdGhpcy5jYW1lcmEgPSBuZXcgVEhSRUUuUGVyc3BlY3RpdmVDYW1lcmEoNjAsIHdpZHRoIC8gaGVpZ2h0LCAwLjEsIDEwMDApOw0KICAgICAgdGhpcy5jYW1lcmEucG9zaXRpb24uc2V0KDQwLCA1MCwgNDApOw0KICAgICAgdGhpcy5jYW1lcmEubG9va0F0KDAsIDAsIDApOw0KICAgICAgDQogICAgICAvLyDliJvlu7rmuLLmn5PlmaggLSDkvJjljJbmgKfog73orr7nva4NCiAgICAgIHRoaXMucmVuZGVyZXIgPSBuZXcgVEhSRUUuV2ViR0xSZW5kZXJlcih7IA0KICAgICAgICBhbnRpYWxpYXM6IGZhbHNlLCAvLyDlhbPpl63mipfplK/pvb/mj5DljYfmgKfog70NCiAgICAgICAgcG93ZXJQcmVmZXJlbmNlOiAnaGlnaC1wZXJmb3JtYW5jZScgLy8g5LyY5YWI5oCn6IO9DQogICAgICB9KTsNCiAgICAgIHRoaXMucmVuZGVyZXIuc2V0U2l6ZSh3aWR0aCwgaGVpZ2h0KTsNCiAgICAgIC8vIOmZkOWItuWDj+e0oOavlO+8jOmBv+WFjemrmERQSeiuvuWkh+i/h+W6pua4suafkw0KICAgICAgdGhpcy5yZW5kZXJlci5zZXRQaXhlbFJhdGlvKE1hdGgubWluKHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvLCAyKSk7DQogICAgICB0aGlzLnJlbmRlcmVyLnNoYWRvd01hcC5lbmFibGVkID0gdHJ1ZTsNCiAgICAgIHRoaXMucmVuZGVyZXIuc2hhZG93TWFwLnR5cGUgPSBUSFJFRS5QQ0ZTb2Z0U2hhZG93TWFwOyAvLyDkvb/nlKjova/pmLTlvbENCiAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLnJlbmRlcmVyLmRvbUVsZW1lbnQpOw0KICAgICAgDQogICAgICAvLyDmt7vliqDovajpgZPmjqfliLblmaggLSDkvJjljJbphY3nva4NCiAgICAgIHRoaXMuY29udHJvbHMgPSBuZXcgT3JiaXRDb250cm9scyh0aGlzLmNhbWVyYSwgdGhpcy5yZW5kZXJlci5kb21FbGVtZW50KTsNCiAgICAgIHRoaXMuY29udHJvbHMuZW5hYmxlRGFtcGluZyA9IHRydWU7DQogICAgICB0aGlzLmNvbnRyb2xzLmRhbXBpbmdGYWN0b3IgPSAwLjA1Ow0KICAgICAgdGhpcy5jb250cm9scy5taW5EaXN0YW5jZSA9IDIwOw0KICAgICAgdGhpcy5jb250cm9scy5tYXhEaXN0YW5jZSA9IDE1MDsNCiAgICAgIHRoaXMuY29udHJvbHMubWF4UG9sYXJBbmdsZSA9IE1hdGguUEkgLyAyLjI7DQogICAgICB0aGlzLmNvbnRyb2xzLmVuYWJsZVBhbiA9IHRydWU7IC8vIOWFgeiuuOW5s+enuw0KICAgICAgdGhpcy5jb250cm9scy5lbmFibGVab29tID0gdHJ1ZTsgLy8g5YWB6K6457yp5pS+DQogICAgICB0aGlzLmNvbnRyb2xzLmVuYWJsZVJvdGF0ZSA9IHRydWU7IC8vIOWFgeiuuOaXi+i9rA0KICAgICAgdGhpcy5jb250cm9scy5yb3RhdGVTcGVlZCA9IDAuNTsgLy8g6ZmN5L2O5peL6L2s6YCf5bqm77yM5o+Q5Y2H5pON5L2c5L2T6aqMDQogICAgICB0aGlzLmNvbnRyb2xzLnpvb21TcGVlZCA9IDAuODsgLy8g6ZmN5L2O57yp5pS+6YCf5bqmDQogICAgICB0aGlzLmNvbnRyb2xzLnBhblNwZWVkID0gMC44OyAvLyDpmY3kvY7lubPnp7vpgJ/luqYNCiAgICAgIA0KICAgICAgLy8g5re75Yqg5YWJ5rqQ57O757ufDQogICAgICAvLyAxLiDnjq/looPlhYnvvIjmqKHmi5/lpKnnqbrmlaPlsITlhYnvvIkNCiAgICAgIGNvbnN0IGFtYmllbnRMaWdodCA9IG5ldyBUSFJFRS5BbWJpZW50TGlnaHQoMHhCMEM0REUsIDAuNik7DQogICAgICB0aGlzLnNjZW5lLmFkZChhbWJpZW50TGlnaHQpOw0KICAgICAgDQogICAgICAvLyAyLiDkuLvlhYnmupDvvIjlpKrpmLPlhYnvvIktIOmZjeS9jumYtOW9seWIhui+qOeOh+aPkOWNh+aAp+iDvQ0KICAgICAgY29uc3Qgc3VuTGlnaHQgPSBuZXcgVEhSRUUuRGlyZWN0aW9uYWxMaWdodCgweEZGRjhEQywgMS4yKTsNCiAgICAgIHN1bkxpZ2h0LnBvc2l0aW9uLnNldCg2MCwgMTAwLCA0MCk7DQogICAgICBzdW5MaWdodC5jYXN0U2hhZG93ID0gdHJ1ZTsNCiAgICAgIHN1bkxpZ2h0LnNoYWRvdy5tYXBTaXplLndpZHRoID0gMTAyNDsgLy8g6ZmN5L2O6Zi05b2x5YiG6L6o546H77yaMjA0OCAtPiAxMDI0DQogICAgICBzdW5MaWdodC5zaGFkb3cubWFwU2l6ZS5oZWlnaHQgPSAxMDI0Ow0KICAgICAgc3VuTGlnaHQuc2hhZG93LmNhbWVyYS5uZWFyID0gMC41Ow0KICAgICAgc3VuTGlnaHQuc2hhZG93LmNhbWVyYS5mYXIgPSAyNTA7DQogICAgICBzdW5MaWdodC5zaGFkb3cuY2FtZXJhLmxlZnQgPSAtMTAwOw0KICAgICAgc3VuTGlnaHQuc2hhZG93LmNhbWVyYS5yaWdodCA9IDEwMDsNCiAgICAgIHN1bkxpZ2h0LnNoYWRvdy5jYW1lcmEudG9wID0gMTAwOw0KICAgICAgc3VuTGlnaHQuc2hhZG93LmNhbWVyYS5ib3R0b20gPSAtMTAwOw0KICAgICAgc3VuTGlnaHQuc2hhZG93LmJpYXMgPSAtMC4wMDAxOw0KICAgICAgc3VuTGlnaHQuc2hhZG93LnJhZGl1cyA9IDQ7IC8vIOa3u+WKoOmYtOW9seaooeeziuWNiuW+hO+8jOWHj+WwkemUr+m9vw0KICAgICAgdGhpcy5zY2VuZS5hZGQoc3VuTGlnaHQpOw0KICAgICAgDQogICAgICAvLyAzLiDljYrnkIPlhYnvvIjlpKnnqbrlkozlnLDpnaLnmoTpopzoibLov4fmuKHvvIkNCiAgICAgIGNvbnN0IGhlbWlzcGhlcmVMaWdodCA9IG5ldyBUSFJFRS5IZW1pc3BoZXJlTGlnaHQoMHg4N0NFRUIsIDB4NkI1RDRGLCAwLjUpOw0KICAgICAgdGhpcy5zY2VuZS5hZGQoaGVtaXNwaGVyZUxpZ2h0KTsNCiAgICAgIA0KICAgICAgdGhpcy5jcmVhdGVHcm91bmQoKTsNCiAgICAgIA0KICAgICAgLy8g5Yib5bu65Yac55Sw5pa55Z2XDQogICAgICB0aGlzLmNyZWF0ZUZhcm1CbG9ja3MoKTsNCiAgICAgIA0KICAgICAgLy8g5Yid5aeL5YyW5bCE57q/5qOA5rWLDQogICAgICB0aGlzLnJheWNhc3RlciA9IG5ldyBUSFJFRS5SYXljYXN0ZXIoKTsNCiAgICAgIHRoaXMubW91c2UgPSBuZXcgVEhSRUUuVmVjdG9yMigpOw0KICAgICAgDQogICAgICAvLyDnu5Hlrprkuovku7blpITnkIblh73mlbDvvIjkv53lrZjlvJXnlKjku6Xkvr/lkI7nu63muIXnkIbvvIkNCiAgICAgIHRoaXMuYm91bmRNb3VzZUNsaWNrID0gdGhpcy5vbk1vdXNlQ2xpY2suYmluZCh0aGlzKTsNCiAgICAgIHRoaXMuYm91bmRNb3VzZU1vdmUgPSB0aGlzLm9uTW91c2VNb3ZlLmJpbmQodGhpcyk7DQogICAgICB0aGlzLmJvdW5kV2luZG93UmVzaXplID0gdGhpcy5vbldpbmRvd1Jlc2l6ZS5iaW5kKHRoaXMpOw0KICAgICAgDQogICAgICAvLyDmt7vliqDpvKDmoIfkuovku7YNCiAgICAgIGNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuYm91bmRNb3VzZUNsaWNrKTsNCiAgICAgIGNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCB0aGlzLmJvdW5kTW91c2VNb3ZlLCB7IHBhc3NpdmU6IHRydWUgfSk7IC8vIOS9v+eUqHBhc3NpdmXmj5DljYfmgKfog70NCiAgICAgIA0KICAgICAgLy8g56qX5Y+j5aSn5bCP6LCD5pW0DQogICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgdGhpcy5ib3VuZFdpbmRvd1Jlc2l6ZSk7DQogICAgICANCiAgICAgIC8vIOW8gOWni+WKqOeUu+W+queOrw0KICAgICAgdGhpcy5hbmltYXRlKCk7DQogICAgfSwNCiAgICANCiAgICBjcmVhdGVTb2lsVGV4dHVyZSgpIHsNCiAgICAgIC8vIOWIm+W7uuWcn+WjpOe6ueeQhiAtIOS8mOWMlue6ueeQhueUn+aIkOaAp+iDvQ0KICAgICAgY29uc3QgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7DQogICAgICBjYW52YXMud2lkdGggPSAyNTY7IC8vIOmZjeS9jue6ueeQhuWIhui+qOeOh++8mjUxMiAtPiAyNTYNCiAgICAgIGNhbnZhcy5oZWlnaHQgPSAyNTY7DQogICAgICBjb25zdCBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTsNCiAgICAgIA0KICAgICAgLy8g5Z+656GA5Zyf5aOk6aKc6ImyDQogICAgICBjb25zdCBzb2lsQ29sb3JzID0gWw0KICAgICAgICAnIzVENEUzNycsIC8vIOa3seajlQ0KICAgICAgICAnIzZCNUQ0RicsIC8vIOS4reajlQ0KICAgICAgICAnIzdBNkE1MicsIC8vIOa1heajlQ0KICAgICAgICAnIzhCNzM1NScsIC8vIOWcn+m7hA0KICAgICAgICAnIzRBM0MyQScgIC8vIOaal+ajlQ0KICAgICAgXTsNCiAgICAgIA0KICAgICAgLy8g5aGr5YWF5Z+656GA6aKc6ImyDQogICAgICBjdHguZmlsbFN0eWxlID0gc29pbENvbG9yc1sxXTsNCiAgICAgIGN0eC5maWxsUmVjdCgwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpOw0KICAgICAgDQogICAgICAvLyDlh4/lsJHpopfnspLmlbDph4/mj5DljYfmgKfog73vvJo1MDAwIC0+IDE1MDANCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTUwMDsgaSsrKSB7DQogICAgICAgIGNvbnN0IHggPSBNYXRoLnJhbmRvbSgpICogY2FudmFzLndpZHRoOw0KICAgICAgICBjb25zdCB5ID0gTWF0aC5yYW5kb20oKSAqIGNhbnZhcy5oZWlnaHQ7DQogICAgICAgIGNvbnN0IHNpemUgPSBNYXRoLnJhbmRvbSgpICogMiArIDAuNTsgLy8g56iN5b6u5YeP5bCP6aKX57KS5aSn5bCPDQogICAgICAgIGNvbnN0IGNvbG9ySW5kZXggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBzb2lsQ29sb3JzLmxlbmd0aCk7DQogICAgICAgIA0KICAgICAgICBjdHguZmlsbFN0eWxlID0gc29pbENvbG9yc1tjb2xvckluZGV4XTsNCiAgICAgICAgY3R4Lmdsb2JhbEFscGhhID0gTWF0aC5yYW5kb20oKSAqIDAuNSArIDAuMzsgLy8g6ZmN5L2O6YCP5piO5bqm5Y+Y5YyW6IyD5Zu0DQogICAgICAgIGN0eC5iZWdpblBhdGgoKTsNCiAgICAgICAgY3R4LmFyYyh4LCB5LCBzaXplLCAwLCBNYXRoLlBJICogMik7DQogICAgICAgIGN0eC5maWxsKCk7DQogICAgICB9DQogICAgICANCiAgICAgIC8vIOa3u+WKoOWcn+WjpOijgue6uQ0KICAgICAgY3R4Lmdsb2JhbEFscGhhID0gMC4zOw0KICAgICAgY3R4LnN0cm9rZVN0eWxlID0gJyM0QTNDMkEnOw0KICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAzNTsgaSsrKSB7DQogICAgICAgIGN0eC5saW5lV2lkdGggPSBNYXRoLnJhbmRvbSgpICogMiArIDAuNTsNCiAgICAgICAgY3R4LmJlZ2luUGF0aCgpOw0KICAgICAgICBjb25zdCBzdGFydFggPSBNYXRoLnJhbmRvbSgpICogY2FudmFzLndpZHRoOw0KICAgICAgICBjb25zdCBzdGFydFkgPSBNYXRoLnJhbmRvbSgpICogY2FudmFzLmhlaWdodDsNCiAgICAgICAgY3R4Lm1vdmVUbyhzdGFydFgsIHN0YXJ0WSk7DQogICAgICAgIA0KICAgICAgICBjb25zdCBzZWdtZW50cyA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDQpICsgMzsNCiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBzZWdtZW50czsgaisrKSB7DQogICAgICAgICAgY29uc3QgZW5kWCA9IHN0YXJ0WCArIChNYXRoLnJhbmRvbSgpIC0gMC41KSAqIDcwOw0KICAgICAgICAgIGNvbnN0IGVuZFkgPSBzdGFydFkgKyAoTWF0aC5yYW5kb20oKSAtIDAuNSkgKiA3MDsNCiAgICAgICAgICBjdHgubGluZVRvKGVuZFgsIGVuZFkpOw0KICAgICAgICB9DQogICAgICAgIGN0eC5zdHJva2UoKTsNCiAgICAgIH0NCiAgICAgIA0KICAgICAgLy8g5re75Yqg5bCP55+z5a2QDQogICAgICBjdHguZ2xvYmFsQWxwaGEgPSAwLjc7DQogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDE1MDsgaSsrKSB7DQogICAgICAgIGNvbnN0IHggPSBNYXRoLnJhbmRvbSgpICogY2FudmFzLndpZHRoOw0KICAgICAgICBjb25zdCB5ID0gTWF0aC5yYW5kb20oKSAqIGNhbnZhcy5oZWlnaHQ7DQogICAgICAgIGNvbnN0IHNpemUgPSBNYXRoLnJhbmRvbSgpICogNCArIDE7DQogICAgICAgIA0KICAgICAgICBjdHguZmlsbFN0eWxlID0gTWF0aC5yYW5kb20oKSA+IDAuNSA/ICcjOUI4QjdFJyA6ICcjOEE3OTY4JzsNCiAgICAgICAgY3R4LmJlZ2luUGF0aCgpOw0KICAgICAgICBjdHguYXJjKHgsIHksIHNpemUsIDAsIE1hdGguUEkgKiAyKTsNCiAgICAgICAgY3R4LmZpbGwoKTsNCiAgICAgIH0NCiAgICAgIA0KICAgICAgY3R4Lmdsb2JhbEFscGhhID0gMS4wOw0KICAgICAgDQogICAgICByZXR1cm4gbmV3IFRIUkVFLkNhbnZhc1RleHR1cmUoY2FudmFzKTsNCiAgICB9LA0KICAgIA0KICAgIGNyZWF0ZUdyb3VuZCgpIHsNCiAgICAgIC8vIOWIm+W7uuWcsOmdou+8iOW4pui1t+S8j+eahOWcn+WjpOe6ueeQhu+8iS0g6ZmN5L2O5YiG5q615pWw5o+Q5Y2H5oCn6IO9DQogICAgICBjb25zdCBncm91bmRHZW9tZXRyeSA9IG5ldyBUSFJFRS5QbGFuZUdlb21ldHJ5KDIwMCwgMjAwLCA0MCwgNDApOyAvLyDpmY3kvY7liIbmrrXmlbDvvJo4MHg4MCAtPiA0MHg0MA0KICAgICAgY29uc3QgcG9zaXRpb25zID0gZ3JvdW5kR2VvbWV0cnkuYXR0cmlidXRlcy5wb3NpdGlvbjsNCiAgICAgIA0KICAgICAgLy8g5re75Yqg5pu06Ieq54S255qE5Zyw5b2i6LW35LyP77yI5LyY5YyW5b6q546v77yJDQogICAgICBjb25zdCBwb3NpdGlvbkFycmF5ID0gcG9zaXRpb25zLmFycmF5Ow0KICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwb3NpdGlvbkFycmF5Lmxlbmd0aDsgaSArPSAzKSB7DQogICAgICAgIGNvbnN0IHggPSBwb3NpdGlvbkFycmF5W2ldOw0KICAgICAgICBjb25zdCB5ID0gcG9zaXRpb25BcnJheVtpICsgMV07DQogICAgICAgIGNvbnN0IG5vaXNlID0gTWF0aC5zaW4oeCAqIDAuMDUpICogTWF0aC5jb3MoeSAqIDAuMDUpICogMC41ICsgDQogICAgICAgICAgICAgICAgICAgICBNYXRoLnNpbih4ICogMC4yKSAqIE1hdGguY29zKHkgKiAwLjIpICogMC4yOw0KICAgICAgICBwb3NpdGlvbkFycmF5W2kgKyAyXSA9IG5vaXNlOw0KICAgICAgfQ0KICAgICAgcG9zaXRpb25zLm5lZWRzVXBkYXRlID0gdHJ1ZTsNCiAgICAgIGdyb3VuZEdlb21ldHJ5LmNvbXB1dGVWZXJ0ZXhOb3JtYWxzKCk7DQogICAgICANCiAgICAgIC8vIOWIm+W7uuWcn+WjpOe6ueeQhg0KICAgICAgY29uc3Qgc29pbFRleHR1cmUgPSB0aGlzLmNyZWF0ZVNvaWxUZXh0dXJlKCk7DQogICAgICBzb2lsVGV4dHVyZS53cmFwUyA9IFRIUkVFLlJlcGVhdFdyYXBwaW5nOw0KICAgICAgc29pbFRleHR1cmUud3JhcFQgPSBUSFJFRS5SZXBlYXRXcmFwcGluZzsNCiAgICAgIHNvaWxUZXh0dXJlLnJlcGVhdC5zZXQoMTgsIDE4KTsNCiAgICAgIA0KICAgICAgLy8g5Yib5bu65bim57q555CG55qE5Zyf5aOk5p2Q6LSoDQogICAgICBjb25zdCBncm91bmRNYXRlcmlhbCA9IG5ldyBUSFJFRS5NZXNoU3RhbmRhcmRNYXRlcmlhbCh7IA0KICAgICAgICBtYXA6IHNvaWxUZXh0dXJlLA0KICAgICAgICByb3VnaG5lc3M6IDAuOTUsDQogICAgICAgIG1ldGFsbmVzczogMC4wNSwNCiAgICAgICAgZmxhdFNoYWRpbmc6IGZhbHNlDQogICAgICB9KTsNCiAgICAgIA0KICAgICAgY29uc3QgZ3JvdW5kID0gbmV3IFRIUkVFLk1lc2goZ3JvdW5kR2VvbWV0cnksIGdyb3VuZE1hdGVyaWFsKTsNCiAgICAgIGdyb3VuZC5yb3RhdGlvbi54ID0gLU1hdGguUEkgLyAyOw0KICAgICAgZ3JvdW5kLnJlY2VpdmVTaGFkb3cgPSB0cnVlOw0KICAgICAgdGhpcy5zY2VuZS5hZGQoZ3JvdW5kKTsNCiAgICAgIA0KICAgICAgLy8g5re75Yqg5aSp56m66aKc6Imy77yI5riQ5Y+Y6IOM5pmv77yJDQogICAgICB0aGlzLnNjZW5lLmJhY2tncm91bmQgPSBuZXcgVEhSRUUuQ29sb3IoMHg4N0NFRUIpOyAvLyDlpKnnqbrok50NCiAgICAgIA0KICAgICAgLy8g5re75Yqg6Zu+5pWI5p6c77yM5aKe5Yqg5pmv5rexDQogICAgICB0aGlzLnNjZW5lLmZvZyA9IG5ldyBUSFJFRS5Gb2coMHg4N0NFRUIsIDUwLCAyMDApOw0KICAgIH0sDQogICAgDQogICAgY3JlYXRlRmFybUJsb2NrcygpIHsNCiAgICAgIC8vIOa4heepuuS5i+WJjeeahOaWueWdl+WSjOagh+etvg0KICAgICAgdGhpcy5mYXJtQmxvY2tzLmZvckVhY2goYmxvY2sgPT4gew0KICAgICAgICB0aGlzLnNjZW5lLnJlbW92ZShibG9jayk7DQogICAgICB9KTsNCiAgICAgIHRoaXMuZmFybUJsb2NrcyA9IFtdOw0KICAgICAgDQogICAgICAvLyDmuIXnqbrkuYvliY3nmoTmoIfnrb4NCiAgICAgIHRoaXMubGFiZWxzLmZvckVhY2gobGFiZWwgPT4gew0KICAgICAgICB0aGlzLnNjZW5lLnJlbW92ZShsYWJlbCk7DQogICAgICB9KTsNCiAgICAgIHRoaXMubGFiZWxzID0gW107DQogICAgICANCiAgICAgIC8vIOagueaNruWGnOeUsOaVsOmHj+WKqOaAgeiuoeeul+W4g+WxgA0KICAgICAgY29uc3QgZmFybUNvdW50ID0gdGhpcy5mYXJtcy5sZW5ndGg7DQogICAgICBjb25zdCBjb2xzID0gTWF0aC5jZWlsKE1hdGguc3FydChmYXJtQ291bnQpKTsNCiAgICAgIGNvbnN0IHNwYWNpbmcgPSAxNTsNCiAgICAgIA0KICAgICAgdGhpcy5mYXJtcy5mb3JFYWNoKChmYXJtLCBpbmRleCkgPT4gew0KICAgICAgICBjb25zdCByb3cgPSBNYXRoLmZsb29yKGluZGV4IC8gY29scyk7DQogICAgICAgIGNvbnN0IGNvbCA9IGluZGV4ICUgY29sczsNCiAgICAgICAgDQogICAgICAgIC8vIOiuoeeul+S9jee9ru+8iOWxheS4reaOkuWIl++8iQ0KICAgICAgICBjb25zdCBvZmZzZXRYID0gKGNvbHMgLSAxKSAqIHNwYWNpbmcgLyAyOw0KICAgICAgICBjb25zdCBvZmZzZXRaID0gKE1hdGguY2VpbChmYXJtQ291bnQgLyBjb2xzKSAtIDEpICogc3BhY2luZyAvIDI7DQogICAgICAgIGNvbnN0IHggPSBjb2wgKiBzcGFjaW5nIC0gb2Zmc2V0WDsNCiAgICAgICAgY29uc3QgeiA9IHJvdyAqIHNwYWNpbmcgLSBvZmZzZXRaOw0KICAgICAgICANCiAgICAgICAgLy8g5qC55o2u6Z2i56ev6K6h566X5Zyw5Z2X5aSn5bCPDQogICAgICAgIGNvbnN0IGFyZWEgPSBwYXJzZUZsb2F0KGZhcm0uYXJlYSkgfHwgMTA7DQogICAgICAgIGNvbnN0IHNpemUgPSBNYXRoLnNxcnQoYXJlYSkgKiAwLjg7DQogICAgICAgIA0KICAgICAgICAvLyDliJvlu7rlhpznlLDlnLDlnZfnu4QNCiAgICAgICAgY29uc3QgZmFybUdyb3VwID0gbmV3IFRIUkVFLkdyb3VwKCk7DQogICAgICAgIA0KICAgICAgICAvLyAxLiDliJvlu7rlhpznlLDlnLDpnaLvvIjlubPpk7rvvIznlaXpq5jkuo7lnLDpnaLvvIktIOmZjeS9juWIhuauteaVsOaPkOWNh+aAp+iDvQ0KICAgICAgICBjb25zdCBmaWVsZEdlb21ldHJ5ID0gbmV3IFRIUkVFLlBsYW5lR2VvbWV0cnkoc2l6ZSwgc2l6ZSwgNCwgNCk7IC8vIOmZjeS9juWIhuauteaVsO+8mjh4OCAtPiA0eDQNCiAgICAgICAgDQogICAgICAgIC8vIOa3u+WKoOS9nOeJqee6ueeQhui1t+S8j++8iOaooeaLn+S9nOeJqeeUn+mVv++8iQ0KICAgICAgICBjb25zdCBmaWVsZFBvc2l0aW9ucyA9IGZpZWxkR2VvbWV0cnkuYXR0cmlidXRlcy5wb3NpdGlvbjsNCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBmaWVsZFBvc2l0aW9ucy5jb3VudDsgaSsrKSB7DQogICAgICAgICAgY29uc3QgZnggPSBmaWVsZFBvc2l0aW9ucy5nZXRYKGkpOw0KICAgICAgICAgIGNvbnN0IGZ5ID0gZmllbGRQb3NpdGlvbnMuZ2V0WShpKTsNCiAgICAgICAgICBjb25zdCBjcm9wSGVpZ2h0ID0gTWF0aC5zaW4oZnggKiAyKSAqIE1hdGguY29zKGZ5ICogMikgKiAwLjIgKyAwLjM7DQogICAgICAgICAgZmllbGRQb3NpdGlvbnMuc2V0WihpLCBjcm9wSGVpZ2h0KTsNCiAgICAgICAgfQ0KICAgICAgICBmaWVsZEdlb21ldHJ5LmNvbXB1dGVWZXJ0ZXhOb3JtYWxzKCk7DQogICAgICAgIA0KICAgICAgICAvLyDmoLnmja7kvZzniannsbvlnovorr7nva7ln7rnoYDpopzoibLvvIjku47phY3nva7kuK3lv4Pojrflj5bvvIkNCiAgICAgICAgY29uc3QgY29uZmlnID0gdGhpcy5jcm9wQ29uZmlnW2Zhcm0uY3JvcF0gfHwgdGhpcy5kZWZhdWx0Q3JvcENvbmZpZzsNCiAgICAgICAgY29uc3QgYmFzZUNvbG9yID0gY29uZmlnLmNvbG9yOw0KICAgICAgICANCiAgICAgICAgLy8g5qC55o2u5YGl5bq35oyH5pWw5Yqo5oCB6LCD5pW06aKc6ImyDQogICAgICAgIGNvbnN0IGhlYWx0aFNjb3JlID0gdGhpcy5jYWxjdWxhdGVIZWFsdGhTY29yZShmYXJtKTsNCiAgICAgICAgY29uc3QgaGVhbHRoQ29sb3IgPSB0aGlzLmdldEhlYWx0aENvbG9yKGhlYWx0aFNjb3JlKTsNCiAgICAgICAgDQogICAgICAgIC8vIOa3t+WQiOWfuuehgOminOiJsuWSjOWBpeW6t+minOiJsu+8iOWBpeW6t+aMh+aVsOW9seWTjTMwJe+8iQ0KICAgICAgICBjb25zdCBmaW5hbENvbG9yID0gdGhpcy5ibGVuZENvbG9ycyhiYXNlQ29sb3IsIGhlYWx0aENvbG9yLCAwLjMpOw0KICAgICAgICANCiAgICAgICAgY29uc3QgZmllbGRNYXRlcmlhbCA9IG5ldyBUSFJFRS5NZXNoU3RhbmRhcmRNYXRlcmlhbCh7DQogICAgICAgICAgY29sb3I6IGZpbmFsQ29sb3IsDQogICAgICAgICAgcm91Z2huZXNzOiAwLjcsDQogICAgICAgICAgbWV0YWxuZXNzOiAwLjEsDQogICAgICAgICAgZmxhdFNoYWRpbmc6IGZhbHNlLA0KICAgICAgICAgIHNpZGU6IFRIUkVFLkRvdWJsZVNpZGUNCiAgICAgICAgfSk7DQogICAgICAgIA0KICAgICAgICBjb25zdCBmaWVsZCA9IG5ldyBUSFJFRS5NZXNoKGZpZWxkR2VvbWV0cnksIGZpZWxkTWF0ZXJpYWwpOw0KICAgICAgICBmaWVsZC5yb3RhdGlvbi54ID0gLU1hdGguUEkgLyAyOw0KICAgICAgICBmaWVsZC5wb3NpdGlvbi55ID0gMC4zOw0KICAgICAgICBmaWVsZC5yZWNlaXZlU2hhZG93ID0gdHJ1ZTsNCiAgICAgICAgZmllbGQuY2FzdFNoYWRvdyA9IHRydWU7DQogICAgICAgIGZhcm1Hcm91cC5hZGQoZmllbGQpOw0KICAgICAgICANCiAgICAgICAgLy8gMi4g5Yib5bu655Sw5Z+C6L655qGG77yI5qOV6Imy5Zyf5aOk77yJDQogICAgICAgIGNvbnN0IGJvcmRlckhlaWdodCA9IDAuMzsNCiAgICAgICAgY29uc3QgYm9yZGVyV2lkdGggPSAwLjI7DQogICAgICAgIGNvbnN0IGJvcmRlck1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hTdGFuZGFyZE1hdGVyaWFsKHsNCiAgICAgICAgICBjb2xvcjogMHg4QjZGNDcsDQogICAgICAgICAgcm91Z2huZXNzOiAwLjksDQogICAgICAgICAgbWV0YWxuZXNzOiAwLjENCiAgICAgICAgfSk7DQogICAgICAgIA0KICAgICAgICAvLyDlm5vmnaHnlLDln4INCiAgICAgICAgY29uc3QgYm9yZGVycyA9IFsNCiAgICAgICAgICB7IHc6IHNpemUgKyBib3JkZXJXaWR0aCAqIDIsIGg6IGJvcmRlcldpZHRoLCB4OiAwLCB6OiAtc2l6ZSAvIDIgLSBib3JkZXJXaWR0aCAvIDIgfSwgLy8g5YmNDQogICAgICAgICAgeyB3OiBzaXplICsgYm9yZGVyV2lkdGggKiAyLCBoOiBib3JkZXJXaWR0aCwgeDogMCwgejogc2l6ZSAvIDIgKyBib3JkZXJXaWR0aCAvIDIgfSwgIC8vIOWQjg0KICAgICAgICAgIHsgdzogYm9yZGVyV2lkdGgsIGg6IHNpemUsIHg6IC1zaXplIC8gMiAtIGJvcmRlcldpZHRoIC8gMiwgejogMCB9LCAgICAgICAgICAgICAgICAgICAgLy8g5bemDQogICAgICAgICAgeyB3OiBib3JkZXJXaWR0aCwgaDogc2l6ZSwgeDogc2l6ZSAvIDIgKyBib3JkZXJXaWR0aCAvIDIsIHo6IDAgfSAgICAgICAgICAgICAgICAgICAgICAvLyDlj7MNCiAgICAgICAgXTsNCiAgICAgICAgDQogICAgICAgIGJvcmRlcnMuZm9yRWFjaChiID0+IHsNCiAgICAgICAgICBjb25zdCBib3JkZXJHZW9tID0gbmV3IFRIUkVFLkJveEdlb21ldHJ5KGIudywgYm9yZGVySGVpZ2h0LCBiLmgpOw0KICAgICAgICAgIGNvbnN0IGJvcmRlciA9IG5ldyBUSFJFRS5NZXNoKGJvcmRlckdlb20sIGJvcmRlck1hdGVyaWFsKTsNCiAgICAgICAgICBib3JkZXIucG9zaXRpb24uc2V0KGIueCwgYm9yZGVySGVpZ2h0IC8gMiwgYi56KTsNCiAgICAgICAgICBib3JkZXIuY2FzdFNoYWRvdyA9IHRydWU7DQogICAgICAgICAgYm9yZGVyLnJlY2VpdmVTaGFkb3cgPSB0cnVlOw0KICAgICAgICAgIGZhcm1Hcm91cC5hZGQoYm9yZGVyKTsNCiAgICAgICAgfSk7DQogICAgICAgIA0KICAgICAgICAvLyAzLiDorr7nva7mlbTkuKrlhpznlLDnu4TnmoTkvY3nva4NCiAgICAgICAgZmFybUdyb3VwLnBvc2l0aW9uLnNldCh4LCAwLCB6KTsNCiAgICAgICAgDQogICAgICAgIC8vIOWtmOWCqOWGnOeUsOaVsOaNrg0KICAgICAgICBmYXJtR3JvdXAudXNlckRhdGEgPSB7DQogICAgICAgICAgZmFybTogZmFybSwNCiAgICAgICAgICBvcmlnaW5hbENvbG9yOiBiYXNlQ29sb3IsDQogICAgICAgICAgaGVhbHRoU2NvcmU6IGhlYWx0aFNjb3JlLA0KICAgICAgICAgIGhlYWx0aENvbG9yOiBoZWFsdGhDb2xvcg0KICAgICAgICB9Ow0KICAgICAgICANCiAgICAgICAgdGhpcy5zY2VuZS5hZGQoZmFybUdyb3VwKTsNCiAgICAgICAgdGhpcy5mYXJtQmxvY2tzLnB1c2goZmFybUdyb3VwKTsNCiAgICAgICAgDQogICAgICAgIC8vIOa3u+WKoCAzRCDmpI3nianmqKHlnosNCiAgICAgICAgdGhpcy5hZGRDcm9wTW9kZWxzKGZhcm0uY3JvcCwgeCwgeiwgc2l6ZSwgYmFzZUNvbG9yKTsNCiAgICAgICAgDQogICAgICAgIC8vIOa3u+WKoOS9nOeJqeagh+etvu+8iOaYvuekuuS9nOeJqeexu+Wei++8iQ0KICAgICAgICB0aGlzLmFkZENyb3BMYWJlbChmYXJtLmNyb3AsIHgsIDIuNSwgeiwgYmFzZUNvbG9yKTsNCiAgICAgICAgDQogICAgICAgIC8vIOa3u+WKoOWBpeW6t+aMh+aVsOagh+etvg0KICAgICAgICB0aGlzLmFkZEhlYWx0aEluZGV4TGFiZWwoaGVhbHRoU2NvcmUsIHgsIDMuMCwgeik7DQogICAgICAgIA0KICAgICAgICAvLyDmt7vliqDlnLDlnZflkI3np7DmoIfnrb7vvIjlsI/ogIznroDmtIHvvIkNCiAgICAgICAgdGhpcy5hZGRGaWVsZE5hbWVMYWJlbChmYXJtLmZhcm0sIHgsIDMuNSwgeik7DQogICAgICAgIA0KICAgICAgICAvLyDmt7vliqDlnLDlnYDmoIfnrb4NCiAgICAgICAgaWYgKGZhcm0uYWRkcmVzcykgew0KICAgICAgICAgIHRoaXMuYWRkQWRkcmVzc0xhYmVsKGZhcm0uYWRkcmVzcywgeCwgNC4yLCB6KTsNCiAgICAgICAgfQ0KICAgICAgfSk7DQogICAgfSwNCiAgICANCiAgICAvLyDliqDovb3lpJbpg6ggM0Qg5qih5Z6L77yI5pSv5oyB57yT5a2Y77yJDQogICAgYXN5bmMgbG9hZENyb3BNb2RlbChjcm9wVHlwZSkgew0KICAgICAgLy8g5aaC5p6c5bey57yT5a2Y77yM55u05o6l6L+U5ZueDQogICAgICBpZiAodGhpcy5tb2RlbENhY2hlW2Nyb3BUeXBlXSkgew0KICAgICAgICByZXR1cm4gdGhpcy5tb2RlbENhY2hlW2Nyb3BUeXBlXS5jbG9uZSgpOw0KICAgICAgfQ0KICAgICAgDQogICAgICAvLyDku47phY3nva7kuK3lv4Pojrflj5bmqKHlnovot6/lvoQNCiAgICAgIGNvbnN0IGNvbmZpZyA9IHRoaXMuY3JvcENvbmZpZ1tjcm9wVHlwZV0gfHwgdGhpcy5kZWZhdWx0Q3JvcENvbmZpZzsNCiAgICAgIGNvbnN0IG1vZGVsUGF0aCA9IGNvbmZpZy5tb2RlbFBhdGg7DQogICAgICBpZiAoIW1vZGVsUGF0aCkgew0KICAgICAgICBjb25zb2xlLndhcm4oYOacquaJvuWIsCAke2Nyb3BUeXBlfSDnmoTmqKHlnovot6/lvoTvvIzkvb/nlKjpu5jorqTlh6DkvZXkvZNgKTsNCiAgICAgICAgcmV0dXJuIG51bGw7DQogICAgICB9DQogICAgICANCiAgICAgIC8vIOWIneWni+WMluWKoOi9veWZqA0KICAgICAgaWYgKCF0aGlzLmdsdGZMb2FkZXIpIHsNCiAgICAgICAgdGhpcy5nbHRmTG9hZGVyID0gbmV3IEdMVEZMb2FkZXIoKTsNCiAgICAgIH0NCiAgICAgIA0KICAgICAgdHJ5IHsNCiAgICAgICAgLy8g5Yqg6L295qih5Z6LDQogICAgICAgIGNvbnN0IGdsdGYgPSBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7DQogICAgICAgICAgdGhpcy5nbHRmTG9hZGVyLmxvYWQoDQogICAgICAgICAgICBtb2RlbFBhdGgsDQogICAgICAgICAgICAoZ2x0ZikgPT4gcmVzb2x2ZShnbHRmKSwNCiAgICAgICAgICAgIHVuZGVmaW5lZCwNCiAgICAgICAgICAgIChlcnJvcikgPT4gcmVqZWN0KGVycm9yKQ0KICAgICAgICAgICk7DQogICAgICAgIH0pOw0KICAgICAgICANCiAgICAgICAgLy8g57yT5a2Y5qih5Z6LDQogICAgICAgIHRoaXMubW9kZWxDYWNoZVtjcm9wVHlwZV0gPSBnbHRmLnNjZW5lOw0KICAgICAgICBjb25zb2xlLmxvZyhg4pyFIOaIkOWKn+WKoOi9vSAke2Nyb3BUeXBlfSDmqKHlnotgKTsNCiAgICAgICAgDQogICAgICAgIHJldHVybiBnbHRmLnNjZW5lLmNsb25lKCk7DQogICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLndhcm4oYOKaoO+4jyDliqDovb0gJHtjcm9wVHlwZX0g5qih5Z6L5aSx6LSlOmAsIGVycm9yLm1lc3NhZ2UpOw0KICAgICAgICByZXR1cm4gbnVsbDsNCiAgICAgIH0NCiAgICB9LA0KICAgIA0KICAgIC8vIOa3u+WKoCAzRCDmpI3nianmqKHlnovvvIjkvJjlhYjkvb/nlKjlpJbpg6jmqKHlnovvvIzpmY3nuqfliLDlh6DkvZXkvZPvvIkNCiAgICBhc3luYyBhZGRDcm9wTW9kZWxzKGNyb3BUeXBlLCB4LCB6LCBmaWVsZFNpemUsIGNyb3BDb2xvcikgew0KICAgICAgLy8g5LyY5YyW5qSN54mp5pWw6YeP77ya5qC55o2u6Z2i56ev5Yqo5oCB6LCD5pW077yM5L2G6ZmQ5Yi25pyA5aSn5YC8DQogICAgICBjb25zdCBiYXNlQ291bnQgPSBNYXRoLmZsb29yKGZpZWxkU2l6ZSAqIDEuNSk7IC8vIOmZjeS9juWvhuW6pu+8mjMgLT4gMS41DQogICAgICBjb25zdCBtYXhDb3VudCA9IDIwOyAvLyDpmZDliLbmnIDlpKfmpI3nianmlbDph4/vvIzpgb/lhY3mgKfog73pl67popgNCiAgICAgIGNvbnN0IHBsYW50Q291bnQgPSBNYXRoLm1pbihiYXNlQ291bnQsIG1heENvdW50KTsNCiAgICAgIGNvbnN0IHNwYWNpbmcgPSBmaWVsZFNpemUgLyBNYXRoLm1heChwbGFudENvdW50LCAxKTsNCiAgICAgIA0KICAgICAgLy8g5bCd6K+V5Yqg6L295aSW6YOo5qih5Z6LDQogICAgICBjb25zdCBleHRlcm5hbE1vZGVsID0gYXdhaXQgdGhpcy5sb2FkQ3JvcE1vZGVsKGNyb3BUeXBlKTsNCiAgICAgIA0KICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwbGFudENvdW50OyBpKyspIHsNCiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBwbGFudENvdW50OyBqKyspIHsNCiAgICAgICAgICBjb25zdCBvZmZzZXRYID0gKGkgLSBwbGFudENvdW50IC8gMikgKiBzcGFjaW5nICsgKE1hdGgucmFuZG9tKCkgLSAwLjUpICogc3BhY2luZyAqIDAuMzsNCiAgICAgICAgICBjb25zdCBvZmZzZXRaID0gKGogLSBwbGFudENvdW50IC8gMikgKiBzcGFjaW5nICsgKE1hdGgucmFuZG9tKCkgLSAwLjUpICogc3BhY2luZyAqIDAuMzsNCiAgICAgICAgICANCiAgICAgICAgICBjb25zdCBwbGFudFggPSB4ICsgb2Zmc2V0WDsNCiAgICAgICAgICBjb25zdCBwbGFudFogPSB6ICsgb2Zmc2V0WjsNCiAgICAgICAgICANCiAgICAgICAgICBsZXQgcGxhbnQ7DQogICAgICAgICAgDQogICAgICAgICAgLy8g5aaC5p6c5pyJ5aSW6YOo5qih5Z6L77yM5L2/55So5aSW6YOo5qih5Z6LDQogICAgICAgICAgaWYgKGV4dGVybmFsTW9kZWwpIHsNCiAgICAgICAgICAgIHBsYW50ID0gZXh0ZXJuYWxNb2RlbC5jbG9uZSgpOw0KICAgICAgICAgICAgLy8g5Li65aSW6YOo5qih5Z6L5ZCv55So6Zi05b2x77yI5LuF6YOo5YiG5qSN54mp5oqV5bCE6Zi05b2x5Lul5o+Q5Y2H5oCn6IO977yJDQogICAgICAgICAgICBjb25zdCBlbmFibGVTaGFkb3cgPSAoaSArIGopICUgMyA9PT0gMDsgLy8g5Y+q5pyJMS8z55qE5qSN54mp5oqV5bCE6Zi05b2xDQogICAgICAgICAgICBwbGFudC50cmF2ZXJzZSgoY2hpbGQpID0+IHsNCiAgICAgICAgICAgICAgaWYgKGNoaWxkLmlzTWVzaCkgew0KICAgICAgICAgICAgICAgIGNoaWxkLmNhc3RTaGFkb3cgPSBlbmFibGVTaGFkb3c7DQogICAgICAgICAgICAgICAgY2hpbGQucmVjZWl2ZVNoYWRvdyA9IGZhbHNlOyAvLyDmpI3niankuI3mjqXmlLbpmLTlvbENCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIC8vIOmZjee6p++8muS9v+eUqOWHoOS9leS9k+WIm+W7uuakjeeJqQ0KICAgICAgICAgICAgc3dpdGNoKGNyb3BUeXBlKSB7DQogICAgICAgICAgICAgIGNhc2UgJ+Wwj+m6pic6DQogICAgICAgICAgICAgICAgcGxhbnQgPSB0aGlzLmNyZWF0ZVdoZWF0UGxhbnQoY3JvcENvbG9yKTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgY2FzZSAn546J57GzJzoNCiAgICAgICAgICAgICAgICBwbGFudCA9IHRoaXMuY3JlYXRlQ29yblBsYW50KGNyb3BDb2xvcik7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgIGNhc2UgJ+awtOeouyc6DQogICAgICAgICAgICAgICAgcGxhbnQgPSB0aGlzLmNyZWF0ZVJpY2VQbGFudChjcm9wQ29sb3IpOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICBjYXNlICflpKfosYYnOg0KICAgICAgICAgICAgICBjYXNlICfnmb3oj5wnOg0KICAgICAgICAgICAgICBjYXNlICfpu4Tnk5wnOg0KICAgICAgICAgICAgICAgIHBsYW50ID0gdGhpcy5jcmVhdGVMZWFmeVBsYW50KGNyb3BDb2xvcik7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgIGNhc2UgJ+eVquiMhCc6DQogICAgICAgICAgICAgIGNhc2UgJ+i+o+akkic6DQogICAgICAgICAgICAgICAgcGxhbnQgPSB0aGlzLmNyZWF0ZVZpbmVQbGFudChjcm9wQ29sb3IpOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgICAgICAgIHBsYW50ID0gdGhpcy5jcmVhdGVHZW5lcmljUGxhbnQoY3JvcENvbG9yKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9DQogICAgICAgICAgDQogICAgICAgICAgaWYgKHBsYW50KSB7DQogICAgICAgICAgICBwbGFudC5wb3NpdGlvbi5zZXQocGxhbnRYLCAwLjUsIHBsYW50Wik7DQogICAgICAgICAgICAvLyDlh4/lsJHpmo/mnLrnvKnmlL7ojIPlm7Tku6Xmj5DljYfmgKfog70NCiAgICAgICAgICAgIGNvbnN0IHNjYWxlID0gMC45ICsgTWF0aC5yYW5kb20oKSAqIDAuMjsgLy8g57uf5LiA57yp5pS+5YC8DQogICAgICAgICAgICBwbGFudC5zY2FsZS5zZXQoc2NhbGUsIHNjYWxlLCBzY2FsZSk7DQogICAgICAgICAgICAvLyDku4Xpg6jliIbmpI3nianmipXlsITpmLTlvbENCiAgICAgICAgICAgIGNvbnN0IGVuYWJsZVNoYWRvdyA9IChpICsgaikgJSAzID09PSAwOw0KICAgICAgICAgICAgcGxhbnQudHJhdmVyc2UoKGNoaWxkKSA9PiB7DQogICAgICAgICAgICAgIGlmIChjaGlsZC5pc01lc2gpIHsNCiAgICAgICAgICAgICAgICBjaGlsZC5jYXN0U2hhZG93ID0gZW5hYmxlU2hhZG93Ow0KICAgICAgICAgICAgICAgIGNoaWxkLnJlY2VpdmVTaGFkb3cgPSBmYWxzZTsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB0aGlzLnNjZW5lLmFkZChwbGFudCk7DQogICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICB9DQogICAgfSwNCiAgICANCiAgICAvLyDliJvlu7rlsI/puqbmpI3nianvvIjnu4bplb/nmoTojI7vvIkNCiAgICBjcmVhdGVXaGVhdFBsYW50KGNvbG9yKSB7DQogICAgICBjb25zdCBncm91cCA9IG5ldyBUSFJFRS5Hcm91cCgpOw0KICAgICAgDQogICAgICAvLyDojI7np4YNCiAgICAgIGNvbnN0IHN0ZW1HZW9tZXRyeSA9IG5ldyBUSFJFRS5DeWxpbmRlckdlb21ldHJ5KDAuMDIsIDAuMDMsIDEuMiwgNik7DQogICAgICBjb25zdCBzdGVtTWF0ZXJpYWwgPSBuZXcgVEhSRUUuTWVzaFN0YW5kYXJkTWF0ZXJpYWwoeyANCiAgICAgICAgY29sb3I6IDB4OEI3MzU1LA0KICAgICAgICByb3VnaG5lc3M6IDAuOCANCiAgICAgIH0pOw0KICAgICAgY29uc3Qgc3RlbSA9IG5ldyBUSFJFRS5NZXNoKHN0ZW1HZW9tZXRyeSwgc3RlbU1hdGVyaWFsKTsNCiAgICAgIHN0ZW0ucG9zaXRpb24ueSA9IDAuNjsNCiAgICAgIHN0ZW0uY2FzdFNoYWRvdyA9IHRydWU7DQogICAgICBncm91cC5hZGQoc3RlbSk7DQogICAgICANCiAgICAgIC8vIOm6puepl++8iOmhtumDqO+8iQ0KICAgICAgY29uc3QgaGVhZEdlb21ldHJ5ID0gbmV3IFRIUkVFLkNvbmVHZW9tZXRyeSgwLjE1LCAwLjQsIDgpOw0KICAgICAgY29uc3QgaGVhZE1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hTdGFuZGFyZE1hdGVyaWFsKHsgDQogICAgICAgIGNvbG9yOiBjb2xvciwNCiAgICAgICAgcm91Z2huZXNzOiAwLjYgDQogICAgICB9KTsNCiAgICAgIGNvbnN0IGhlYWQgPSBuZXcgVEhSRUUuTWVzaChoZWFkR2VvbWV0cnksIGhlYWRNYXRlcmlhbCk7DQogICAgICBoZWFkLnBvc2l0aW9uLnkgPSAxLjQ7DQogICAgICBoZWFkLmNhc3RTaGFkb3cgPSB0cnVlOw0KICAgICAgZ3JvdXAuYWRkKGhlYWQpOw0KICAgICAgDQogICAgICByZXR1cm4gZ3JvdXA7DQogICAgfSwNCiAgICANCiAgICAvLyDliJvlu7rnjonnsbPmpI3nianvvIjnspflo67nmoTojI4gKyDlpKflj7blrZDvvIkNCiAgICBjcmVhdGVDb3JuUGxhbnQoY29sb3IpIHsNCiAgICAgIGNvbnN0IGdyb3VwID0gbmV3IFRIUkVFLkdyb3VwKCk7DQogICAgICANCiAgICAgIC8vIOeyl+iMjg0KICAgICAgY29uc3Qgc3RlbUdlb21ldHJ5ID0gbmV3IFRIUkVFLkN5bGluZGVyR2VvbWV0cnkoMC4wNSwgMC4wOCwgMS44LCA4KTsNCiAgICAgIGNvbnN0IHN0ZW1NYXRlcmlhbCA9IG5ldyBUSFJFRS5NZXNoU3RhbmRhcmRNYXRlcmlhbCh7IA0KICAgICAgICBjb2xvcjogMHg3Q0IzNDIsDQogICAgICAgIHJvdWdobmVzczogMC43IA0KICAgICAgfSk7DQogICAgICBjb25zdCBzdGVtID0gbmV3IFRIUkVFLk1lc2goc3RlbUdlb21ldHJ5LCBzdGVtTWF0ZXJpYWwpOw0KICAgICAgc3RlbS5wb3NpdGlvbi55ID0gMC45Ow0KICAgICAgc3RlbS5jYXN0U2hhZG93ID0gdHJ1ZTsNCiAgICAgIGdyb3VwLmFkZChzdGVtKTsNCiAgICAgIA0KICAgICAgLy8g5Y+25a2QDQogICAgICBjb25zdCBsZWFmR2VvbWV0cnkgPSBuZXcgVEhSRUUuUGxhbmVHZW9tZXRyeSgwLjMsIDAuOCk7DQogICAgICBjb25zdCBsZWFmTWF0ZXJpYWwgPSBuZXcgVEhSRUUuTWVzaFN0YW5kYXJkTWF0ZXJpYWwoeyANCiAgICAgICAgY29sb3I6IDB4NTU4QjJGLA0KICAgICAgICBzaWRlOiBUSFJFRS5Eb3VibGVTaWRlLA0KICAgICAgICByb3VnaG5lc3M6IDAuOCANCiAgICAgIH0pOw0KICAgICAgDQogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDQ7IGkrKykgew0KICAgICAgICBjb25zdCBsZWFmID0gbmV3IFRIUkVFLk1lc2gobGVhZkdlb21ldHJ5LCBsZWFmTWF0ZXJpYWwpOw0KICAgICAgICBsZWFmLnBvc2l0aW9uLnkgPSAwLjggKyBpICogMC4zOw0KICAgICAgICBsZWFmLnJvdGF0aW9uLnkgPSAoTWF0aC5QSSAvIDIpICogaTsNCiAgICAgICAgbGVhZi5yb3RhdGlvbi56ID0gTWF0aC5QSSAvIDY7DQogICAgICAgIGxlYWYuY2FzdFNoYWRvdyA9IHRydWU7DQogICAgICAgIGdyb3VwLmFkZChsZWFmKTsNCiAgICAgIH0NCiAgICAgIA0KICAgICAgLy8g546J57Gz5qOSDQogICAgICBjb25zdCBjb3JuR2VvbWV0cnkgPSBuZXcgVEhSRUUuQ3lsaW5kZXJHZW9tZXRyeSgwLjEsIDAuMSwgMC40LCA4KTsNCiAgICAgIGNvbnN0IGNvcm5NYXRlcmlhbCA9IG5ldyBUSFJFRS5NZXNoU3RhbmRhcmRNYXRlcmlhbCh7IA0KICAgICAgICBjb2xvcjogY29sb3IsDQogICAgICAgIHJvdWdobmVzczogMC42IA0KICAgICAgfSk7DQogICAgICBjb25zdCBjb3JuID0gbmV3IFRIUkVFLk1lc2goY29ybkdlb21ldHJ5LCBjb3JuTWF0ZXJpYWwpOw0KICAgICAgY29ybi5wb3NpdGlvbi5zZXQoMC4xNSwgMS4yLCAwKTsNCiAgICAgIGNvcm4ucm90YXRpb24ueiA9IE1hdGguUEkgLyA0Ow0KICAgICAgY29ybi5jYXN0U2hhZG93ID0gdHJ1ZTsNCiAgICAgIGdyb3VwLmFkZChjb3JuKTsNCiAgICAgIA0KICAgICAgcmV0dXJuIGdyb3VwOw0KICAgIH0sDQogICAgDQogICAgLy8g5Yib5bu65rC056i75qSN54mp77yI5byv5puy55qE6IyO77yJDQogICAgY3JlYXRlUmljZVBsYW50KGNvbG9yKSB7DQogICAgICBjb25zdCBncm91cCA9IG5ldyBUSFJFRS5Hcm91cCgpOw0KICAgICAgDQogICAgICAvLyDojI7np4YNCiAgICAgIGNvbnN0IHN0ZW1HZW9tZXRyeSA9IG5ldyBUSFJFRS5DeWxpbmRlckdlb21ldHJ5KDAuMDIsIDAuMDMsIDEuMCwgNik7DQogICAgICBjb25zdCBzdGVtTWF0ZXJpYWwgPSBuZXcgVEhSRUUuTWVzaFN0YW5kYXJkTWF0ZXJpYWwoeyANCiAgICAgICAgY29sb3I6IDB4N0NCMzQyLA0KICAgICAgICByb3VnaG5lc3M6IDAuOCANCiAgICAgIH0pOw0KICAgICAgY29uc3Qgc3RlbSA9IG5ldyBUSFJFRS5NZXNoKHN0ZW1HZW9tZXRyeSwgc3RlbU1hdGVyaWFsKTsNCiAgICAgIHN0ZW0ucG9zaXRpb24ueSA9IDAuNTsNCiAgICAgIHN0ZW0uY2FzdFNoYWRvdyA9IHRydWU7DQogICAgICBncm91cC5hZGQoc3RlbSk7DQogICAgICANCiAgICAgIC8vIOeou+epl++8iOW8r+absueahO+8iQ0KICAgICAgY29uc3QgcmljZUdlb21ldHJ5ID0gbmV3IFRIUkVFLlNwaGVyZUdlb21ldHJ5KDAuMTIsIDgsIDgpOw0KICAgICAgY29uc3QgcmljZU1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hTdGFuZGFyZE1hdGVyaWFsKHsgDQogICAgICAgIGNvbG9yOiBjb2xvciwNCiAgICAgICAgcm91Z2huZXNzOiAwLjYgDQogICAgICB9KTsNCiAgICAgIA0KICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA1OyBpKyspIHsNCiAgICAgICAgY29uc3QgcmljZSA9IG5ldyBUSFJFRS5NZXNoKHJpY2VHZW9tZXRyeSwgcmljZU1hdGVyaWFsKTsNCiAgICAgICAgcmljZS5wb3NpdGlvbi5zZXQoDQogICAgICAgICAgTWF0aC5zaW4oaSAqIDAuMykgKiAwLjE1LA0KICAgICAgICAgIDEuMCAtIGkgKiAwLjEsDQogICAgICAgICAgTWF0aC5jb3MoaSAqIDAuMykgKiAwLjE1DQogICAgICAgICk7DQogICAgICAgIHJpY2Uuc2NhbGUuc2V0KDEsIDEuNSwgMSk7DQogICAgICAgIHJpY2UuY2FzdFNoYWRvdyA9IHRydWU7DQogICAgICAgIGdyb3VwLmFkZChyaWNlKTsNCiAgICAgIH0NCiAgICAgIA0KICAgICAgcmV0dXJuIGdyb3VwOw0KICAgIH0sDQogICAgDQogICAgLy8g5Yib5bu65Y+26I+c57G75qSN54mp77yI5aSn6LGG44CB55m96I+c562J77yJDQogICAgY3JlYXRlTGVhZnlQbGFudChjb2xvcikgew0KICAgICAgY29uc3QgZ3JvdXAgPSBuZXcgVEhSRUUuR3JvdXAoKTsNCiAgICAgIA0KICAgICAgLy8g5aSa5bGC5Y+25a2QDQogICAgICBjb25zdCBsZWFmR2VvbWV0cnkgPSBuZXcgVEhSRUUuQ2lyY2xlR2VvbWV0cnkoMC4yLCA4KTsNCiAgICAgIGNvbnN0IGxlYWZNYXRlcmlhbCA9IG5ldyBUSFJFRS5NZXNoU3RhbmRhcmRNYXRlcmlhbCh7IA0KICAgICAgICBjb2xvcjogY29sb3IsDQogICAgICAgIHNpZGU6IFRIUkVFLkRvdWJsZVNpZGUsDQogICAgICAgIHJvdWdobmVzczogMC43IA0KICAgICAgfSk7DQogICAgICANCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgNjsgaSsrKSB7DQogICAgICAgIGNvbnN0IGxlYWYgPSBuZXcgVEhSRUUuTWVzaChsZWFmR2VvbWV0cnksIGxlYWZNYXRlcmlhbCk7DQogICAgICAgIGxlYWYucG9zaXRpb24ueSA9IDAuMyArIGkgKiAwLjE7DQogICAgICAgIGxlYWYucm90YXRpb24ueSA9IChNYXRoLlBJIC8gMykgKiBpOw0KICAgICAgICBsZWFmLnJvdGF0aW9uLnggPSAtTWF0aC5QSSAvIDIgKyBNYXRoLlBJIC8gODsNCiAgICAgICAgbGVhZi5zY2FsZS5zZXQoMSAtIGkgKiAwLjEsIDEgLSBpICogMC4xLCAxKTsNCiAgICAgICAgbGVhZi5jYXN0U2hhZG93ID0gdHJ1ZTsNCiAgICAgICAgZ3JvdXAuYWRkKGxlYWYpOw0KICAgICAgfQ0KICAgICAgDQogICAgICByZXR1cm4gZ3JvdXA7DQogICAgfSwNCiAgICANCiAgICAvLyDliJvlu7rol6TolJPnsbvmpI3nianvvIjnlarojITjgIHovqPmpJLnrYnvvIkNCiAgICBjcmVhdGVWaW5lUGxhbnQoY29sb3IpIHsNCiAgICAgIGNvbnN0IGdyb3VwID0gbmV3IFRIUkVFLkdyb3VwKCk7DQogICAgICANCiAgICAgIC8vIOS4u+iMjg0KICAgICAgY29uc3Qgc3RlbUdlb21ldHJ5ID0gbmV3IFRIUkVFLkN5bGluZGVyR2VvbWV0cnkoMC4wMywgMC4wNCwgMS4yLCA2KTsNCiAgICAgIGNvbnN0IHN0ZW1NYXRlcmlhbCA9IG5ldyBUSFJFRS5NZXNoU3RhbmRhcmRNYXRlcmlhbCh7IA0KICAgICAgICBjb2xvcjogMHg1NThCMkYsDQogICAgICAgIHJvdWdobmVzczogMC44IA0KICAgICAgfSk7DQogICAgICBjb25zdCBzdGVtID0gbmV3IFRIUkVFLk1lc2goc3RlbUdlb21ldHJ5LCBzdGVtTWF0ZXJpYWwpOw0KICAgICAgc3RlbS5wb3NpdGlvbi55ID0gMC42Ow0KICAgICAgc3RlbS5jYXN0U2hhZG93ID0gdHJ1ZTsNCiAgICAgIGdyb3VwLmFkZChzdGVtKTsNCiAgICAgIA0KICAgICAgLy8g5Y+25a2QDQogICAgICBjb25zdCBsZWFmR2VvbWV0cnkgPSBuZXcgVEhSRUUuQ2lyY2xlR2VvbWV0cnkoMC4xNSwgNik7DQogICAgICBjb25zdCBsZWFmTWF0ZXJpYWwgPSBuZXcgVEhSRUUuTWVzaFN0YW5kYXJkTWF0ZXJpYWwoeyANCiAgICAgICAgY29sb3I6IDB4NENBRjUwLA0KICAgICAgICBzaWRlOiBUSFJFRS5Eb3VibGVTaWRlLA0KICAgICAgICByb3VnaG5lc3M6IDAuNyANCiAgICAgIH0pOw0KICAgICAgDQogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDQ7IGkrKykgew0KICAgICAgICBjb25zdCBsZWFmID0gbmV3IFRIUkVFLk1lc2gobGVhZkdlb21ldHJ5LCBsZWFmTWF0ZXJpYWwpOw0KICAgICAgICBsZWFmLnBvc2l0aW9uLnNldCgNCiAgICAgICAgICBNYXRoLmNvcyhpICogTWF0aC5QSSAvIDIpICogMC4yLA0KICAgICAgICAgIDAuNSArIGkgKiAwLjIsDQogICAgICAgICAgTWF0aC5zaW4oaSAqIE1hdGguUEkgLyAyKSAqIDAuMg0KICAgICAgICApOw0KICAgICAgICBsZWFmLnJvdGF0aW9uLnkgPSBpICogTWF0aC5QSSAvIDI7DQogICAgICAgIGxlYWYuY2FzdFNoYWRvdyA9IHRydWU7DQogICAgICAgIGdyb3VwLmFkZChsZWFmKTsNCiAgICAgIH0NCiAgICAgIA0KICAgICAgLy8g5p6c5a6eDQogICAgICBjb25zdCBmcnVpdEdlb21ldHJ5ID0gbmV3IFRIUkVFLlNwaGVyZUdlb21ldHJ5KDAuMSwgOCwgOCk7DQogICAgICBjb25zdCBmcnVpdE1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hTdGFuZGFyZE1hdGVyaWFsKHsgDQogICAgICAgIGNvbG9yOiBjb2xvciwNCiAgICAgICAgcm91Z2huZXNzOiAwLjQsDQogICAgICAgIG1ldGFsbmVzczogMC4xIA0KICAgICAgfSk7DQogICAgICANCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMzsgaSsrKSB7DQogICAgICAgIGNvbnN0IGZydWl0ID0gbmV3IFRIUkVFLk1lc2goZnJ1aXRHZW9tZXRyeSwgZnJ1aXRNYXRlcmlhbCk7DQogICAgICAgIGZydWl0LnBvc2l0aW9uLnNldCgNCiAgICAgICAgICBNYXRoLmNvcyhpICogTWF0aC5QSSAqIDIgLyAzKSAqIDAuMTUsDQogICAgICAgICAgMC44ICsgTWF0aC5yYW5kb20oKSAqIDAuMywNCiAgICAgICAgICBNYXRoLnNpbihpICogTWF0aC5QSSAqIDIgLyAzKSAqIDAuMTUNCiAgICAgICAgKTsNCiAgICAgICAgZnJ1aXQuY2FzdFNoYWRvdyA9IHRydWU7DQogICAgICAgIGdyb3VwLmFkZChmcnVpdCk7DQogICAgICB9DQogICAgICANCiAgICAgIHJldHVybiBncm91cDsNCiAgICB9LA0KICAgIA0KICAgIC8vIOWIm+W7uumAmueUqOakjeeJqQ0KICAgIGNyZWF0ZUdlbmVyaWNQbGFudChjb2xvcikgew0KICAgICAgY29uc3QgZ3JvdXAgPSBuZXcgVEhSRUUuR3JvdXAoKTsNCiAgICAgIA0KICAgICAgY29uc3Qgc3RlbUdlb21ldHJ5ID0gbmV3IFRIUkVFLkN5bGluZGVyR2VvbWV0cnkoMC4wMywgMC4wNCwgMC44LCA2KTsNCiAgICAgIGNvbnN0IHN0ZW1NYXRlcmlhbCA9IG5ldyBUSFJFRS5NZXNoU3RhbmRhcmRNYXRlcmlhbCh7IA0KICAgICAgICBjb2xvcjogMHg3Q0IzNDIsDQogICAgICAgIHJvdWdobmVzczogMC44IA0KICAgICAgfSk7DQogICAgICBjb25zdCBzdGVtID0gbmV3IFRIUkVFLk1lc2goc3RlbUdlb21ldHJ5LCBzdGVtTWF0ZXJpYWwpOw0KICAgICAgc3RlbS5wb3NpdGlvbi55ID0gMC40Ow0KICAgICAgc3RlbS5jYXN0U2hhZG93ID0gdHJ1ZTsNCiAgICAgIGdyb3VwLmFkZChzdGVtKTsNCiAgICAgIA0KICAgICAgY29uc3QgdG9wR2VvbWV0cnkgPSBuZXcgVEhSRUUuU3BoZXJlR2VvbWV0cnkoMC4xNSwgOCwgOCk7DQogICAgICBjb25zdCB0b3BNYXRlcmlhbCA9IG5ldyBUSFJFRS5NZXNoU3RhbmRhcmRNYXRlcmlhbCh7IA0KICAgICAgICBjb2xvcjogY29sb3IsDQogICAgICAgIHJvdWdobmVzczogMC42IA0KICAgICAgfSk7DQogICAgICBjb25zdCB0b3AgPSBuZXcgVEhSRUUuTWVzaCh0b3BHZW9tZXRyeSwgdG9wTWF0ZXJpYWwpOw0KICAgICAgdG9wLnBvc2l0aW9uLnkgPSAwLjk7DQogICAgICB0b3AuY2FzdFNoYWRvdyA9IHRydWU7DQogICAgICBncm91cC5hZGQodG9wKTsNCiAgICAgIA0KICAgICAgcmV0dXJuIGdyb3VwOw0KICAgIH0sDQogICAgDQogICAgLy8g5re75Yqg566A5rSB55qE5Zyw5Z2X5ZCN56ew5qCH562+DQogICAgYWRkRmllbGROYW1lTGFiZWwoZmFybU5hbWUsIHgsIHksIHopIHsNCiAgICAgIGNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpOw0KICAgICAgY29uc3QgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpOw0KICAgICAgY2FudmFzLndpZHRoID0gMTYwOw0KICAgICAgY2FudmFzLmhlaWdodCA9IDQwOw0KICAgICAgDQogICAgICAvLyDljYrpgI/mmI7og4zmma8NCiAgICAgIGNvbnRleHQuZmlsbFN0eWxlID0gJ3JnYmEoMjU1LCAyNTUsIDI1NSwgMC44OCknOw0KICAgICAgY29udGV4dC5zaGFkb3dDb2xvciA9ICdyZ2JhKDAsIDAsIDAsIDAuMTUpJzsNCiAgICAgIGNvbnRleHQuc2hhZG93Qmx1ciA9IDU7DQogICAgICBjb250ZXh0LnNoYWRvd09mZnNldFggPSAxOw0KICAgICAgY29udGV4dC5zaGFkb3dPZmZzZXRZID0gMTsNCiAgICAgIA0KICAgICAgY29uc3QgcmFkaXVzID0gNjsNCiAgICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7DQogICAgICBjb250ZXh0Lm1vdmVUbyhyYWRpdXMsIDApOw0KICAgICAgY29udGV4dC5saW5lVG8oY2FudmFzLndpZHRoIC0gcmFkaXVzLCAwKTsNCiAgICAgIGNvbnRleHQucXVhZHJhdGljQ3VydmVUbyhjYW52YXMud2lkdGgsIDAsIGNhbnZhcy53aWR0aCwgcmFkaXVzKTsNCiAgICAgIGNvbnRleHQubGluZVRvKGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCAtIHJhZGl1cyk7DQogICAgICBjb250ZXh0LnF1YWRyYXRpY0N1cnZlVG8oY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0LCBjYW52YXMud2lkdGggLSByYWRpdXMsIGNhbnZhcy5oZWlnaHQpOw0KICAgICAgY29udGV4dC5saW5lVG8ocmFkaXVzLCBjYW52YXMuaGVpZ2h0KTsNCiAgICAgIGNvbnRleHQucXVhZHJhdGljQ3VydmVUbygwLCBjYW52YXMuaGVpZ2h0LCAwLCBjYW52YXMuaGVpZ2h0IC0gcmFkaXVzKTsNCiAgICAgIGNvbnRleHQubGluZVRvKDAsIHJhZGl1cyk7DQogICAgICBjb250ZXh0LnF1YWRyYXRpY0N1cnZlVG8oMCwgMCwgcmFkaXVzLCAwKTsNCiAgICAgIGNvbnRleHQuY2xvc2VQYXRoKCk7DQogICAgICBjb250ZXh0LmZpbGwoKTsNCiAgICAgIA0KICAgICAgY29udGV4dC5zaGFkb3dDb2xvciA9ICd0cmFuc3BhcmVudCc7DQogICAgICANCiAgICAgIC8vIOWcsOWdl+WQjeensA0KICAgICAgY29udGV4dC5mb250ID0gJ0JvbGQgMTZweCBBcmlhbCc7DQogICAgICBjb250ZXh0LmZpbGxTdHlsZSA9ICcjNjA2MjY2JzsNCiAgICAgIGNvbnRleHQudGV4dEFsaWduID0gJ2NlbnRlcic7DQogICAgICBjb250ZXh0LnRleHRCYXNlbGluZSA9ICdtaWRkbGUnOw0KICAgICAgY29udGV4dC5maWxsVGV4dChmYXJtTmFtZSwgY2FudmFzLndpZHRoIC8gMiwgY2FudmFzLmhlaWdodCAvIDIpOw0KICAgICAgDQogICAgICBjb25zdCB0ZXh0dXJlID0gbmV3IFRIUkVFLkNhbnZhc1RleHR1cmUoY2FudmFzKTsNCiAgICAgIGNvbnN0IHNwcml0ZU1hdGVyaWFsID0gbmV3IFRIUkVFLlNwcml0ZU1hdGVyaWFsKHsgDQogICAgICAgIG1hcDogdGV4dHVyZSwNCiAgICAgICAgc2l6ZUF0dGVudWF0aW9uOiB0cnVlDQogICAgICB9KTsNCiAgICAgIGNvbnN0IHNwcml0ZSA9IG5ldyBUSFJFRS5TcHJpdGUoc3ByaXRlTWF0ZXJpYWwpOw0KICAgICAgc3ByaXRlLnBvc2l0aW9uLnNldCh4LCB5LCB6KTsNCiAgICAgIHNwcml0ZS5zY2FsZS5zZXQoMi44LCAwLjcsIDEpOw0KICAgICAgDQogICAgICB0aGlzLnNjZW5lLmFkZChzcHJpdGUpOw0KICAgIH0sDQogICAgDQogICAgLy8g5re75Yqg5Zyw5Z2A5qCH562+DQogICAgYWRkQWRkcmVzc0xhYmVsKGFkZHJlc3MsIHgsIHksIHopIHsNCiAgICAgIGNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpOw0KICAgICAgY29uc3QgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpOw0KICAgICAgY2FudmFzLndpZHRoID0gMjAwOw0KICAgICAgY2FudmFzLmhlaWdodCA9IDM1Ow0KICAgICAgDQogICAgICAvLyDljYrpgI/mmI7og4zmma/vvIjmtYXok53oibLvvIkNCiAgICAgIGNvbnRleHQuZmlsbFN0eWxlID0gJ3JnYmEoMjMwLCAyNDQsIDI1NSwgMC45KSc7DQogICAgICBjb250ZXh0LnNoYWRvd0NvbG9yID0gJ3JnYmEoMCwgMCwgMCwgMC4xMiknOw0KICAgICAgY29udGV4dC5zaGFkb3dCbHVyID0gNDsNCiAgICAgIGNvbnRleHQuc2hhZG93T2Zmc2V0WCA9IDE7DQogICAgICBjb250ZXh0LnNoYWRvd09mZnNldFkgPSAxOw0KICAgICAgDQogICAgICBjb25zdCByYWRpdXMgPSA1Ow0KICAgICAgY29udGV4dC5iZWdpblBhdGgoKTsNCiAgICAgIGNvbnRleHQubW92ZVRvKHJhZGl1cywgMCk7DQogICAgICBjb250ZXh0LmxpbmVUbyhjYW52YXMud2lkdGggLSByYWRpdXMsIDApOw0KICAgICAgY29udGV4dC5xdWFkcmF0aWNDdXJ2ZVRvKGNhbnZhcy53aWR0aCwgMCwgY2FudmFzLndpZHRoLCByYWRpdXMpOw0KICAgICAgY29udGV4dC5saW5lVG8oY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0IC0gcmFkaXVzKTsNCiAgICAgIGNvbnRleHQucXVhZHJhdGljQ3VydmVUbyhjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQsIGNhbnZhcy53aWR0aCAtIHJhZGl1cywgY2FudmFzLmhlaWdodCk7DQogICAgICBjb250ZXh0LmxpbmVUbyhyYWRpdXMsIGNhbnZhcy5oZWlnaHQpOw0KICAgICAgY29udGV4dC5xdWFkcmF0aWNDdXJ2ZVRvKDAsIGNhbnZhcy5oZWlnaHQsIDAsIGNhbnZhcy5oZWlnaHQgLSByYWRpdXMpOw0KICAgICAgY29udGV4dC5saW5lVG8oMCwgcmFkaXVzKTsNCiAgICAgIGNvbnRleHQucXVhZHJhdGljQ3VydmVUbygwLCAwLCByYWRpdXMsIDApOw0KICAgICAgY29udGV4dC5jbG9zZVBhdGgoKTsNCiAgICAgIGNvbnRleHQuZmlsbCgpOw0KICAgICAgDQogICAgICAvLyDmt7vliqDovrnmoYYNCiAgICAgIGNvbnRleHQuc3Ryb2tlU3R5bGUgPSAnIzQwOUVGRic7DQogICAgICBjb250ZXh0LmxpbmVXaWR0aCA9IDEuNTsNCiAgICAgIGNvbnRleHQuc3Ryb2tlKCk7DQogICAgICANCiAgICAgIGNvbnRleHQuc2hhZG93Q29sb3IgPSAndHJhbnNwYXJlbnQnOw0KICAgICAgDQogICAgICAvLyDnu5jliLblnLDlnYDlm77moIflkozmloflrZcNCiAgICAgIGNvbnRleHQuZm9udCA9ICcxM3B4IEFyaWFsJzsNCiAgICAgIGNvbnRleHQuZmlsbFN0eWxlID0gJyM0MDlFRkYnOw0KICAgICAgY29udGV4dC50ZXh0QWxpZ24gPSAnbGVmdCc7DQogICAgICBjb250ZXh0LnRleHRCYXNlbGluZSA9ICdtaWRkbGUnOw0KICAgICAgDQogICAgICAvLyDlnLDlnYDlm77moIcNCiAgICAgIGNvbnRleHQuZmlsbFRleHQoJ/Cfk40nLCAxMCwgY2FudmFzLmhlaWdodCAvIDIpOw0KICAgICAgDQogICAgICAvLyDlnLDlnYDmloflrZfvvIjlpoLmnpzlpKrplb/liJnmiKrmlq3vvIkNCiAgICAgIGNvbnRleHQuZmlsbFN0eWxlID0gJyM2MDYyNjYnOw0KICAgICAgY29uc3QgbWF4V2lkdGggPSBjYW52YXMud2lkdGggLSA0MDsNCiAgICAgIGxldCBkaXNwbGF5QWRkcmVzcyA9IGFkZHJlc3M7DQogICAgICBpZiAoY29udGV4dC5tZWFzdXJlVGV4dChhZGRyZXNzKS53aWR0aCA+IG1heFdpZHRoKSB7DQogICAgICAgIHdoaWxlIChjb250ZXh0Lm1lYXN1cmVUZXh0KGRpc3BsYXlBZGRyZXNzICsgJy4uLicpLndpZHRoID4gbWF4V2lkdGggJiYgZGlzcGxheUFkZHJlc3MubGVuZ3RoID4gMCkgew0KICAgICAgICAgIGRpc3BsYXlBZGRyZXNzID0gZGlzcGxheUFkZHJlc3Muc2xpY2UoMCwgLTEpOw0KICAgICAgICB9DQogICAgICAgIGRpc3BsYXlBZGRyZXNzICs9ICcuLi4nOw0KICAgICAgfQ0KICAgICAgY29udGV4dC5maWxsVGV4dChkaXNwbGF5QWRkcmVzcywgMzAsIGNhbnZhcy5oZWlnaHQgLyAyKTsNCiAgICAgIA0KICAgICAgY29uc3QgdGV4dHVyZSA9IG5ldyBUSFJFRS5DYW52YXNUZXh0dXJlKGNhbnZhcyk7DQogICAgICBjb25zdCBzcHJpdGVNYXRlcmlhbCA9IG5ldyBUSFJFRS5TcHJpdGVNYXRlcmlhbCh7IA0KICAgICAgICBtYXA6IHRleHR1cmUsDQogICAgICAgIHNpemVBdHRlbnVhdGlvbjogdHJ1ZSwNCiAgICAgICAgdHJhbnNwYXJlbnQ6IHRydWUNCiAgICAgIH0pOw0KICAgICAgY29uc3Qgc3ByaXRlID0gbmV3IFRIUkVFLlNwcml0ZShzcHJpdGVNYXRlcmlhbCk7DQogICAgICBzcHJpdGUucG9zaXRpb24uc2V0KHgsIHksIHopOw0KICAgICAgc3ByaXRlLnNjYWxlLnNldCgzLjIsIDAuNTYsIDEpOw0KICAgICAgDQogICAgICB0aGlzLnNjZW5lLmFkZChzcHJpdGUpOw0KICAgIH0sDQogICAgDQogICAgLy8g5re75Yqg5L2c54mp57G75Z6L5qCH562+DQogICAgYWRkQ3JvcExhYmVsKGNyb3BOYW1lLCB4LCB5LCB6LCBjcm9wQ29sb3IpIHsNCiAgICAgIGNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpOw0KICAgICAgY29uc3QgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpOw0KICAgICAgY2FudmFzLndpZHRoID0gMTYwOw0KICAgICAgY2FudmFzLmhlaWdodCA9IDUwOw0KICAgICAgDQogICAgICAvLyDnu5jliLbog4zmma/ljaHniYfvvIjluKbovrnmoYbvvIkNCiAgICAgIGNvbnRleHQuZmlsbFN0eWxlID0gJ3JnYmEoMjU1LCAyNTUsIDI1NSwgMC45MiknOw0KICAgICAgY29udGV4dC5zaGFkb3dDb2xvciA9ICdyZ2JhKDAsIDAsIDAsIDAuMiknOw0KICAgICAgY29udGV4dC5zaGFkb3dCbHVyID0gNjsNCiAgICAgIGNvbnRleHQuc2hhZG93T2Zmc2V0WCA9IDE7DQogICAgICBjb250ZXh0LnNoYWRvd09mZnNldFkgPSAxOw0KICAgICAgDQogICAgICAvLyDlnIbop5Lnn6nlvaINCiAgICAgIGNvbnN0IHJhZGl1cyA9IDg7DQogICAgICBjb250ZXh0LmJlZ2luUGF0aCgpOw0KICAgICAgY29udGV4dC5tb3ZlVG8ocmFkaXVzLCAwKTsNCiAgICAgIGNvbnRleHQubGluZVRvKGNhbnZhcy53aWR0aCAtIHJhZGl1cywgMCk7DQogICAgICBjb250ZXh0LnF1YWRyYXRpY0N1cnZlVG8oY2FudmFzLndpZHRoLCAwLCBjYW52YXMud2lkdGgsIHJhZGl1cyk7DQogICAgICBjb250ZXh0LmxpbmVUbyhjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQgLSByYWRpdXMpOw0KICAgICAgY29udGV4dC5xdWFkcmF0aWNDdXJ2ZVRvKGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCwgY2FudmFzLndpZHRoIC0gcmFkaXVzLCBjYW52YXMuaGVpZ2h0KTsNCiAgICAgIGNvbnRleHQubGluZVRvKHJhZGl1cywgY2FudmFzLmhlaWdodCk7DQogICAgICBjb250ZXh0LnF1YWRyYXRpY0N1cnZlVG8oMCwgY2FudmFzLmhlaWdodCwgMCwgY2FudmFzLmhlaWdodCAtIHJhZGl1cyk7DQogICAgICBjb250ZXh0LmxpbmVUbygwLCByYWRpdXMpOw0KICAgICAgY29udGV4dC5xdWFkcmF0aWNDdXJ2ZVRvKDAsIDAsIHJhZGl1cywgMCk7DQogICAgICBjb250ZXh0LmNsb3NlUGF0aCgpOw0KICAgICAgY29udGV4dC5maWxsKCk7DQogICAgICANCiAgICAgIC8vIOe7mOWItui+ueahhg0KICAgICAgY29udGV4dC5zdHJva2VTdHlsZSA9ICcjJyArIGNyb3BDb2xvci50b1N0cmluZygxNikucGFkU3RhcnQoNiwgJzAnKTsNCiAgICAgIGNvbnRleHQubGluZVdpZHRoID0gMjsNCiAgICAgIGNvbnRleHQuc3Ryb2tlKCk7DQogICAgICANCiAgICAgIC8vIOmHjee9rumYtOW9sQ0KICAgICAgY29udGV4dC5zaGFkb3dDb2xvciA9ICd0cmFuc3BhcmVudCc7DQogICAgICBjb250ZXh0LnNoYWRvd0JsdXIgPSAwOw0KICAgICAgDQogICAgICAvLyDnu5jliLbkvZznianlm77moIflkozlkI3np7ANCiAgICAgIGNvbnRleHQuZm9udCA9ICdCb2xkIDIwcHggQXJpYWwnOw0KICAgICAgY29udGV4dC5maWxsU3R5bGUgPSAnIycgKyBjcm9wQ29sb3IudG9TdHJpbmcoMTYpLnBhZFN0YXJ0KDYsICcwJyk7DQogICAgICBjb250ZXh0LnRleHRBbGlnbiA9ICdjZW50ZXInOw0KICAgICAgY29udGV4dC50ZXh0QmFzZWxpbmUgPSAnbWlkZGxlJzsNCiAgICAgIA0KICAgICAgLy8g5LuO6YWN572u5Lit5b+D6I635Y+W5L2c54mp5Zu+5qCHDQogICAgICBjb25zdCBjb25maWcgPSB0aGlzLmNyb3BDb25maWdbY3JvcE5hbWVdIHx8IHRoaXMuZGVmYXVsdENyb3BDb25maWc7DQogICAgICBjb25zdCBpY29uID0gY29uZmlnLmljb247DQogICAgICBjb250ZXh0LmZpbGxUZXh0KGljb24gKyAnICcgKyBjcm9wTmFtZSwgY2FudmFzLndpZHRoIC8gMiwgY2FudmFzLmhlaWdodCAvIDIpOw0KICAgICAgDQogICAgICBjb25zdCB0ZXh0dXJlID0gbmV3IFRIUkVFLkNhbnZhc1RleHR1cmUoY2FudmFzKTsNCiAgICAgIGNvbnN0IHNwcml0ZU1hdGVyaWFsID0gbmV3IFRIUkVFLlNwcml0ZU1hdGVyaWFsKHsgDQogICAgICAgIG1hcDogdGV4dHVyZSwNCiAgICAgICAgc2l6ZUF0dGVudWF0aW9uOiB0cnVlLA0KICAgICAgICB0cmFuc3BhcmVudDogdHJ1ZQ0KICAgICAgfSk7DQogICAgICBjb25zdCBzcHJpdGUgPSBuZXcgVEhSRUUuU3ByaXRlKHNwcml0ZU1hdGVyaWFsKTsNCiAgICAgIHNwcml0ZS5wb3NpdGlvbi5zZXQoeCwgeSwgeik7DQogICAgICBzcHJpdGUuc2NhbGUuc2V0KDIuOCwgMC45LCAxKTsNCiAgICAgIA0KICAgICAgdGhpcy5zY2VuZS5hZGQoc3ByaXRlKTsNCiAgICB9LA0KICAgIA0KICAgIGFkZFRleHRMYWJlbCh0ZXh0LCB4LCB5LCB6KSB7DQogICAgICBjb25zdCBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTsNCiAgICAgIGNvbnN0IGNvbnRleHQgPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTsNCiAgICAgIGNhbnZhcy53aWR0aCA9IDI1NjsNCiAgICAgIGNhbnZhcy5oZWlnaHQgPSA2NDsNCiAgICAgIA0KICAgICAgY29udGV4dC5maWxsU3R5bGUgPSAncmdiYSgyNTUsIDI1NSwgMjU1LCAwLjkpJzsNCiAgICAgIGNvbnRleHQuZmlsbFJlY3QoMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTsNCiAgICAgIA0KICAgICAgY29udGV4dC5mb250ID0gJ0JvbGQgMjBweCBBcmlhbCc7DQogICAgICBjb250ZXh0LmZpbGxTdHlsZSA9ICcjMzAzMTMzJzsNCiAgICAgIGNvbnRleHQudGV4dEFsaWduID0gJ2NlbnRlcic7DQogICAgICBjb250ZXh0LnRleHRCYXNlbGluZSA9ICdtaWRkbGUnOw0KICAgICAgY29udGV4dC5maWxsVGV4dCh0ZXh0LCBjYW52YXMud2lkdGggLyAyLCBjYW52YXMuaGVpZ2h0IC8gMik7DQogICAgICANCiAgICAgIGNvbnN0IHRleHR1cmUgPSBuZXcgVEhSRUUuQ2FudmFzVGV4dHVyZShjYW52YXMpOw0KICAgICAgY29uc3Qgc3ByaXRlTWF0ZXJpYWwgPSBuZXcgVEhSRUUuU3ByaXRlTWF0ZXJpYWwoeyBtYXA6IHRleHR1cmUgfSk7DQogICAgICBjb25zdCBzcHJpdGUgPSBuZXcgVEhSRUUuU3ByaXRlKHNwcml0ZU1hdGVyaWFsKTsNCiAgICAgIHNwcml0ZS5wb3NpdGlvbi5zZXQoeCwgeSwgeik7DQogICAgICBzcHJpdGUuc2NhbGUuc2V0KDYsIDEuNSwgMSk7DQogICAgICANCiAgICAgIHRoaXMuc2NlbmUuYWRkKHNwcml0ZSk7DQogICAgfSwNCiAgICANCiAgICBvbk1vdXNlQ2xpY2soZXZlbnQpIHsNCiAgICAgIGNvbnN0IGNvbnRhaW5lciA9IHRoaXMuJHJlZnMudGhyZWVDb250YWluZXI7DQogICAgICBpZiAoIWNvbnRhaW5lciB8fCAhdGhpcy5jYW1lcmEgfHwgIXRoaXMucmF5Y2FzdGVyKSByZXR1cm47DQogICAgICANCiAgICAgIGNvbnN0IHJlY3QgPSBjb250YWluZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7DQogICAgICANCiAgICAgIHRoaXMubW91c2UueCA9ICgoZXZlbnQuY2xpZW50WCAtIHJlY3QubGVmdCkgLyByZWN0LndpZHRoKSAqIDIgLSAxOw0KICAgICAgdGhpcy5tb3VzZS55ID0gLSgoZXZlbnQuY2xpZW50WSAtIHJlY3QudG9wKSAvIHJlY3QuaGVpZ2h0KSAqIDIgKyAxOw0KICAgICAgDQogICAgICB0aGlzLnJheWNhc3Rlci5zZXRGcm9tQ2FtZXJhKHRoaXMubW91c2UsIHRoaXMuY2FtZXJhKTsNCiAgICAgIA0KICAgICAgLy8g5LyY5YyW77ya55u05o6l5qOA5rWL5Yac55Sw5Zyw5Z2X57uE77yM5L2/55SocmVjdXJzaXZl5Y+C5pWwDQogICAgICBjb25zdCBpbnRlcnNlY3RzID0gdGhpcy5yYXljYXN0ZXIuaW50ZXJzZWN0T2JqZWN0cyh0aGlzLmZhcm1CbG9ja3MsIHRydWUpOw0KICAgICAgDQogICAgICBpZiAoaW50ZXJzZWN0cy5sZW5ndGggPiAwKSB7DQogICAgICAgIC8vIOaJvuWIsOWvueW6lOeahOWGnOeUsOe7hA0KICAgICAgICBsZXQgY2xpY2tlZEdyb3VwID0gaW50ZXJzZWN0c1swXS5vYmplY3Q7DQogICAgICAgIHdoaWxlIChjbGlja2VkR3JvdXAucGFyZW50ICYmICghY2xpY2tlZEdyb3VwLnVzZXJEYXRhIHx8ICFjbGlja2VkR3JvdXAudXNlckRhdGEuZmFybSkpIHsNCiAgICAgICAgICBjbGlja2VkR3JvdXAgPSBjbGlja2VkR3JvdXAucGFyZW50Ow0KICAgICAgICB9DQogICAgICAgIGlmIChjbGlja2VkR3JvdXAudXNlckRhdGEgJiYgY2xpY2tlZEdyb3VwLnVzZXJEYXRhLmZhcm0pIHsNCiAgICAgICAgICB0aGlzLnNlbGVjdEJsb2NrKGNsaWNrZWRHcm91cCk7DQogICAgICAgIH0NCiAgICAgIH0NCiAgICB9LA0KICAgIA0KICAgIG9uTW91c2VNb3ZlKGV2ZW50KSB7DQogICAgICAvLyDoioLmtYHlpITnkIbvvJrpgb/lhY3popHnuYHop6blj5Hlr7zoh7TmgKfog73pl67popgNCiAgICAgIGlmICh0aGlzLm1vdXNlTW92ZVRpbWVyKSB7DQogICAgICAgIGNsZWFyVGltZW91dCh0aGlzLm1vdXNlTW92ZVRpbWVyKTsNCiAgICAgIH0NCiAgICAgIA0KICAgICAgdGhpcy5tb3VzZU1vdmVUaW1lciA9IHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICBjb25zdCBjb250YWluZXIgPSB0aGlzLiRyZWZzLnRocmVlQ29udGFpbmVyOw0KICAgICAgICBpZiAoIWNvbnRhaW5lciB8fCAhdGhpcy5jYW1lcmEgfHwgIXRoaXMucmF5Y2FzdGVyKSByZXR1cm47DQogICAgICAgIA0KICAgICAgICBjb25zdCByZWN0ID0gY29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOw0KICAgICAgICANCiAgICAgICAgdGhpcy5tb3VzZS54ID0gKChldmVudC5jbGllbnRYIC0gcmVjdC5sZWZ0KSAvIHJlY3Qud2lkdGgpICogMiAtIDE7DQogICAgICAgIHRoaXMubW91c2UueSA9IC0oKGV2ZW50LmNsaWVudFkgLSByZWN0LnRvcCkgLyByZWN0LmhlaWdodCkgKiAyICsgMTsNCiAgICAgICAgDQogICAgICAgIHRoaXMucmF5Y2FzdGVyLnNldEZyb21DYW1lcmEodGhpcy5tb3VzZSwgdGhpcy5jYW1lcmEpOw0KICAgICAgICANCiAgICAgICAgLy8g5LyY5YyW77ya55u05o6l5qOA5rWL5Yac55Sw5Zyw5Z2X57uE77yM5L2/55SocmVjdXJzaXZl5Y+C5pWw77yM6YG/5YWN5omL5Yqo6YGN5Y6GDQogICAgICAgIGNvbnN0IGludGVyc2VjdHMgPSB0aGlzLnJheWNhc3Rlci5pbnRlcnNlY3RPYmplY3RzKHRoaXMuZmFybUJsb2NrcywgdHJ1ZSk7DQogICAgICAgIA0KICAgICAgICAvLyDph43nva7miYDmnInlnLDlnZfnmoTpq5jkuq4NCiAgICAgICAgdGhpcy5mYXJtQmxvY2tzLmZvckVhY2goZ3JvdXAgPT4gew0KICAgICAgICAgIGlmIChncm91cCAhPT0gdGhpcy5zZWxlY3RlZEJsb2NrKSB7DQogICAgICAgICAgICBncm91cC50cmF2ZXJzZShjaGlsZCA9PiB7DQogICAgICAgICAgICAgIGlmIChjaGlsZC5pc01lc2ggJiYgY2hpbGQubWF0ZXJpYWwpIHsNCiAgICAgICAgICAgICAgICBjaGlsZC5tYXRlcmlhbC5lbWlzc2l2ZSA9IG5ldyBUSFJFRS5Db2xvcigweDAwMDAwMCk7DQogICAgICAgICAgICAgICAgY2hpbGQubWF0ZXJpYWwuZW1pc3NpdmVJbnRlbnNpdHkgPSAwOw0KICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCiAgICAgICAgICB9DQogICAgICAgIH0pOw0KICAgICAgICANCiAgICAgICAgLy8g6auY5Lqu5oKs5YGc55qE5Zyw5Z2XDQogICAgICAgIGlmIChpbnRlcnNlY3RzLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICBsZXQgaG92ZXJlZEdyb3VwID0gaW50ZXJzZWN0c1swXS5vYmplY3Q7DQogICAgICAgICAgd2hpbGUgKGhvdmVyZWRHcm91cC5wYXJlbnQgJiYgKCFob3ZlcmVkR3JvdXAudXNlckRhdGEgfHwgIWhvdmVyZWRHcm91cC51c2VyRGF0YS5mYXJtKSkgew0KICAgICAgICAgICAgaG92ZXJlZEdyb3VwID0gaG92ZXJlZEdyb3VwLnBhcmVudDsNCiAgICAgICAgICB9DQogICAgICAgICAgDQogICAgICAgICAgaWYgKGhvdmVyZWRHcm91cC51c2VyRGF0YSAmJiBob3ZlcmVkR3JvdXAudXNlckRhdGEuZmFybSAmJiBob3ZlcmVkR3JvdXAgIT09IHRoaXMuc2VsZWN0ZWRCbG9jaykgew0KICAgICAgICAgICAgaG92ZXJlZEdyb3VwLnRyYXZlcnNlKGNoaWxkID0+IHsNCiAgICAgICAgICAgICAgaWYgKGNoaWxkLmlzTWVzaCAmJiBjaGlsZC5tYXRlcmlhbCkgew0KICAgICAgICAgICAgICAgIGNoaWxkLm1hdGVyaWFsLmVtaXNzaXZlID0gbmV3IFRIUkVFLkNvbG9yKDB4MDBBQUZGKTsNCiAgICAgICAgICAgICAgICBjaGlsZC5tYXRlcmlhbC5lbWlzc2l2ZUludGVuc2l0eSA9IDAuMzsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgICBjb250YWluZXIuc3R5bGUuY3Vyc29yID0gJ3BvaW50ZXInOw0KICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBjb250YWluZXIuc3R5bGUuY3Vyc29yID0gJ2RlZmF1bHQnOw0KICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICBjb250YWluZXIuc3R5bGUuY3Vyc29yID0gJ2RlZmF1bHQnOw0KICAgICAgICB9DQogICAgICB9LCA1MCk7IC8vIDUwbXPoioLmtYHvvIzlh4/lsJHmgKfog73lvIDplIANCiAgICB9LA0KICAgIA0KICAgIHNlbGVjdEJsb2NrKGdyb3VwKSB7DQogICAgICAvLyDph43nva7kuYvliY3pgInkuK3nmoTlnLDlnZcNCiAgICAgIGlmICh0aGlzLnNlbGVjdGVkQmxvY2spIHsNCiAgICAgICAgdGhpcy5zZWxlY3RlZEJsb2NrLnRyYXZlcnNlKGNoaWxkID0+IHsNCiAgICAgICAgICBpZiAoY2hpbGQuaXNNZXNoICYmIGNoaWxkLm1hdGVyaWFsKSB7DQogICAgICAgICAgICBjaGlsZC5tYXRlcmlhbC5lbWlzc2l2ZSA9IG5ldyBUSFJFRS5Db2xvcigweDAwMDAwMCk7DQogICAgICAgICAgICBjaGlsZC5tYXRlcmlhbC5lbWlzc2l2ZUludGVuc2l0eSA9IDA7DQogICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICAgIH0NCiAgICAgIA0KICAgICAgLy8g6auY5Lqu5paw6YCJ5Lit55qE5Zyw5Z2XDQogICAgICB0aGlzLnNlbGVjdGVkQmxvY2sgPSBncm91cDsNCiAgICAgIGdyb3VwLnRyYXZlcnNlKGNoaWxkID0+IHsNCiAgICAgICAgaWYgKGNoaWxkLmlzTWVzaCAmJiBjaGlsZC5tYXRlcmlhbCkgew0KICAgICAgICAgIGNoaWxkLm1hdGVyaWFsLmVtaXNzaXZlID0gbmV3IFRIUkVFLkNvbG9yKDB4RkZBQTAwKTsNCiAgICAgICAgICBjaGlsZC5tYXRlcmlhbC5lbWlzc2l2ZUludGVuc2l0eSA9IDAuNTsNCiAgICAgICAgfQ0KICAgICAgfSk7DQogICAgICANCiAgICAgIC8vIOabtOaWsOmAieS4reeahOWGnOeUsA0KICAgICAgdGhpcy5zZWxlY3RlZEZhcm0gPSBncm91cC51c2VyRGF0YS5mYXJtOw0KICAgIH0sDQogICAgDQogICAgb25XaW5kb3dSZXNpemUoKSB7DQogICAgICBpZiAoIXRoaXMuY2FtZXJhIHx8ICF0aGlzLnJlbmRlcmVyIHx8ICF0aGlzLiRyZWZzLnRocmVlQ29udGFpbmVyKSByZXR1cm47DQogICAgICANCiAgICAgIGNvbnN0IHdpZHRoID0gdGhpcy4kcmVmcy50aHJlZUNvbnRhaW5lci5jbGllbnRXaWR0aDsNCiAgICAgIGNvbnN0IGhlaWdodCA9IHRoaXMuJHJlZnMudGhyZWVDb250YWluZXIuY2xpZW50SGVpZ2h0Ow0KICAgICAgDQogICAgICB0aGlzLmNhbWVyYS5hc3BlY3QgPSB3aWR0aCAvIGhlaWdodDsNCiAgICAgIHRoaXMuY2FtZXJhLnVwZGF0ZVByb2plY3Rpb25NYXRyaXgoKTsNCiAgICAgIHRoaXMucmVuZGVyZXIuc2V0U2l6ZSh3aWR0aCwgaGVpZ2h0KTsNCiAgICB9LA0KICAgIA0KICAgIGFuaW1hdGUoKSB7DQogICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy5hbmltYXRlLmJpbmQodGhpcykpOw0KICAgICAgDQogICAgICAvLyDoioLmtYHmjqfliLbvvJrlj6rlnKjpnIDopoHml7bmm7TmlrANCiAgICAgIGlmICh0aGlzLmNvbnRyb2xzKSB7DQogICAgICAgIHRoaXMuY29udHJvbHMudXBkYXRlKCk7DQogICAgICB9DQogICAgICANCiAgICAgIC8vIOS9v+eUqOiKgua1gea4suafk++8mumZjeS9jua4suafk+mikeeOhw0KICAgICAgaWYgKCF0aGlzLmxhc3RSZW5kZXJUaW1lKSB7DQogICAgICAgIHRoaXMubGFzdFJlbmRlclRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKTsNCiAgICAgIH0NCiAgICAgIA0KICAgICAgY29uc3Qgbm93ID0gcGVyZm9ybWFuY2Uubm93KCk7DQogICAgICBjb25zdCBkZWx0YVRpbWUgPSBub3cgLSB0aGlzLmxhc3RSZW5kZXJUaW1lOw0KICAgICAgDQogICAgICAvLyDpmZDliLbluKfnjofkuLo2MGZwc++8iOe6pjE2LjY3bXPkuIDluKfvvIkNCiAgICAgIGlmIChkZWx0YVRpbWUgPj0gMTYuNjcpIHsNCiAgICAgICAgaWYgKHRoaXMucmVuZGVyZXIgJiYgdGhpcy5zY2VuZSAmJiB0aGlzLmNhbWVyYSkgew0KICAgICAgICAgIHRoaXMucmVuZGVyZXIucmVuZGVyKHRoaXMuc2NlbmUsIHRoaXMuY2FtZXJhKTsNCiAgICAgICAgfQ0KICAgICAgICB0aGlzLmxhc3RSZW5kZXJUaW1lID0gbm93Ow0KICAgICAgfQ0KICAgIH0NCiAgfQ0KfTsNCg=="},{"version":3,"sources":["FarmMap3D.vue"],"names":[],"mappings":";AAuOA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"FarmMap3D.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div class=\"farm-map-3d\">\r\n    <!--  -->\r\n    <div class=\"top-bar\">\r\n      <div class=\"title\">\r\n        <i class=\"el-icon-s-data\"></i>\r\n         3D \r\n      </div>\r\n      <div class=\"time\">{{ currentTime }}</div>\r\n      <div class=\"weather\">\r\n        <i class=\"el-icon-sunny\"></i>\r\n        {{ weather.temp }}C {{ weather.status }}\r\n      </div>\r\n    </div>\r\n\r\n    <!--  -->\r\n    <div class=\"main-container\">\r\n      <!--  -->\r\n      <div class=\"left-panel\">\r\n        <!--  -->\r\n        <div class=\"stats-grid\">\r\n          <div class=\"stat-card\" style=\"background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\">\r\n            <div class=\"stat-icon\"></div>\r\n            <div class=\"stat-info\">\r\n              <div class=\"stat-label\"></div>\r\n              <div class=\"stat-value\">{{ summary.farmCount }}<span class=\"unit\"></span></div>\r\n            </div>\r\n          </div>\r\n          \r\n          <div class=\"stat-card\" style=\"background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);\">\r\n            <div class=\"stat-icon\"></div>\r\n            <div class=\"stat-info\">\r\n              <div class=\"stat-label\"></div>\r\n              <div class=\"stat-value\">{{ summary.totalArea }}<span class=\"unit\"></span></div>\r\n            </div>\r\n          </div>\r\n          \r\n          <div class=\"stat-card\" style=\"background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);\">\r\n            <div class=\"stat-icon\"></div>\r\n            <div class=\"stat-info\">\r\n              <div class=\"stat-label\"></div>\r\n              <div class=\"stat-value\">{{ summary.totalStock }}<span class=\"unit\"></span></div>\r\n            </div>\r\n          </div>\r\n          \r\n          <div class=\"stat-card\" style=\"background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);\">\r\n            <div class=\"stat-icon\"></div>\r\n            <div class=\"stat-info\">\r\n              <div class=\"stat-label\"></div>\r\n              <div class=\"stat-value\">{{ summary.normalCount }}<span class=\"unit\"></span></div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!--  -->\r\n        <div class=\"farm-list-panel\">\r\n          <div class=\"panel-title\">\r\n            <i class=\"el-icon-menu\"></i>\r\n            \r\n          </div>\r\n          <div class=\"farm-list\">\r\n            <div \r\n              v-for=\"(farm, index) in farms\" \r\n              :key=\"index\"\r\n              class=\"farm-item\"\r\n              :class=\"{ active: selectedFarm && selectedFarm.id === farm.id }\"\r\n              @click=\"selectFarm(farm)\"\r\n            >\r\n              <div class=\"farm-header\">\r\n                <span class=\"farm-name\">{{ farm.farm }}</span>\r\n                <el-tag :type=\"farm.state === '' ? 'success' : 'warning'\" size=\"mini\">\r\n                  {{ farm.state }}\r\n                </el-tag>\r\n              </div>\r\n              <div class=\"farm-info\">\r\n                <div class=\"info-row\">\r\n                  <span> {{ farm.crop }}</span>\r\n                  <span> {{ farm.area }}</span>\r\n                </div>\r\n                <div class=\"info-row\">\r\n                  <span> {{ farm.number }}</span>\r\n                  <span> {{ farm.address }}</span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- 3D  -->\r\n      <div class=\"center-panel\">\r\n        <div class=\"panel-title\">\r\n          <i class=\"el-icon-view\"></i>\r\n           3D \r\n        </div>\r\n        <div class=\"map-3d\" ref=\"threeContainer\"></div>\r\n      </div>\r\n\r\n      <!--  -->\r\n      <div class=\"right-panel\">\r\n        <div class=\"panel-title\">\r\n          <i class=\"el-icon-document\"></i>\r\n          \r\n        </div>\r\n        <div v-if=\"selectedFarm\" class=\"farm-detail\">\r\n          <div class=\"detail-header\">\r\n            <h3>{{ selectedFarm.farm }}</h3>\r\n            <el-tag :type=\"selectedFarm.state === '' ? 'success' : 'warning'\">\r\n              {{ selectedFarm.state }}\r\n            </el-tag>\r\n          </div>\r\n          \r\n          <div class=\"detail-grid\">\r\n            <div class=\"detail-item\">\r\n              <div class=\"label\"></div>\r\n              <div class=\"value\">{{ selectedFarm.crop }}</div>\r\n            </div>\r\n            <div class=\"detail-item\">\r\n              <div class=\"label\"></div>\r\n              <div class=\"value\">{{ selectedFarm.area }} </div>\r\n            </div>\r\n            <div class=\"detail-item\">\r\n              <div class=\"label\"></div>\r\n              <div class=\"value\">{{ selectedFarm.number }} </div>\r\n            </div>\r\n            <div class=\"detail-item\">\r\n              <div class=\"label\"></div>\r\n              <div class=\"value\">{{ selectedFarm.address }}</div>\r\n            </div>\r\n            <div class=\"detail-item\">\r\n              <div class=\"label\"></div>\r\n              <div class=\"value\">{{ selectedFarm.keeper }}</div>\r\n            </div>\r\n          </div>\r\n\r\n          <!--  -->\r\n          <div class=\"env-health-score\">\r\n            <div class=\"score-circle\" :style=\"{ background: getHealthScoreGradient(selectedFarm) }\">\r\n              <div class=\"score-inner\">\r\n                <div class=\"score-number\">{{ calculateHealthScore(selectedFarm) }}</div>\r\n                <div class=\"score-label\"></div>\r\n              </div>\r\n            </div>\r\n            <div class=\"score-status\">\r\n              <div class=\"status-badge\" :class=\"getHealthLevel(selectedFarm).class\">\r\n                {{ getHealthLevel(selectedFarm).text }}\r\n              </div>\r\n              <div class=\"status-desc\">{{ getHealthLevel(selectedFarm).desc }}</div>\r\n            </div>\r\n          </div>\r\n\r\n          <!--  -  -->\r\n          <div class=\"env-section\">\r\n            <div class=\"section-title\">\r\n              <span> </span>\r\n              <span class=\"update-time\">{{ currentTime.split(' ')[1] }}</span>\r\n            </div>\r\n            \r\n            <!--  -->\r\n            <div class=\"env-circles\">\r\n              <div class=\"circle-item\" v-for=\"item in getEnvMetrics(selectedFarm)\" :key=\"item.key\">\r\n                <div class=\"circle-progress\">\r\n                  <svg width=\"80\" height=\"80\" class=\"progress-ring\">\r\n                    <circle\r\n                      class=\"progress-ring-bg\"\r\n                      cx=\"40\"\r\n                      cy=\"40\"\r\n                      r=\"32\"\r\n                      fill=\"none\"\r\n                      stroke=\"#f0f0f0\"\r\n                      stroke-width=\"6\"\r\n                    />\r\n                    <circle\r\n                      class=\"progress-ring-circle\"\r\n                      cx=\"40\"\r\n                      cy=\"40\"\r\n                      r=\"32\"\r\n                      fill=\"none\"\r\n                      :stroke=\"item.color\"\r\n                      stroke-width=\"6\"\r\n                      stroke-linecap=\"round\"\r\n                      :stroke-dasharray=\"calculateDashArray(item.percent)\"\r\n                      :stroke-dashoffset=\"0\"\r\n                      transform=\"rotate(-90 40 40)\"\r\n                    />\r\n                  </svg>\r\n                  <div class=\"circle-content\">\r\n                    <div class=\"circle-icon\">{{ item.icon }}</div>\r\n                    <div class=\"circle-value\">{{ item.value }}</div>\r\n                  </div>\r\n                </div>\r\n                <div class=\"circle-label\">{{ item.label }}</div>\r\n                <div class=\"circle-status\" :style=\"{ color: item.statusColor }\">\r\n                  {{ item.status }}\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <!--  -->\r\n            <div class=\"smart-suggestions\">\r\n              <div class=\"suggestion-title\">\r\n                <i class=\"el-icon-magic-stick\"></i>\r\n                \r\n              </div>\r\n              <div class=\"suggestion-list\">\r\n                <div \r\n                  v-for=\"(suggestion, index) in getSmartSuggestions(selectedFarm)\" \r\n                  :key=\"index\"\r\n                  class=\"suggestion-item\"\r\n                  :class=\"suggestion.type\"\r\n                >\r\n                  <div class=\"suggestion-icon\">{{ suggestion.icon }}</div>\r\n                  <div class=\"suggestion-content\">\r\n                    <div class=\"suggestion-text\">{{ suggestion.text }}</div>\r\n                    <div class=\"suggestion-action\">{{ suggestion.action }}</div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div v-else class=\"no-selection\">\r\n          <i class=\"el-icon-info\"></i>\r\n          <p></p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport * as THREE from 'three';\r\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls';\r\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader';\r\n\r\nexport default {\r\n  name: 'FarmMap3D',\r\n  data() {\r\n    return {\r\n      currentTime: '',\r\n      selectedFarm: null,\r\n      weather: {\r\n        temp: 28,\r\n        status: ''\r\n      },\r\n      summary: {\r\n        farmCount: 0,\r\n        totalArea: 0,\r\n        totalStock: 0,\r\n        normalCount: 0\r\n      },\r\n      farms: [],\r\n      \r\n      // Three.js \r\n      scene: null,\r\n      camera: null,\r\n      renderer: null,\r\n      controls: null,\r\n      farmBlocks: [],\r\n      labels: [], // \r\n      raycaster: null,\r\n      mouse: null,\r\n      selectedBlock: null,\r\n      timeInterval: null, // \r\n      lastRenderTime: null, // \r\n      mouseMoveTimer: null, // \r\n      boundMouseClick: null, // \r\n      boundMouseMove: null,\r\n      boundWindowResize: null,\r\n      \r\n      // \r\n      gltfLoader: null,\r\n      modelCache: {}, // \r\n      \r\n      //   - \r\n      cropConfig: {\r\n        '': {\r\n          icon: '',\r\n          color: 0xF4D03F,  // \r\n          modelPath: '/models/crops/wheat.glb'\r\n        },\r\n        '': {\r\n          icon: '',\r\n          color: 0xF39C12,  // \r\n          modelPath: '/models/crops/corn.glb'\r\n        },\r\n        '': {\r\n          icon: '',\r\n          color: 0x52BE80,  // \r\n          modelPath: '/models/crops/rice.glb'\r\n        },\r\n        '': {\r\n          icon: '',\r\n          color: 0x85C1E2,  // \r\n          modelPath: '/models/crops/soybean.glb'\r\n        },\r\n        '': {\r\n          icon: '',\r\n          color: 0xE74C3C,  // \r\n          modelPath: '/models/crops/tomato.glb'\r\n        },\r\n        '': {\r\n          icon: '',\r\n          color: 0x27AE60,  // \r\n          modelPath: '/models/crops/cucumber.glb'\r\n        },\r\n        '': {\r\n          icon: '',\r\n          color: 0xC0392B,  // \r\n          modelPath: '/models/crops/pepper.glb'\r\n        },\r\n        '': {\r\n          icon: '',\r\n          color: 0x8E44AD,  // \r\n          modelPath: '/models/crops/eggplant.glb'\r\n        },\r\n        '': {\r\n          icon: '',\r\n          color: 0x2ECC71,  // \r\n          modelPath: '/models/crops/cabbage.glb'\r\n        },\r\n        '': {\r\n          icon: '',\r\n          color: 0xE67E22,  // \r\n          modelPath: '/models/crops/carrot.glb'\r\n        },\r\n        '': {\r\n          icon: '',\r\n          color: 0xD4AC6E,  // \r\n          modelPath: '/models/crops/potato.glb'\r\n        },\r\n        '': {\r\n          icon: '',\r\n          color: 0xFF8C00,  // \r\n          modelPath: '/models/crops/pumpkin.glb'\r\n        }\r\n      },\r\n      \r\n      // \r\n      defaultCropConfig: {\r\n        icon: '',\r\n        color: 0x52BE80,\r\n        modelPath: null\r\n      }\r\n    };\r\n  },\r\n  \r\n  mounted() {\r\n    this.updateTime();\r\n    this.timeInterval = setInterval(this.updateTime, 1000);\r\n    this.fetchData();\r\n  },\r\n  \r\n  beforeDestroy() {\r\n    if (this.timeInterval) {\r\n      clearInterval(this.timeInterval);\r\n    }\r\n    // Three.js\r\n    if (this.renderer) {\r\n      this.renderer.dispose();\r\n      if (this.$refs.threeContainer) {\r\n        this.$refs.threeContainer.removeChild(this.renderer.domElement);\r\n      }\r\n    }\r\n    if (this.controls) {\r\n      this.controls.dispose();\r\n    }\r\n    // \r\n    const container = this.$refs.threeContainer;\r\n    if (container) {\r\n      if (this.boundMouseClick) {\r\n        container.removeEventListener('click', this.boundMouseClick);\r\n      }\r\n      if (this.boundMouseMove) {\r\n        container.removeEventListener('mousemove', this.boundMouseMove);\r\n      }\r\n    }\r\n    if (this.boundWindowResize) {\r\n      window.removeEventListener('resize', this.boundWindowResize);\r\n    }\r\n    \r\n    // \r\n    if (this.mouseMoveTimer) {\r\n      clearTimeout(this.mouseMoveTimer);\r\n      this.mouseMoveTimer = null;\r\n    }\r\n  },\r\n  \r\n  methods: {\r\n    updateTime() {\r\n      const now = new Date();\r\n      const year = now.getFullYear();\r\n      const month = String(now.getMonth() + 1).padStart(2, '0');\r\n      const day = String(now.getDate()).padStart(2, '0');\r\n      const hour = String(now.getHours()).padStart(2, '0');\r\n      const minute = String(now.getMinutes()).padStart(2, '0');\r\n      const second = String(now.getSeconds()).padStart(2, '0');\r\n      const weekDays = ['', '', '', '', '', '', ''];\r\n      const weekDay = weekDays[now.getDay()];\r\n      \r\n      this.currentTime = `${year}-${month}-${day} ${hour}:${minute}:${second} ${weekDay}`;\r\n    },\r\n    \r\n    async fetchData() {\r\n      try {\r\n        const farmsRes = await this.request.get('/statistic/dashboard');\r\n        if (farmsRes.code === '200') {\r\n          this.farms = farmsRes.data;\r\n          if (this.farms.length > 0) {\r\n            this.selectedFarm = this.farms[0];\r\n          }\r\n          this.$nextTick(() => {\r\n            this.init3DMap();\r\n          });\r\n        }\r\n        \r\n        const summaryRes = await this.request.get('/statistic/dashboard/summary');\r\n        if (summaryRes.code === '200') {\r\n          this.summary = summaryRes.data;\r\n        }\r\n      } catch (error) {\r\n        console.error(':', error);\r\n        this.$message.error('');\r\n      }\r\n    },\r\n    \r\n    selectFarm(farm) {\r\n      this.selectedFarm = farm;\r\n      // 3D\r\n      this.highlightFarmBlock(farm);\r\n    },\r\n    \r\n    // 0-100\r\n    calculateHealthScore(farm) {\r\n      if (!farm) return 0;\r\n      \r\n      const scores = [];\r\n      \r\n      //  20-28C\r\n      const temp = farm.temperature || 25;\r\n      if (temp >= 20 && temp <= 28) {\r\n        scores.push(100);\r\n      } else if (temp >= 15 && temp <= 32) {\r\n        scores.push(80);\r\n      } else {\r\n        scores.push(50);\r\n      }\r\n      \r\n      //  60-80%\r\n      const airHum = farm.airhumidity || 70;\r\n      if (airHum >= 60 && airHum <= 80) {\r\n        scores.push(100);\r\n      } else if (airHum >= 50 && airHum <= 90) {\r\n        scores.push(75);\r\n      } else {\r\n        scores.push(50);\r\n      }\r\n      \r\n      //  40-70%\r\n      const soilHum = farm.soilhumidity || 60;\r\n      if (soilHum >= 40 && soilHum <= 70) {\r\n        scores.push(100);\r\n      } else if (soilHum >= 30 && soilHum <= 80) {\r\n        scores.push(75);\r\n      } else {\r\n        scores.push(50);\r\n      }\r\n      \r\n      //  20000-50000 lux\r\n      const light = farm.light || 30000;\r\n      if (light >= 20000 && light <= 50000) {\r\n        scores.push(100);\r\n      } else if (light >= 10000 && light <= 60000) {\r\n        scores.push(80);\r\n      } else {\r\n        scores.push(60);\r\n      }\r\n      \r\n      // CO 350-450 ppm\r\n      const carbon = farm.carbon || 400;\r\n      if (carbon >= 350 && carbon <= 450) {\r\n        scores.push(100);\r\n      } else if (carbon >= 300 && carbon <= 500) {\r\n        scores.push(85);\r\n      } else {\r\n        scores.push(65);\r\n      }\r\n      \r\n      // PH 6.0-7.5\r\n      const ph = farm.ph || 6.8;\r\n      if (ph >= 6.0 && ph <= 7.5) {\r\n        scores.push(100);\r\n      } else if (ph >= 5.5 && ph <= 8.0) {\r\n        scores.push(80);\r\n      } else {\r\n        scores.push(55);\r\n      }\r\n      \r\n      // \r\n      const avgScore = scores.reduce((a, b) => a + b, 0) / scores.length;\r\n      return Math.round(avgScore);\r\n    },\r\n    \r\n    // ====\r\n    getHealthColor(score) {\r\n      if (score >= 90) {\r\n        return 0x67C23A; //  - \r\n      } else if (score >= 75) {\r\n        return 0x409EFF; //  - \r\n      } else if (score >= 60) {\r\n        return 0xE6A23C; //  - \r\n      } else {\r\n        return 0xF56C6C; //  - \r\n      }\r\n    },\r\n    \r\n    // \r\n    blendColors(color1, color2, ratio) {\r\n      const r1 = (color1 >> 16) & 0xFF;\r\n      const g1 = (color1 >> 8) & 0xFF;\r\n      const b1 = color1 & 0xFF;\r\n      \r\n      const r2 = (color2 >> 16) & 0xFF;\r\n      const g2 = (color2 >> 8) & 0xFF;\r\n      const b2 = color2 & 0xFF;\r\n      \r\n      const r = Math.round(r1 * (1 - ratio) + r2 * ratio);\r\n      const g = Math.round(g1 * (1 - ratio) + g2 * ratio);\r\n      const b = Math.round(b1 * (1 - ratio) + b2 * ratio);\r\n      \r\n      return (r << 16) | (g << 8) | b;\r\n    },\r\n    \r\n    // \r\n    addHealthIndexLabel(score, x, y, z) {\r\n      const canvas = document.createElement('canvas');\r\n      const context = canvas.getContext('2d');\r\n      canvas.width = 120;\r\n      canvas.height = 40;\r\n      \r\n      // \r\n      let bgColor = 'rgba(103, 194, 58, 0.9)'; // \r\n      let textColor = '#ffffff';\r\n      if (score >= 90) {\r\n        bgColor = 'rgba(103, 194, 58, 0.9)'; // \r\n      } else if (score >= 75) {\r\n        bgColor = 'rgba(64, 158, 255, 0.9)'; // \r\n      } else if (score >= 60) {\r\n        bgColor = 'rgba(230, 162, 60, 0.9)'; // \r\n        textColor = '#ffffff';\r\n      } else {\r\n        bgColor = 'rgba(245, 108, 108, 0.9)'; // \r\n      }\r\n      \r\n      // \r\n      context.fillStyle = bgColor;\r\n      context.shadowColor = 'rgba(0, 0, 0, 0.2)';\r\n      context.shadowBlur = 5;\r\n      context.shadowOffsetX = 1;\r\n      context.shadowOffsetY = 1;\r\n      \r\n      const radius = 6;\r\n      context.beginPath();\r\n      context.moveTo(radius, 0);\r\n      context.lineTo(canvas.width - radius, 0);\r\n      context.quadraticCurveTo(canvas.width, 0, canvas.width, radius);\r\n      context.lineTo(canvas.width, canvas.height - radius);\r\n      context.quadraticCurveTo(canvas.width, canvas.height, canvas.width - radius, canvas.height);\r\n      context.lineTo(radius, canvas.height);\r\n      context.quadraticCurveTo(0, canvas.height, 0, canvas.height - radius);\r\n      context.lineTo(0, radius);\r\n      context.quadraticCurveTo(0, 0, radius, 0);\r\n      context.closePath();\r\n      context.fill();\r\n      \r\n      // \r\n      context.fillStyle = textColor;\r\n      context.font = 'bold 18px Arial';\r\n      context.textAlign = 'center';\r\n      context.textBaseline = 'middle';\r\n      context.fillText(`${score}`, canvas.width / 2, canvas.height / 2 - 5);\r\n      \r\n      context.font = '12px Arial';\r\n      context.fillText('', canvas.width / 2, canvas.height / 2 + 10);\r\n      \r\n      // \r\n      const texture = new THREE.CanvasTexture(canvas);\r\n      texture.needsUpdate = true;\r\n      \r\n      // \r\n      const spriteMaterial = new THREE.SpriteMaterial({\r\n        map: texture,\r\n        transparent: true,\r\n        depthTest: false\r\n      });\r\n      const sprite = new THREE.Sprite(spriteMaterial);\r\n      sprite.position.set(x, y, z);\r\n      sprite.scale.set(2, 2, 1);\r\n      \r\n      this.scene.add(sprite);\r\n      this.labels.push(sprite);\r\n    },\r\n    \r\n    // \r\n    getHealthLevel(farm) {\r\n      const score = this.calculateHealthScore(farm);\r\n      \r\n      if (score >= 90) {\r\n        return {\r\n          text: '',\r\n          desc: '',\r\n          class: 'level-excellent'\r\n        };\r\n      } else if (score >= 75) {\r\n        return {\r\n          text: '',\r\n          desc: '',\r\n          class: 'level-good'\r\n        };\r\n      } else if (score >= 60) {\r\n        return {\r\n          text: '',\r\n          desc: '',\r\n          class: 'level-normal'\r\n        };\r\n      } else {\r\n        return {\r\n          text: '',\r\n          desc: '',\r\n          class: 'level-poor'\r\n        };\r\n      }\r\n    },\r\n    \r\n    // \r\n    getHealthScoreGradient(farm) {\r\n      const score = this.calculateHealthScore(farm);\r\n      \r\n      if (score >= 90) {\r\n        return 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';\r\n      } else if (score >= 75) {\r\n        return 'linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)';\r\n      } else if (score >= 60) {\r\n        return 'linear-gradient(135deg, #fa709a 0%, #fee140 100%)';\r\n      } else {\r\n        return 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)';\r\n      }\r\n    },\r\n    \r\n    // \r\n    getEnvMetrics(farm) {\r\n      if (!farm) return [];\r\n      \r\n      return [\r\n        {\r\n          key: 'temp',\r\n          label: '',\r\n          value: `${farm.temperature}C`,\r\n          icon: '',\r\n          percent: this.normalizeValue(farm.temperature, 0, 40, 100),\r\n          color: this.getMetricColor(farm.temperature, 20, 28, 15, 32),\r\n          status: this.getMetricStatus(farm.temperature, 20, 28, 15, 32),\r\n          statusColor: this.getMetricStatusColor(farm.temperature, 20, 28, 15, 32)\r\n        },\r\n        {\r\n          key: 'airHum',\r\n          label: '',\r\n          value: `${farm.airhumidity}%`,\r\n          icon: '',\r\n          percent: farm.airhumidity,\r\n          color: this.getMetricColor(farm.airhumidity, 60, 80, 50, 90),\r\n          status: this.getMetricStatus(farm.airhumidity, 60, 80, 50, 90),\r\n          statusColor: this.getMetricStatusColor(farm.airhumidity, 60, 80, 50, 90)\r\n        },\r\n        {\r\n          key: 'soilHum',\r\n          label: '',\r\n          value: `${farm.soilhumidity}%`,\r\n          icon: '',\r\n          percent: farm.soilhumidity,\r\n          color: this.getMetricColor(farm.soilhumidity, 40, 70, 30, 80),\r\n          status: this.getMetricStatus(farm.soilhumidity, 40, 70, 30, 80),\r\n          statusColor: this.getMetricStatusColor(farm.soilhumidity, 40, 70, 30, 80)\r\n        },\r\n        {\r\n          key: 'light',\r\n          label: '',\r\n          value: `${(farm.light / 1000).toFixed(1)}k`,\r\n          icon: '',\r\n          percent: this.normalizeValue(farm.light, 0, 60000, 100),\r\n          color: this.getMetricColor(farm.light, 20000, 50000, 10000, 60000),\r\n          status: this.getMetricStatus(farm.light, 20000, 50000, 10000, 60000),\r\n          statusColor: this.getMetricStatusColor(farm.light, 20000, 50000, 10000, 60000)\r\n        },\r\n        {\r\n          key: 'carbon',\r\n          label: 'CO',\r\n          value: `${farm.carbon}ppm`,\r\n          icon: '',\r\n          percent: this.normalizeValue(farm.carbon, 300, 500, 100),\r\n          color: this.getMetricColor(farm.carbon, 350, 450, 300, 500),\r\n          status: this.getMetricStatus(farm.carbon, 350, 450, 300, 500),\r\n          statusColor: this.getMetricStatusColor(farm.carbon, 350, 450, 300, 500)\r\n        },\r\n        {\r\n          key: 'ph',\r\n          label: 'PH',\r\n          value: farm.ph,\r\n          icon: '',\r\n          percent: this.normalizeValue(farm.ph, 5, 8, 100),\r\n          color: this.getMetricColor(farm.ph, 6.0, 7.5, 5.5, 8.0),\r\n          status: this.getMetricStatus(farm.ph, 6.0, 7.5, 5.5, 8.0),\r\n          statusColor: this.getMetricStatusColor(farm.ph, 6.0, 7.5, 5.5, 8.0)\r\n        }\r\n      ];\r\n    },\r\n    \r\n    // \r\n    normalizeValue(value, min, max, scale = 100) {\r\n      return Math.min(Math.max(((value - min) / (max - min)) * scale, 0), scale);\r\n    },\r\n    \r\n    // \r\n    getMetricColor(value, idealMin, idealMax, acceptMin, acceptMax) {\r\n      if (value >= idealMin && value <= idealMax) {\r\n        return '#67C23A'; //  - \r\n      } else if (value >= acceptMin && value <= acceptMax) {\r\n        return '#E6A23C'; //  - \r\n      } else {\r\n        return '#F56C6C'; //  - \r\n      }\r\n    },\r\n    \r\n    // \r\n    getMetricStatus(value, idealMin, idealMax, acceptMin, acceptMax) {\r\n      if (value >= idealMin && value <= idealMax) {\r\n        return '';\r\n      } else if (value >= acceptMin && value <= acceptMax) {\r\n        return '';\r\n      } else {\r\n        return '';\r\n      }\r\n    },\r\n    \r\n    // \r\n    getMetricStatusColor(value, idealMin, idealMax, acceptMin, acceptMax) {\r\n      if (value >= idealMin && value <= idealMax) {\r\n        return '#67C23A';\r\n      } else if (value >= acceptMin && value <= acceptMax) {\r\n        return '#E6A23C';\r\n      } else {\r\n        return '#F56C6C';\r\n      }\r\n    },\r\n    \r\n    // SVGdasharray\r\n    calculateDashArray(percent) {\r\n      const circumference = 2 * Math.PI * 32; // 32\r\n      const filled = (percent / 100) * circumference;\r\n      return `${filled} ${circumference}`;\r\n    },\r\n    \r\n    // \r\n    getSmartSuggestions(farm) {\r\n      if (!farm) return [];\r\n      \r\n      const suggestions = [];\r\n      \r\n      // \r\n      if (farm.temperature < 20) {\r\n        suggestions.push({\r\n          icon: '',\r\n          text: '',\r\n          action: '',\r\n          type: 'warning'\r\n        });\r\n      } else if (farm.temperature > 28) {\r\n        suggestions.push({\r\n          icon: '',\r\n          text: '',\r\n          action: '',\r\n          type: 'warning'\r\n        });\r\n      }\r\n      \r\n      // \r\n      if (farm.soilhumidity < 40) {\r\n        suggestions.push({\r\n          icon: '',\r\n          text: '',\r\n          action: '',\r\n          type: 'danger'\r\n        });\r\n      } else if (farm.soilhumidity > 70) {\r\n        suggestions.push({\r\n          icon: '',\r\n          text: '',\r\n          action: '',\r\n          type: 'warning'\r\n        });\r\n      }\r\n      \r\n      // \r\n      if (farm.light < 20000) {\r\n        suggestions.push({\r\n          icon: '',\r\n          text: '',\r\n          action: '',\r\n          type: 'info'\r\n        });\r\n      }\r\n      \r\n      // PH\r\n      if (farm.ph < 6.0) {\r\n        suggestions.push({\r\n          icon: '',\r\n          text: 'PH',\r\n          action: '',\r\n          type: 'warning'\r\n        });\r\n      } else if (farm.ph > 7.5) {\r\n        suggestions.push({\r\n          icon: '',\r\n          text: 'PH',\r\n          action: '',\r\n          type: 'warning'\r\n        });\r\n      }\r\n      \r\n      // \r\n      if (suggestions.length === 0) {\r\n        suggestions.push({\r\n          icon: '',\r\n          text: '',\r\n          action: '',\r\n          type: 'success'\r\n        });\r\n      }\r\n      \r\n      return suggestions;\r\n    },\r\n    \r\n    highlightFarmBlock(farm) {\r\n      if (!farm || this.farmBlocks.length === 0) return;\r\n      \r\n      // \r\n      const group = this.farmBlocks.find(g => g.userData.farm && g.userData.farm.id === farm.id);\r\n      if (group) {\r\n        this.selectBlock(group);\r\n      }\r\n    },\r\n    \r\n    init3DMap() {\r\n      const container = this.$refs.threeContainer;\r\n      if (!container) {\r\n        console.warn('3D');\r\n        return;\r\n      }\r\n      if (this.farms.length === 0) {\r\n        console.warn('3D');\r\n        return;\r\n      }\r\n      \r\n      // \r\n      if (this.renderer) {\r\n        this.renderer.dispose();\r\n        if (container.contains(this.renderer.domElement)) {\r\n          container.removeChild(this.renderer.domElement);\r\n        }\r\n      }\r\n      \r\n      const width = container.clientWidth;\r\n      const height = container.clientHeight;\r\n      \r\n      // \r\n      this.scene = new THREE.Scene();\r\n      \r\n      // \r\n      this.camera = new THREE.PerspectiveCamera(60, width / height, 0.1, 1000);\r\n      this.camera.position.set(40, 50, 40);\r\n      this.camera.lookAt(0, 0, 0);\r\n      \r\n      //  - \r\n      this.renderer = new THREE.WebGLRenderer({ \r\n        antialias: false, // \r\n        powerPreference: 'high-performance' // \r\n      });\r\n      this.renderer.setSize(width, height);\r\n      // DPI\r\n      this.renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));\r\n      this.renderer.shadowMap.enabled = true;\r\n      this.renderer.shadowMap.type = THREE.PCFSoftShadowMap; // \r\n      container.appendChild(this.renderer.domElement);\r\n      \r\n      //  - \r\n      this.controls = new OrbitControls(this.camera, this.renderer.domElement);\r\n      this.controls.enableDamping = true;\r\n      this.controls.dampingFactor = 0.05;\r\n      this.controls.minDistance = 20;\r\n      this.controls.maxDistance = 150;\r\n      this.controls.maxPolarAngle = Math.PI / 2.2;\r\n      this.controls.enablePan = true; // \r\n      this.controls.enableZoom = true; // \r\n      this.controls.enableRotate = true; // \r\n      this.controls.rotateSpeed = 0.5; // \r\n      this.controls.zoomSpeed = 0.8; // \r\n      this.controls.panSpeed = 0.8; // \r\n      \r\n      // \r\n      // 1. \r\n      const ambientLight = new THREE.AmbientLight(0xB0C4DE, 0.6);\r\n      this.scene.add(ambientLight);\r\n      \r\n      // 2. - \r\n      const sunLight = new THREE.DirectionalLight(0xFFF8DC, 1.2);\r\n      sunLight.position.set(60, 100, 40);\r\n      sunLight.castShadow = true;\r\n      sunLight.shadow.mapSize.width = 1024; // 2048 -> 1024\r\n      sunLight.shadow.mapSize.height = 1024;\r\n      sunLight.shadow.camera.near = 0.5;\r\n      sunLight.shadow.camera.far = 250;\r\n      sunLight.shadow.camera.left = -100;\r\n      sunLight.shadow.camera.right = 100;\r\n      sunLight.shadow.camera.top = 100;\r\n      sunLight.shadow.camera.bottom = -100;\r\n      sunLight.shadow.bias = -0.0001;\r\n      sunLight.shadow.radius = 4; // \r\n      this.scene.add(sunLight);\r\n      \r\n      // 3. \r\n      const hemisphereLight = new THREE.HemisphereLight(0x87CEEB, 0x6B5D4F, 0.5);\r\n      this.scene.add(hemisphereLight);\r\n      \r\n      this.createGround();\r\n      \r\n      // \r\n      this.createFarmBlocks();\r\n      \r\n      // \r\n      this.raycaster = new THREE.Raycaster();\r\n      this.mouse = new THREE.Vector2();\r\n      \r\n      // \r\n      this.boundMouseClick = this.onMouseClick.bind(this);\r\n      this.boundMouseMove = this.onMouseMove.bind(this);\r\n      this.boundWindowResize = this.onWindowResize.bind(this);\r\n      \r\n      // \r\n      container.addEventListener('click', this.boundMouseClick);\r\n      container.addEventListener('mousemove', this.boundMouseMove, { passive: true }); // passive\r\n      \r\n      // \r\n      window.addEventListener('resize', this.boundWindowResize);\r\n      \r\n      // \r\n      this.animate();\r\n    },\r\n    \r\n    createSoilTexture() {\r\n      //  - \r\n      const canvas = document.createElement('canvas');\r\n      canvas.width = 256; // 512 -> 256\r\n      canvas.height = 256;\r\n      const ctx = canvas.getContext('2d');\r\n      \r\n      // \r\n      const soilColors = [\r\n        '#5D4E37', // \r\n        '#6B5D4F', // \r\n        '#7A6A52', // \r\n        '#8B7355', // \r\n        '#4A3C2A'  // \r\n      ];\r\n      \r\n      // \r\n      ctx.fillStyle = soilColors[1];\r\n      ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n      \r\n      // 5000 -> 1500\r\n      for (let i = 0; i < 1500; i++) {\r\n        const x = Math.random() * canvas.width;\r\n        const y = Math.random() * canvas.height;\r\n        const size = Math.random() * 2 + 0.5; // \r\n        const colorIndex = Math.floor(Math.random() * soilColors.length);\r\n        \r\n        ctx.fillStyle = soilColors[colorIndex];\r\n        ctx.globalAlpha = Math.random() * 0.5 + 0.3; // \r\n        ctx.beginPath();\r\n        ctx.arc(x, y, size, 0, Math.PI * 2);\r\n        ctx.fill();\r\n      }\r\n      \r\n      // \r\n      ctx.globalAlpha = 0.3;\r\n      ctx.strokeStyle = '#4A3C2A';\r\n      for (let i = 0; i < 35; i++) {\r\n        ctx.lineWidth = Math.random() * 2 + 0.5;\r\n        ctx.beginPath();\r\n        const startX = Math.random() * canvas.width;\r\n        const startY = Math.random() * canvas.height;\r\n        ctx.moveTo(startX, startY);\r\n        \r\n        const segments = Math.floor(Math.random() * 4) + 3;\r\n        for (let j = 0; j < segments; j++) {\r\n          const endX = startX + (Math.random() - 0.5) * 70;\r\n          const endY = startY + (Math.random() - 0.5) * 70;\r\n          ctx.lineTo(endX, endY);\r\n        }\r\n        ctx.stroke();\r\n      }\r\n      \r\n      // \r\n      ctx.globalAlpha = 0.7;\r\n      for (let i = 0; i < 150; i++) {\r\n        const x = Math.random() * canvas.width;\r\n        const y = Math.random() * canvas.height;\r\n        const size = Math.random() * 4 + 1;\r\n        \r\n        ctx.fillStyle = Math.random() > 0.5 ? '#9B8B7E' : '#8A7968';\r\n        ctx.beginPath();\r\n        ctx.arc(x, y, size, 0, Math.PI * 2);\r\n        ctx.fill();\r\n      }\r\n      \r\n      ctx.globalAlpha = 1.0;\r\n      \r\n      return new THREE.CanvasTexture(canvas);\r\n    },\r\n    \r\n    createGround() {\r\n      // - \r\n      const groundGeometry = new THREE.PlaneGeometry(200, 200, 40, 40); // 80x80 -> 40x40\r\n      const positions = groundGeometry.attributes.position;\r\n      \r\n      // \r\n      const positionArray = positions.array;\r\n      for (let i = 0; i < positionArray.length; i += 3) {\r\n        const x = positionArray[i];\r\n        const y = positionArray[i + 1];\r\n        const noise = Math.sin(x * 0.05) * Math.cos(y * 0.05) * 0.5 + \r\n                     Math.sin(x * 0.2) * Math.cos(y * 0.2) * 0.2;\r\n        positionArray[i + 2] = noise;\r\n      }\r\n      positions.needsUpdate = true;\r\n      groundGeometry.computeVertexNormals();\r\n      \r\n      // \r\n      const soilTexture = this.createSoilTexture();\r\n      soilTexture.wrapS = THREE.RepeatWrapping;\r\n      soilTexture.wrapT = THREE.RepeatWrapping;\r\n      soilTexture.repeat.set(18, 18);\r\n      \r\n      // \r\n      const groundMaterial = new THREE.MeshStandardMaterial({ \r\n        map: soilTexture,\r\n        roughness: 0.95,\r\n        metalness: 0.05,\r\n        flatShading: false\r\n      });\r\n      \r\n      const ground = new THREE.Mesh(groundGeometry, groundMaterial);\r\n      ground.rotation.x = -Math.PI / 2;\r\n      ground.receiveShadow = true;\r\n      this.scene.add(ground);\r\n      \r\n      // \r\n      this.scene.background = new THREE.Color(0x87CEEB); // \r\n      \r\n      // \r\n      this.scene.fog = new THREE.Fog(0x87CEEB, 50, 200);\r\n    },\r\n    \r\n    createFarmBlocks() {\r\n      // \r\n      this.farmBlocks.forEach(block => {\r\n        this.scene.remove(block);\r\n      });\r\n      this.farmBlocks = [];\r\n      \r\n      // \r\n      this.labels.forEach(label => {\r\n        this.scene.remove(label);\r\n      });\r\n      this.labels = [];\r\n      \r\n      // \r\n      const farmCount = this.farms.length;\r\n      const cols = Math.ceil(Math.sqrt(farmCount));\r\n      const spacing = 15;\r\n      \r\n      this.farms.forEach((farm, index) => {\r\n        const row = Math.floor(index / cols);\r\n        const col = index % cols;\r\n        \r\n        // \r\n        const offsetX = (cols - 1) * spacing / 2;\r\n        const offsetZ = (Math.ceil(farmCount / cols) - 1) * spacing / 2;\r\n        const x = col * spacing - offsetX;\r\n        const z = row * spacing - offsetZ;\r\n        \r\n        // \r\n        const area = parseFloat(farm.area) || 10;\r\n        const size = Math.sqrt(area) * 0.8;\r\n        \r\n        // \r\n        const farmGroup = new THREE.Group();\r\n        \r\n        // 1. - \r\n        const fieldGeometry = new THREE.PlaneGeometry(size, size, 4, 4); // 8x8 -> 4x4\r\n        \r\n        // \r\n        const fieldPositions = fieldGeometry.attributes.position;\r\n        for (let i = 0; i < fieldPositions.count; i++) {\r\n          const fx = fieldPositions.getX(i);\r\n          const fy = fieldPositions.getY(i);\r\n          const cropHeight = Math.sin(fx * 2) * Math.cos(fy * 2) * 0.2 + 0.3;\r\n          fieldPositions.setZ(i, cropHeight);\r\n        }\r\n        fieldGeometry.computeVertexNormals();\r\n        \r\n        // \r\n        const config = this.cropConfig[farm.crop] || this.defaultCropConfig;\r\n        const baseColor = config.color;\r\n        \r\n        // \r\n        const healthScore = this.calculateHealthScore(farm);\r\n        const healthColor = this.getHealthColor(healthScore);\r\n        \r\n        // 30%\r\n        const finalColor = this.blendColors(baseColor, healthColor, 0.3);\r\n        \r\n        const fieldMaterial = new THREE.MeshStandardMaterial({\r\n          color: finalColor,\r\n          roughness: 0.7,\r\n          metalness: 0.1,\r\n          flatShading: false,\r\n          side: THREE.DoubleSide\r\n        });\r\n        \r\n        const field = new THREE.Mesh(fieldGeometry, fieldMaterial);\r\n        field.rotation.x = -Math.PI / 2;\r\n        field.position.y = 0.3;\r\n        field.receiveShadow = true;\r\n        field.castShadow = true;\r\n        farmGroup.add(field);\r\n        \r\n        // 2. \r\n        const borderHeight = 0.3;\r\n        const borderWidth = 0.2;\r\n        const borderMaterial = new THREE.MeshStandardMaterial({\r\n          color: 0x8B6F47,\r\n          roughness: 0.9,\r\n          metalness: 0.1\r\n        });\r\n        \r\n        // \r\n        const borders = [\r\n          { w: size + borderWidth * 2, h: borderWidth, x: 0, z: -size / 2 - borderWidth / 2 }, // \r\n          { w: size + borderWidth * 2, h: borderWidth, x: 0, z: size / 2 + borderWidth / 2 },  // \r\n          { w: borderWidth, h: size, x: -size / 2 - borderWidth / 2, z: 0 },                    // \r\n          { w: borderWidth, h: size, x: size / 2 + borderWidth / 2, z: 0 }                      // \r\n        ];\r\n        \r\n        borders.forEach(b => {\r\n          const borderGeom = new THREE.BoxGeometry(b.w, borderHeight, b.h);\r\n          const border = new THREE.Mesh(borderGeom, borderMaterial);\r\n          border.position.set(b.x, borderHeight / 2, b.z);\r\n          border.castShadow = true;\r\n          border.receiveShadow = true;\r\n          farmGroup.add(border);\r\n        });\r\n        \r\n        // 3. \r\n        farmGroup.position.set(x, 0, z);\r\n        \r\n        // \r\n        farmGroup.userData = {\r\n          farm: farm,\r\n          originalColor: baseColor,\r\n          healthScore: healthScore,\r\n          healthColor: healthColor\r\n        };\r\n        \r\n        this.scene.add(farmGroup);\r\n        this.farmBlocks.push(farmGroup);\r\n        \r\n        //  3D \r\n        this.addCropModels(farm.crop, x, z, size, baseColor);\r\n        \r\n        // \r\n        this.addCropLabel(farm.crop, x, 2.5, z, baseColor);\r\n        \r\n        // \r\n        this.addHealthIndexLabel(healthScore, x, 3.0, z);\r\n        \r\n        // \r\n        this.addFieldNameLabel(farm.farm, x, 3.5, z);\r\n        \r\n        // \r\n        if (farm.address) {\r\n          this.addAddressLabel(farm.address, x, 4.2, z);\r\n        }\r\n      });\r\n    },\r\n    \r\n    //  3D \r\n    async loadCropModel(cropType) {\r\n      // \r\n      if (this.modelCache[cropType]) {\r\n        return this.modelCache[cropType].clone();\r\n      }\r\n      \r\n      // \r\n      const config = this.cropConfig[cropType] || this.defaultCropConfig;\r\n      const modelPath = config.modelPath;\r\n      if (!modelPath) {\r\n        console.warn(` ${cropType} `);\r\n        return null;\r\n      }\r\n      \r\n      // \r\n      if (!this.gltfLoader) {\r\n        this.gltfLoader = new GLTFLoader();\r\n      }\r\n      \r\n      try {\r\n        // \r\n        const gltf = await new Promise((resolve, reject) => {\r\n          this.gltfLoader.load(\r\n            modelPath,\r\n            (gltf) => resolve(gltf),\r\n            undefined,\r\n            (error) => reject(error)\r\n          );\r\n        });\r\n        \r\n        // \r\n        this.modelCache[cropType] = gltf.scene;\r\n        console.log(`  ${cropType} `);\r\n        \r\n        return gltf.scene.clone();\r\n      } catch (error) {\r\n        console.warn(`  ${cropType} :`, error.message);\r\n        return null;\r\n      }\r\n    },\r\n    \r\n    //  3D \r\n    async addCropModels(cropType, x, z, fieldSize, cropColor) {\r\n      // \r\n      const baseCount = Math.floor(fieldSize * 1.5); // 3 -> 1.5\r\n      const maxCount = 20; // \r\n      const plantCount = Math.min(baseCount, maxCount);\r\n      const spacing = fieldSize / Math.max(plantCount, 1);\r\n      \r\n      // \r\n      const externalModel = await this.loadCropModel(cropType);\r\n      \r\n      for (let i = 0; i < plantCount; i++) {\r\n        for (let j = 0; j < plantCount; j++) {\r\n          const offsetX = (i - plantCount / 2) * spacing + (Math.random() - 0.5) * spacing * 0.3;\r\n          const offsetZ = (j - plantCount / 2) * spacing + (Math.random() - 0.5) * spacing * 0.3;\r\n          \r\n          const plantX = x + offsetX;\r\n          const plantZ = z + offsetZ;\r\n          \r\n          let plant;\r\n          \r\n          // \r\n          if (externalModel) {\r\n            plant = externalModel.clone();\r\n            // \r\n            const enableShadow = (i + j) % 3 === 0; // 1/3\r\n            plant.traverse((child) => {\r\n              if (child.isMesh) {\r\n                child.castShadow = enableShadow;\r\n                child.receiveShadow = false; // \r\n              }\r\n            });\r\n          } else {\r\n            // \r\n            switch(cropType) {\r\n              case '':\r\n                plant = this.createWheatPlant(cropColor);\r\n                break;\r\n              case '':\r\n                plant = this.createCornPlant(cropColor);\r\n                break;\r\n              case '':\r\n                plant = this.createRicePlant(cropColor);\r\n                break;\r\n              case '':\r\n              case '':\r\n              case '':\r\n                plant = this.createLeafyPlant(cropColor);\r\n                break;\r\n              case '':\r\n              case '':\r\n                plant = this.createVinePlant(cropColor);\r\n                break;\r\n              default:\r\n                plant = this.createGenericPlant(cropColor);\r\n            }\r\n          }\r\n          \r\n          if (plant) {\r\n            plant.position.set(plantX, 0.5, plantZ);\r\n            // \r\n            const scale = 0.9 + Math.random() * 0.2; // \r\n            plant.scale.set(scale, scale, scale);\r\n            // \r\n            const enableShadow = (i + j) % 3 === 0;\r\n            plant.traverse((child) => {\r\n              if (child.isMesh) {\r\n                child.castShadow = enableShadow;\r\n                child.receiveShadow = false;\r\n              }\r\n            });\r\n            this.scene.add(plant);\r\n          }\r\n        }\r\n      }\r\n    },\r\n    \r\n    // \r\n    createWheatPlant(color) {\r\n      const group = new THREE.Group();\r\n      \r\n      // \r\n      const stemGeometry = new THREE.CylinderGeometry(0.02, 0.03, 1.2, 6);\r\n      const stemMaterial = new THREE.MeshStandardMaterial({ \r\n        color: 0x8B7355,\r\n        roughness: 0.8 \r\n      });\r\n      const stem = new THREE.Mesh(stemGeometry, stemMaterial);\r\n      stem.position.y = 0.6;\r\n      stem.castShadow = true;\r\n      group.add(stem);\r\n      \r\n      // \r\n      const headGeometry = new THREE.ConeGeometry(0.15, 0.4, 8);\r\n      const headMaterial = new THREE.MeshStandardMaterial({ \r\n        color: color,\r\n        roughness: 0.6 \r\n      });\r\n      const head = new THREE.Mesh(headGeometry, headMaterial);\r\n      head.position.y = 1.4;\r\n      head.castShadow = true;\r\n      group.add(head);\r\n      \r\n      return group;\r\n    },\r\n    \r\n    //  + \r\n    createCornPlant(color) {\r\n      const group = new THREE.Group();\r\n      \r\n      // \r\n      const stemGeometry = new THREE.CylinderGeometry(0.05, 0.08, 1.8, 8);\r\n      const stemMaterial = new THREE.MeshStandardMaterial({ \r\n        color: 0x7CB342,\r\n        roughness: 0.7 \r\n      });\r\n      const stem = new THREE.Mesh(stemGeometry, stemMaterial);\r\n      stem.position.y = 0.9;\r\n      stem.castShadow = true;\r\n      group.add(stem);\r\n      \r\n      // \r\n      const leafGeometry = new THREE.PlaneGeometry(0.3, 0.8);\r\n      const leafMaterial = new THREE.MeshStandardMaterial({ \r\n        color: 0x558B2F,\r\n        side: THREE.DoubleSide,\r\n        roughness: 0.8 \r\n      });\r\n      \r\n      for (let i = 0; i < 4; i++) {\r\n        const leaf = new THREE.Mesh(leafGeometry, leafMaterial);\r\n        leaf.position.y = 0.8 + i * 0.3;\r\n        leaf.rotation.y = (Math.PI / 2) * i;\r\n        leaf.rotation.z = Math.PI / 6;\r\n        leaf.castShadow = true;\r\n        group.add(leaf);\r\n      }\r\n      \r\n      // \r\n      const cornGeometry = new THREE.CylinderGeometry(0.1, 0.1, 0.4, 8);\r\n      const cornMaterial = new THREE.MeshStandardMaterial({ \r\n        color: color,\r\n        roughness: 0.6 \r\n      });\r\n      const corn = new THREE.Mesh(cornGeometry, cornMaterial);\r\n      corn.position.set(0.15, 1.2, 0);\r\n      corn.rotation.z = Math.PI / 4;\r\n      corn.castShadow = true;\r\n      group.add(corn);\r\n      \r\n      return group;\r\n    },\r\n    \r\n    // \r\n    createRicePlant(color) {\r\n      const group = new THREE.Group();\r\n      \r\n      // \r\n      const stemGeometry = new THREE.CylinderGeometry(0.02, 0.03, 1.0, 6);\r\n      const stemMaterial = new THREE.MeshStandardMaterial({ \r\n        color: 0x7CB342,\r\n        roughness: 0.8 \r\n      });\r\n      const stem = new THREE.Mesh(stemGeometry, stemMaterial);\r\n      stem.position.y = 0.5;\r\n      stem.castShadow = true;\r\n      group.add(stem);\r\n      \r\n      // \r\n      const riceGeometry = new THREE.SphereGeometry(0.12, 8, 8);\r\n      const riceMaterial = new THREE.MeshStandardMaterial({ \r\n        color: color,\r\n        roughness: 0.6 \r\n      });\r\n      \r\n      for (let i = 0; i < 5; i++) {\r\n        const rice = new THREE.Mesh(riceGeometry, riceMaterial);\r\n        rice.position.set(\r\n          Math.sin(i * 0.3) * 0.15,\r\n          1.0 - i * 0.1,\r\n          Math.cos(i * 0.3) * 0.15\r\n        );\r\n        rice.scale.set(1, 1.5, 1);\r\n        rice.castShadow = true;\r\n        group.add(rice);\r\n      }\r\n      \r\n      return group;\r\n    },\r\n    \r\n    // \r\n    createLeafyPlant(color) {\r\n      const group = new THREE.Group();\r\n      \r\n      // \r\n      const leafGeometry = new THREE.CircleGeometry(0.2, 8);\r\n      const leafMaterial = new THREE.MeshStandardMaterial({ \r\n        color: color,\r\n        side: THREE.DoubleSide,\r\n        roughness: 0.7 \r\n      });\r\n      \r\n      for (let i = 0; i < 6; i++) {\r\n        const leaf = new THREE.Mesh(leafGeometry, leafMaterial);\r\n        leaf.position.y = 0.3 + i * 0.1;\r\n        leaf.rotation.y = (Math.PI / 3) * i;\r\n        leaf.rotation.x = -Math.PI / 2 + Math.PI / 8;\r\n        leaf.scale.set(1 - i * 0.1, 1 - i * 0.1, 1);\r\n        leaf.castShadow = true;\r\n        group.add(leaf);\r\n      }\r\n      \r\n      return group;\r\n    },\r\n    \r\n    // \r\n    createVinePlant(color) {\r\n      const group = new THREE.Group();\r\n      \r\n      // \r\n      const stemGeometry = new THREE.CylinderGeometry(0.03, 0.04, 1.2, 6);\r\n      const stemMaterial = new THREE.MeshStandardMaterial({ \r\n        color: 0x558B2F,\r\n        roughness: 0.8 \r\n      });\r\n      const stem = new THREE.Mesh(stemGeometry, stemMaterial);\r\n      stem.position.y = 0.6;\r\n      stem.castShadow = true;\r\n      group.add(stem);\r\n      \r\n      // \r\n      const leafGeometry = new THREE.CircleGeometry(0.15, 6);\r\n      const leafMaterial = new THREE.MeshStandardMaterial({ \r\n        color: 0x4CAF50,\r\n        side: THREE.DoubleSide,\r\n        roughness: 0.7 \r\n      });\r\n      \r\n      for (let i = 0; i < 4; i++) {\r\n        const leaf = new THREE.Mesh(leafGeometry, leafMaterial);\r\n        leaf.position.set(\r\n          Math.cos(i * Math.PI / 2) * 0.2,\r\n          0.5 + i * 0.2,\r\n          Math.sin(i * Math.PI / 2) * 0.2\r\n        );\r\n        leaf.rotation.y = i * Math.PI / 2;\r\n        leaf.castShadow = true;\r\n        group.add(leaf);\r\n      }\r\n      \r\n      // \r\n      const fruitGeometry = new THREE.SphereGeometry(0.1, 8, 8);\r\n      const fruitMaterial = new THREE.MeshStandardMaterial({ \r\n        color: color,\r\n        roughness: 0.4,\r\n        metalness: 0.1 \r\n      });\r\n      \r\n      for (let i = 0; i < 3; i++) {\r\n        const fruit = new THREE.Mesh(fruitGeometry, fruitMaterial);\r\n        fruit.position.set(\r\n          Math.cos(i * Math.PI * 2 / 3) * 0.15,\r\n          0.8 + Math.random() * 0.3,\r\n          Math.sin(i * Math.PI * 2 / 3) * 0.15\r\n        );\r\n        fruit.castShadow = true;\r\n        group.add(fruit);\r\n      }\r\n      \r\n      return group;\r\n    },\r\n    \r\n    // \r\n    createGenericPlant(color) {\r\n      const group = new THREE.Group();\r\n      \r\n      const stemGeometry = new THREE.CylinderGeometry(0.03, 0.04, 0.8, 6);\r\n      const stemMaterial = new THREE.MeshStandardMaterial({ \r\n        color: 0x7CB342,\r\n        roughness: 0.8 \r\n      });\r\n      const stem = new THREE.Mesh(stemGeometry, stemMaterial);\r\n      stem.position.y = 0.4;\r\n      stem.castShadow = true;\r\n      group.add(stem);\r\n      \r\n      const topGeometry = new THREE.SphereGeometry(0.15, 8, 8);\r\n      const topMaterial = new THREE.MeshStandardMaterial({ \r\n        color: color,\r\n        roughness: 0.6 \r\n      });\r\n      const top = new THREE.Mesh(topGeometry, topMaterial);\r\n      top.position.y = 0.9;\r\n      top.castShadow = true;\r\n      group.add(top);\r\n      \r\n      return group;\r\n    },\r\n    \r\n    // \r\n    addFieldNameLabel(farmName, x, y, z) {\r\n      const canvas = document.createElement('canvas');\r\n      const context = canvas.getContext('2d');\r\n      canvas.width = 160;\r\n      canvas.height = 40;\r\n      \r\n      // \r\n      context.fillStyle = 'rgba(255, 255, 255, 0.88)';\r\n      context.shadowColor = 'rgba(0, 0, 0, 0.15)';\r\n      context.shadowBlur = 5;\r\n      context.shadowOffsetX = 1;\r\n      context.shadowOffsetY = 1;\r\n      \r\n      const radius = 6;\r\n      context.beginPath();\r\n      context.moveTo(radius, 0);\r\n      context.lineTo(canvas.width - radius, 0);\r\n      context.quadraticCurveTo(canvas.width, 0, canvas.width, radius);\r\n      context.lineTo(canvas.width, canvas.height - radius);\r\n      context.quadraticCurveTo(canvas.width, canvas.height, canvas.width - radius, canvas.height);\r\n      context.lineTo(radius, canvas.height);\r\n      context.quadraticCurveTo(0, canvas.height, 0, canvas.height - radius);\r\n      context.lineTo(0, radius);\r\n      context.quadraticCurveTo(0, 0, radius, 0);\r\n      context.closePath();\r\n      context.fill();\r\n      \r\n      context.shadowColor = 'transparent';\r\n      \r\n      // \r\n      context.font = 'Bold 16px Arial';\r\n      context.fillStyle = '#606266';\r\n      context.textAlign = 'center';\r\n      context.textBaseline = 'middle';\r\n      context.fillText(farmName, canvas.width / 2, canvas.height / 2);\r\n      \r\n      const texture = new THREE.CanvasTexture(canvas);\r\n      const spriteMaterial = new THREE.SpriteMaterial({ \r\n        map: texture,\r\n        sizeAttenuation: true\r\n      });\r\n      const sprite = new THREE.Sprite(spriteMaterial);\r\n      sprite.position.set(x, y, z);\r\n      sprite.scale.set(2.8, 0.7, 1);\r\n      \r\n      this.scene.add(sprite);\r\n    },\r\n    \r\n    // \r\n    addAddressLabel(address, x, y, z) {\r\n      const canvas = document.createElement('canvas');\r\n      const context = canvas.getContext('2d');\r\n      canvas.width = 200;\r\n      canvas.height = 35;\r\n      \r\n      // \r\n      context.fillStyle = 'rgba(230, 244, 255, 0.9)';\r\n      context.shadowColor = 'rgba(0, 0, 0, 0.12)';\r\n      context.shadowBlur = 4;\r\n      context.shadowOffsetX = 1;\r\n      context.shadowOffsetY = 1;\r\n      \r\n      const radius = 5;\r\n      context.beginPath();\r\n      context.moveTo(radius, 0);\r\n      context.lineTo(canvas.width - radius, 0);\r\n      context.quadraticCurveTo(canvas.width, 0, canvas.width, radius);\r\n      context.lineTo(canvas.width, canvas.height - radius);\r\n      context.quadraticCurveTo(canvas.width, canvas.height, canvas.width - radius, canvas.height);\r\n      context.lineTo(radius, canvas.height);\r\n      context.quadraticCurveTo(0, canvas.height, 0, canvas.height - radius);\r\n      context.lineTo(0, radius);\r\n      context.quadraticCurveTo(0, 0, radius, 0);\r\n      context.closePath();\r\n      context.fill();\r\n      \r\n      // \r\n      context.strokeStyle = '#409EFF';\r\n      context.lineWidth = 1.5;\r\n      context.stroke();\r\n      \r\n      context.shadowColor = 'transparent';\r\n      \r\n      // \r\n      context.font = '13px Arial';\r\n      context.fillStyle = '#409EFF';\r\n      context.textAlign = 'left';\r\n      context.textBaseline = 'middle';\r\n      \r\n      // \r\n      context.fillText('', 10, canvas.height / 2);\r\n      \r\n      // \r\n      context.fillStyle = '#606266';\r\n      const maxWidth = canvas.width - 40;\r\n      let displayAddress = address;\r\n      if (context.measureText(address).width > maxWidth) {\r\n        while (context.measureText(displayAddress + '...').width > maxWidth && displayAddress.length > 0) {\r\n          displayAddress = displayAddress.slice(0, -1);\r\n        }\r\n        displayAddress += '...';\r\n      }\r\n      context.fillText(displayAddress, 30, canvas.height / 2);\r\n      \r\n      const texture = new THREE.CanvasTexture(canvas);\r\n      const spriteMaterial = new THREE.SpriteMaterial({ \r\n        map: texture,\r\n        sizeAttenuation: true,\r\n        transparent: true\r\n      });\r\n      const sprite = new THREE.Sprite(spriteMaterial);\r\n      sprite.position.set(x, y, z);\r\n      sprite.scale.set(3.2, 0.56, 1);\r\n      \r\n      this.scene.add(sprite);\r\n    },\r\n    \r\n    // \r\n    addCropLabel(cropName, x, y, z, cropColor) {\r\n      const canvas = document.createElement('canvas');\r\n      const context = canvas.getContext('2d');\r\n      canvas.width = 160;\r\n      canvas.height = 50;\r\n      \r\n      // \r\n      context.fillStyle = 'rgba(255, 255, 255, 0.92)';\r\n      context.shadowColor = 'rgba(0, 0, 0, 0.2)';\r\n      context.shadowBlur = 6;\r\n      context.shadowOffsetX = 1;\r\n      context.shadowOffsetY = 1;\r\n      \r\n      // \r\n      const radius = 8;\r\n      context.beginPath();\r\n      context.moveTo(radius, 0);\r\n      context.lineTo(canvas.width - radius, 0);\r\n      context.quadraticCurveTo(canvas.width, 0, canvas.width, radius);\r\n      context.lineTo(canvas.width, canvas.height - radius);\r\n      context.quadraticCurveTo(canvas.width, canvas.height, canvas.width - radius, canvas.height);\r\n      context.lineTo(radius, canvas.height);\r\n      context.quadraticCurveTo(0, canvas.height, 0, canvas.height - radius);\r\n      context.lineTo(0, radius);\r\n      context.quadraticCurveTo(0, 0, radius, 0);\r\n      context.closePath();\r\n      context.fill();\r\n      \r\n      // \r\n      context.strokeStyle = '#' + cropColor.toString(16).padStart(6, '0');\r\n      context.lineWidth = 2;\r\n      context.stroke();\r\n      \r\n      // \r\n      context.shadowColor = 'transparent';\r\n      context.shadowBlur = 0;\r\n      \r\n      // \r\n      context.font = 'Bold 20px Arial';\r\n      context.fillStyle = '#' + cropColor.toString(16).padStart(6, '0');\r\n      context.textAlign = 'center';\r\n      context.textBaseline = 'middle';\r\n      \r\n      // \r\n      const config = this.cropConfig[cropName] || this.defaultCropConfig;\r\n      const icon = config.icon;\r\n      context.fillText(icon + ' ' + cropName, canvas.width / 2, canvas.height / 2);\r\n      \r\n      const texture = new THREE.CanvasTexture(canvas);\r\n      const spriteMaterial = new THREE.SpriteMaterial({ \r\n        map: texture,\r\n        sizeAttenuation: true,\r\n        transparent: true\r\n      });\r\n      const sprite = new THREE.Sprite(spriteMaterial);\r\n      sprite.position.set(x, y, z);\r\n      sprite.scale.set(2.8, 0.9, 1);\r\n      \r\n      this.scene.add(sprite);\r\n    },\r\n    \r\n    addTextLabel(text, x, y, z) {\r\n      const canvas = document.createElement('canvas');\r\n      const context = canvas.getContext('2d');\r\n      canvas.width = 256;\r\n      canvas.height = 64;\r\n      \r\n      context.fillStyle = 'rgba(255, 255, 255, 0.9)';\r\n      context.fillRect(0, 0, canvas.width, canvas.height);\r\n      \r\n      context.font = 'Bold 20px Arial';\r\n      context.fillStyle = '#303133';\r\n      context.textAlign = 'center';\r\n      context.textBaseline = 'middle';\r\n      context.fillText(text, canvas.width / 2, canvas.height / 2);\r\n      \r\n      const texture = new THREE.CanvasTexture(canvas);\r\n      const spriteMaterial = new THREE.SpriteMaterial({ map: texture });\r\n      const sprite = new THREE.Sprite(spriteMaterial);\r\n      sprite.position.set(x, y, z);\r\n      sprite.scale.set(6, 1.5, 1);\r\n      \r\n      this.scene.add(sprite);\r\n    },\r\n    \r\n    onMouseClick(event) {\r\n      const container = this.$refs.threeContainer;\r\n      if (!container || !this.camera || !this.raycaster) return;\r\n      \r\n      const rect = container.getBoundingClientRect();\r\n      \r\n      this.mouse.x = ((event.clientX - rect.left) / rect.width) * 2 - 1;\r\n      this.mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;\r\n      \r\n      this.raycaster.setFromCamera(this.mouse, this.camera);\r\n      \r\n      // recursive\r\n      const intersects = this.raycaster.intersectObjects(this.farmBlocks, true);\r\n      \r\n      if (intersects.length > 0) {\r\n        // \r\n        let clickedGroup = intersects[0].object;\r\n        while (clickedGroup.parent && (!clickedGroup.userData || !clickedGroup.userData.farm)) {\r\n          clickedGroup = clickedGroup.parent;\r\n        }\r\n        if (clickedGroup.userData && clickedGroup.userData.farm) {\r\n          this.selectBlock(clickedGroup);\r\n        }\r\n      }\r\n    },\r\n    \r\n    onMouseMove(event) {\r\n      // \r\n      if (this.mouseMoveTimer) {\r\n        clearTimeout(this.mouseMoveTimer);\r\n      }\r\n      \r\n      this.mouseMoveTimer = setTimeout(() => {\r\n        const container = this.$refs.threeContainer;\r\n        if (!container || !this.camera || !this.raycaster) return;\r\n        \r\n        const rect = container.getBoundingClientRect();\r\n        \r\n        this.mouse.x = ((event.clientX - rect.left) / rect.width) * 2 - 1;\r\n        this.mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;\r\n        \r\n        this.raycaster.setFromCamera(this.mouse, this.camera);\r\n        \r\n        // recursive\r\n        const intersects = this.raycaster.intersectObjects(this.farmBlocks, true);\r\n        \r\n        // \r\n        this.farmBlocks.forEach(group => {\r\n          if (group !== this.selectedBlock) {\r\n            group.traverse(child => {\r\n              if (child.isMesh && child.material) {\r\n                child.material.emissive = new THREE.Color(0x000000);\r\n                child.material.emissiveIntensity = 0;\r\n              }\r\n            });\r\n          }\r\n        });\r\n        \r\n        // \r\n        if (intersects.length > 0) {\r\n          let hoveredGroup = intersects[0].object;\r\n          while (hoveredGroup.parent && (!hoveredGroup.userData || !hoveredGroup.userData.farm)) {\r\n            hoveredGroup = hoveredGroup.parent;\r\n          }\r\n          \r\n          if (hoveredGroup.userData && hoveredGroup.userData.farm && hoveredGroup !== this.selectedBlock) {\r\n            hoveredGroup.traverse(child => {\r\n              if (child.isMesh && child.material) {\r\n                child.material.emissive = new THREE.Color(0x00AAFF);\r\n                child.material.emissiveIntensity = 0.3;\r\n              }\r\n            });\r\n            container.style.cursor = 'pointer';\r\n          } else {\r\n            container.style.cursor = 'default';\r\n          }\r\n        } else {\r\n          container.style.cursor = 'default';\r\n        }\r\n      }, 50); // 50ms\r\n    },\r\n    \r\n    selectBlock(group) {\r\n      // \r\n      if (this.selectedBlock) {\r\n        this.selectedBlock.traverse(child => {\r\n          if (child.isMesh && child.material) {\r\n            child.material.emissive = new THREE.Color(0x000000);\r\n            child.material.emissiveIntensity = 0;\r\n          }\r\n        });\r\n      }\r\n      \r\n      // \r\n      this.selectedBlock = group;\r\n      group.traverse(child => {\r\n        if (child.isMesh && child.material) {\r\n          child.material.emissive = new THREE.Color(0xFFAA00);\r\n          child.material.emissiveIntensity = 0.5;\r\n        }\r\n      });\r\n      \r\n      // \r\n      this.selectedFarm = group.userData.farm;\r\n    },\r\n    \r\n    onWindowResize() {\r\n      if (!this.camera || !this.renderer || !this.$refs.threeContainer) return;\r\n      \r\n      const width = this.$refs.threeContainer.clientWidth;\r\n      const height = this.$refs.threeContainer.clientHeight;\r\n      \r\n      this.camera.aspect = width / height;\r\n      this.camera.updateProjectionMatrix();\r\n      this.renderer.setSize(width, height);\r\n    },\r\n    \r\n    animate() {\r\n      requestAnimationFrame(this.animate.bind(this));\r\n      \r\n      // \r\n      if (this.controls) {\r\n        this.controls.update();\r\n      }\r\n      \r\n      // \r\n      if (!this.lastRenderTime) {\r\n        this.lastRenderTime = performance.now();\r\n      }\r\n      \r\n      const now = performance.now();\r\n      const deltaTime = now - this.lastRenderTime;\r\n      \r\n      // 60fps16.67ms\r\n      if (deltaTime >= 16.67) {\r\n        if (this.renderer && this.scene && this.camera) {\r\n          this.renderer.render(this.scene, this.camera);\r\n        }\r\n        this.lastRenderTime = now;\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.farm-map-3d {\r\n  width: 100%;\r\n  min-height: 100vh;\r\n  background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);\r\n  padding: 20px;\r\n}\r\n\r\n.top-bar {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  background: white;\r\n  padding: 15px 30px;\r\n  border-radius: 12px;\r\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.title {\r\n  font-size: 24px;\r\n  font-weight: bold;\r\n  color: #303133;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 10px;\r\n}\r\n\r\n.title i {\r\n  font-size: 28px;\r\n  color: #409EFF;\r\n}\r\n\r\n.time, .weather {\r\n  font-size: 14px;\r\n  color: #606266;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n}\r\n\r\n.weather i {\r\n  font-size: 18px;\r\n  color: #E6A23C;\r\n}\r\n\r\n.main-container {\r\n  display: flex;\r\n  gap: 20px;\r\n  height: calc(100vh - 140px);\r\n}\r\n\r\n.left-panel {\r\n  width: 320px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 20px;\r\n}\r\n\r\n.stats-grid {\r\n  display: grid;\r\n  grid-template-columns: repeat(2, 1fr);\r\n  gap: 15px;\r\n}\r\n\r\n.stat-card {\r\n  padding: 15px;\r\n  border-radius: 12px;\r\n  color: white;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 12px;\r\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\r\n  cursor: pointer;\r\n  transition: all 0.3s;\r\n}\r\n\r\n.stat-card:hover {\r\n  transform: translateY(-3px);\r\n  box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);\r\n}\r\n\r\n.stat-icon {\r\n  font-size: 32px;\r\n}\r\n\r\n.stat-info {\r\n  flex: 1;\r\n}\r\n\r\n.stat-label {\r\n  font-size: 12px;\r\n  opacity: 0.9;\r\n  margin-bottom: 5px;\r\n}\r\n\r\n.stat-value {\r\n  font-size: 22px;\r\n  font-weight: bold;\r\n}\r\n\r\n.stat-value .unit {\r\n  font-size: 12px;\r\n  margin-left: 4px;\r\n  opacity: 0.8;\r\n}\r\n\r\n.farm-list-panel {\r\n  flex: 1;\r\n  background: white;\r\n  border-radius: 12px;\r\n  padding: 20px;\r\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.panel-title {\r\n  font-size: 16px;\r\n  font-weight: bold;\r\n  color: #303133;\r\n  margin-bottom: 15px;\r\n  padding-bottom: 10px;\r\n  border-bottom: 2px solid #409EFF;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n}\r\n\r\n.panel-title i {\r\n  color: #409EFF;\r\n  font-size: 18px;\r\n}\r\n\r\n.farm-list {\r\n  flex: 1;\r\n  overflow-y: auto;\r\n}\r\n\r\n.farm-item {\r\n  padding: 12px;\r\n  margin-bottom: 10px;\r\n  background: #f5f7fa;\r\n  border-radius: 8px;\r\n  border: 2px solid transparent;\r\n  cursor: pointer;\r\n  transition: all 0.3s;\r\n}\r\n\r\n.farm-item:hover {\r\n  background: #ecf5ff;\r\n  border-color: #409EFF;\r\n}\r\n\r\n.farm-item.active {\r\n  background: #ecf5ff;\r\n  border-color: #409EFF;\r\n  box-shadow: 0 2px 8px rgba(64, 158, 255, 0.3);\r\n}\r\n\r\n.farm-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 8px;\r\n}\r\n\r\n.farm-name {\r\n  font-size: 15px;\r\n  font-weight: bold;\r\n  color: #303133;\r\n}\r\n\r\n.farm-info {\r\n  font-size: 12px;\r\n  color: #606266;\r\n}\r\n\r\n.info-row {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  margin-top: 5px;\r\n}\r\n\r\n.center-panel {\r\n  flex: 1;\r\n  background: white;\r\n  border-radius: 12px;\r\n  padding: 20px;\r\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.map-3d {\r\n  flex: 1;\r\n  width: 100%;\r\n  min-height: 500px;\r\n}\r\n\r\n.right-panel {\r\n  width: 380px;\r\n  background: white;\r\n  border-radius: 12px;\r\n  padding: 20px;\r\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);\r\n  overflow-y: auto;\r\n}\r\n\r\n.farm-detail {\r\n  margin-top: 15px;\r\n}\r\n\r\n.detail-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 20px;\r\n  padding-bottom: 15px;\r\n  border-bottom: 1px solid #eee;\r\n}\r\n\r\n.detail-header h3 {\r\n  margin: 0;\r\n  color: #303133;\r\n  font-size: 18px;\r\n}\r\n\r\n.detail-grid {\r\n  display: grid;\r\n  grid-template-columns: repeat(2, 1fr);\r\n  gap: 15px;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.detail-item {\r\n  background: #f5f7fa;\r\n  padding: 12px;\r\n  border-radius: 8px;\r\n}\r\n\r\n.detail-item .label {\r\n  font-size: 12px;\r\n  color: #909399;\r\n  margin-bottom: 5px;\r\n}\r\n\r\n.detail-item .value {\r\n  font-size: 15px;\r\n  font-weight: bold;\r\n  color: #303133;\r\n}\r\n\r\n.env-section {\r\n  margin-top: 20px;\r\n}\r\n\r\n.section-title {\r\n  font-size: 14px;\r\n  font-weight: bold;\r\n  color: #303133;\r\n  margin-bottom: 12px;\r\n  padding-left: 10px;\r\n  border-left: 3px solid #409EFF;\r\n}\r\n\r\n.env-grid {\r\n  display: grid;\r\n  grid-template-columns: repeat(2, 1fr);\r\n  gap: 10px;\r\n}\r\n\r\n.env-item {\r\n  background: #f5f7fa;\r\n  padding: 10px;\r\n  border-radius: 6px;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n}\r\n\r\n.env-label {\r\n  font-size: 12px;\r\n  color: #606266;\r\n  flex: 1;\r\n}\r\n\r\n.env-value {\r\n  font-size: 14px;\r\n  font-weight: bold;\r\n  color: #303133;\r\n}\r\n\r\n.no-selection {\r\n  text-align: center;\r\n  padding: 60px 20px;\r\n  color: #909399;\r\n}\r\n\r\n.no-selection i {\r\n  font-size: 48px;\r\n  margin-bottom: 15px;\r\n  display: block;\r\n}\r\n\r\n.farm-list::-webkit-scrollbar,\r\n.right-panel::-webkit-scrollbar {\r\n  width: 6px;\r\n}\r\n\r\n.farm-list::-webkit-scrollbar-thumb,\r\n.right-panel::-webkit-scrollbar-thumb {\r\n  background: #dcdfe6;\r\n  border-radius: 3px;\r\n}\r\n\r\n.farm-list::-webkit-scrollbar-track,\r\n.right-panel::-webkit-scrollbar-track {\r\n  background: #f5f7fa;\r\n}\r\n\r\n/*  */\r\n.env-health-score {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 20px;\r\n  padding: 20px;\r\n  background: linear-gradient(135deg, #f5f7fa 0%, #e8eef5 100%);\r\n  border-radius: 12px;\r\n  margin: 20px 0;\r\n}\r\n\r\n.score-circle {\r\n  width: 100px;\r\n  height: 100px;\r\n  border-radius: 50%;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);\r\n  animation: pulse 2s ease-in-out infinite;\r\n}\r\n\r\n@keyframes pulse {\r\n  0%, 100% {\r\n    transform: scale(1);\r\n  }\r\n  50% {\r\n    transform: scale(1.05);\r\n  }\r\n}\r\n\r\n.score-inner {\r\n  width: 85px;\r\n  height: 85px;\r\n  background: white;\r\n  border-radius: 50%;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.score-number {\r\n  font-size: 32px;\r\n  font-weight: bold;\r\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\r\n  -webkit-background-clip: text;\r\n  -webkit-text-fill-color: transparent;\r\n  background-clip: text;\r\n}\r\n\r\n.score-label {\r\n  font-size: 11px;\r\n  color: #909399;\r\n  margin-top: 2px;\r\n}\r\n\r\n.score-status {\r\n  flex: 1;\r\n}\r\n\r\n.status-badge {\r\n  display: inline-block;\r\n  padding: 6px 16px;\r\n  border-radius: 20px;\r\n  font-size: 14px;\r\n  font-weight: bold;\r\n  margin-bottom: 8px;\r\n}\r\n\r\n.status-badge.level-excellent {\r\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\r\n  color: white;\r\n}\r\n\r\n.status-badge.level-good {\r\n  background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);\r\n  color: white;\r\n}\r\n\r\n.status-badge.level-normal {\r\n  background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);\r\n  color: white;\r\n}\r\n\r\n.status-badge.level-poor {\r\n  background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);\r\n  color: white;\r\n}\r\n\r\n.status-desc {\r\n  font-size: 13px;\r\n  color: #606266;\r\n  line-height: 1.6;\r\n}\r\n\r\n/*  */\r\n.section-title {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  font-size: 15px;\r\n  font-weight: bold;\r\n  color: #303133;\r\n  margin-bottom: 20px;\r\n  padding-left: 10px;\r\n  border-left: 4px solid #409EFF;\r\n}\r\n\r\n.update-time {\r\n  font-size: 12px;\r\n  color: #909399;\r\n  font-weight: normal;\r\n}\r\n\r\n/*  */\r\n.env-circles {\r\n  display: grid;\r\n  grid-template-columns: repeat(3, 1fr);\r\n  gap: 20px;\r\n  margin-bottom: 25px;\r\n}\r\n\r\n.circle-item {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  gap: 8px;\r\n}\r\n\r\n.circle-progress {\r\n  position: relative;\r\n  width: 80px;\r\n  height: 80px;\r\n}\r\n\r\n.progress-ring {\r\n  transform: rotate(0deg);\r\n}\r\n\r\n.progress-ring-circle {\r\n  transition: stroke-dasharray 0.5s ease;\r\n}\r\n\r\n.circle-content {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  gap: 2px;\r\n}\r\n\r\n.circle-icon {\r\n  font-size: 20px;\r\n}\r\n\r\n.circle-value {\r\n  font-size: 12px;\r\n  font-weight: bold;\r\n  color: #303133;\r\n}\r\n\r\n.circle-label {\r\n  font-size: 12px;\r\n  color: #606266;\r\n  text-align: center;\r\n}\r\n\r\n.circle-status {\r\n  font-size: 11px;\r\n  font-weight: bold;\r\n  padding: 2px 8px;\r\n  border-radius: 10px;\r\n  background: rgba(103, 194, 58, 0.1);\r\n}\r\n\r\n/*  */\r\n.smart-suggestions {\r\n  background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);\r\n  border-radius: 12px;\r\n  padding: 15px;\r\n  margin-top: 20px;\r\n}\r\n\r\n.suggestion-title {\r\n  font-size: 14px;\r\n  font-weight: bold;\r\n  color: #303133;\r\n  margin-bottom: 12px;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 6px;\r\n}\r\n\r\n.suggestion-title i {\r\n  color: #409EFF;\r\n  font-size: 16px;\r\n}\r\n\r\n.suggestion-list {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 10px;\r\n}\r\n\r\n.suggestion-item {\r\n  display: flex;\r\n  gap: 12px;\r\n  padding: 12px;\r\n  background: white;\r\n  border-radius: 8px;\r\n  border-left: 3px solid #409EFF;\r\n  transition: all 0.3s ease;\r\n}\r\n\r\n.suggestion-item:hover {\r\n  transform: translateX(5px);\r\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.suggestion-item.warning {\r\n  border-left-color: #E6A23C;\r\n}\r\n\r\n.suggestion-item.danger {\r\n  border-left-color: #F56C6C;\r\n}\r\n\r\n.suggestion-item.success {\r\n  border-left-color: #67C23A;\r\n}\r\n\r\n.suggestion-item.info {\r\n  border-left-color: #409EFF;\r\n}\r\n\r\n.suggestion-icon {\r\n  font-size: 24px;\r\n  flex-shrink: 0;\r\n}\r\n\r\n.suggestion-content {\r\n  flex: 1;\r\n}\r\n\r\n.suggestion-text {\r\n  font-size: 13px;\r\n  font-weight: bold;\r\n  color: #303133;\r\n  margin-bottom: 4px;\r\n}\r\n\r\n.suggestion-action {\r\n  font-size: 12px;\r\n  color: #606266;\r\n  line-height: 1.5;\r\n}\r\n</style>\r\n"]}]}